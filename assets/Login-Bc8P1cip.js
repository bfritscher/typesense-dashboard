import{e as D,r as U,ad as I,ae as N,A as $,i as O,h as L,g as M,ai as R,aF as B,z as T,b7 as z,D as j,b8 as W,K as X,u as Y,a4 as x,M as p,a1 as m,O as n,N as c,L as F,Y as A,a3 as E,a7 as b,b9 as G,S as K,X as H,a8 as J,W as P,a2 as Z}from"./index-L3EtEqro.js";import{c as ee,d as oe}from"./QSelect-vVFrIk_C.js";import{_ as te}from"./ServerHistory.vue_vue_type_script_setup_true_lang-BtCbaRph.js";import"./format-BvkBI9bc.js";import"./QList-CKw24Oj8.js";const ae=D({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(i,{slots:f,emit:t}){const h=O(),r=U(null);let o=0;const a=[];function V(e){const d=typeof e=="boolean"?e:i.noErrorFocus!==!0,y=++o,_=(l,s)=>{t(`validation${l===!0?"Success":"Error"}`,s)},k=l=>{const s=l.validate();return typeof s.then=="function"?s.then(u=>({valid:u,comp:l}),u=>({valid:!1,comp:l,err:u})):Promise.resolve({valid:s,comp:l})};return(i.greedy===!0?Promise.all(a.map(k)).then(l=>l.filter(s=>s.valid!==!0)):a.reduce((l,s)=>l.then(()=>k(s).then(u=>{if(u.valid===!1)return Promise.reject(u)})),Promise.resolve()).catch(l=>[l])).then(l=>{if(l===void 0||l.length===0)return y===o&&_(!0),!0;if(y===o){const{comp:s,err:u}=l[0];if(u!==void 0&&console.error(u),_(!1,s),d===!0){const w=l.find(({comp:Q})=>typeof Q.focus=="function"&&R(Q.$)===!1);w!==void 0&&w.comp.focus()}}return!1})}function g(){o++,a.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function S(e){e!==void 0&&B(e);const d=o+1;V().then(y=>{d===o&&y===!0&&(i.onSubmit!==void 0?t("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function C(e){e!==void 0&&B(e),t("reset"),T(()=>{g(),i.autofocus===!0&&i.noResetFocus!==!0&&v()})}function v(){z(()=>{if(r.value===null)return;const e=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1);e?.focus({preventScroll:!0})})}j(W,{bindComponent(e){a.push(e)},unbindComponent(e){const d=a.indexOf(e);d!==-1&&a.splice(d,1)}});let q=!1;return I(()=>{q=!0}),N(()=>{q===!0&&i.autofocus===!0&&v()}),$(()=>{i.autofocus===!0&&v()}),Object.assign(h.proxy,{validate:V,resetValidation:g,submit:S,reset:C,focus:v,getValidationComponents:()=>a}),()=>L("form",{class:"q-form",ref:r,onSubmit:S,onReset:C},M(f.default))}}),le={class:"fullscreen row bg-primary text-center q-pa-md flex flex-center"},ne={class:"col col-md-4"},se={key:0},re={key:1},ue={class:"text-left"},ie={class:"text-red"},ye=X({__name:"Login",setup(i){const f=Y();$(()=>{f.connectionCheck()});const t=U({apiKey:"",node:{host:"localhost",port:8108,protocol:"http",path:"",tls:!0},protocolOptions:["http","https"]});function h(){f.login({apiKey:t.value.apiKey,node:t.value.node})}return(r,o)=>(p(),x("div",le,[m("div",ne,[o[7]||(o[7]=m("div",null,[m("h5",{class:"text-h5 text-white q-my-md"},"Typesense Dashboard")],-1)),m("div",null,[n(Z,{bordered:"",class:"q-pa-lg shadow-1"},{default:c(()=>[n(E,null,{default:c(()=>[n(ae,{class:"q-gutter-md"},{default:c(()=>[n(b,{modelValue:t.value.apiKey,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.apiKey=a),filled:"",type:"password",label:"Api Key"},null,8,["modelValue"]),r.$q.platform.is.electron?(p(),x("p",se," requires server with cors enabled only for search function. ")):(p(),x("p",re,"requires server with cors enabled.")),n(ee,{modelValue:t.value.node.protocol,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.node.protocol=a),filled:"",options:t.value.protocolOptions,label:"Protocol"},null,8,["modelValue","options"]),n(b,{modelValue:t.value.node.host,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.node.host=a),filled:"",type:"text",label:"host"},null,8,["modelValue"]),n(b,{modelValue:t.value.node.port,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.node.port=a),modelModifiers:{number:!0},filled:"",type:"number",label:"port"},null,8,["modelValue"]),n(b,{modelValue:t.value.node.path,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value.node.path=a),filled:"",type:"text",label:"path",hint:"optional: leave blank or start with / and end without /"},null,8,["modelValue"]),m("div",ue,[r.$q.platform.is.electron&&t.value.node.protocol==="https"?(p(),F(G,{key:0,modelValue:t.value.node.tls,"onUpdate:modelValue":o[5]||(o[5]=a=>t.value.node.tls=a),label:"Check TLS"},null,8,["modelValue"])):A("",!0)])]),_:1})]),_:1}),K(f).error?(p(),F(E,{key:0},{default:c(()=>[m("p",ie,H(K(f).error),1)]),_:1})):A("",!0),n(J,{class:"q-px-md row"},{default:c(()=>[n(P,{unelevated:"",color:"primary",size:"lg",style:{flex:"1"},label:"Login",onClick:o[6]||(o[6]=a=>h())}),n(P,{color:"primary",size:"lg",icon:"sym_s_history"},{default:c(()=>[n(oe,null,{default:c(()=>[n(te)]),_:1})]),_:1})]),_:1})]),_:1})])])]))}});export{ye as default};
