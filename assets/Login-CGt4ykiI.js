import{e as D,r as U,ad as I,ae as N,A as $,i as O,h as L,g as M,ai as R,aG as B,z as T,b8 as z,D as j,b9 as G,K as W,u as X,a4 as g,M as p,a1 as m,O as n,N as c,L as A,Y as E,a3 as F,a7 as b,ba as Y,S as K,X as H,a8 as J,W as P,a2 as Z}from"./index-COFOeL2T.js";import{c as ee,d as te}from"./QSelect-2an0Xdjf.js";import{_ as oe}from"./ServerHistory.vue_vue_type_script_setup_true_lang-BJ7wwyty.js";import"./format-BvkBI9bc.js";import"./QList-BdM4oJbp.js";const ae=D({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(i,{slots:f,emit:t}){const h=O(),r=U(null);let e=0;const o=[];function x(a){const d=typeof a=="boolean"?a:i.noErrorFocus!==!0,y=++e,_=(l,s)=>{t(`validation${l===!0?"Success":"Error"}`,s)},k=l=>{const s=l.validate();return typeof s.then=="function"?s.then(u=>({valid:u,comp:l}),u=>({valid:!1,comp:l,err:u})):Promise.resolve({valid:s,comp:l})};return(i.greedy===!0?Promise.all(o.map(k)).then(l=>l.filter(s=>s.valid!==!0)):o.reduce((l,s)=>l.then(()=>k(s).then(u=>{if(u.valid===!1)return Promise.reject(u)})),Promise.resolve()).catch(l=>[l])).then(l=>{if(l===void 0||l.length===0)return y===e&&_(!0),!0;if(y===e){const{comp:s,err:u}=l[0];if(u!==void 0&&console.error(u),_(!1,s),d===!0){const w=l.find(({comp:Q})=>typeof Q.focus=="function"&&R(Q.$)===!1);w!==void 0&&w.comp.focus()}}return!1})}function V(){e++,o.forEach(a=>{typeof a.resetValidation=="function"&&a.resetValidation()})}function S(a){a!==void 0&&B(a);const d=e+1;x().then(y=>{d===e&&y===!0&&(i.onSubmit!==void 0?t("submit",a):a?.target!==void 0&&typeof a.target.submit=="function"&&a.target.submit())})}function C(a){a!==void 0&&B(a),t("reset"),T(()=>{V(),i.autofocus===!0&&i.noResetFocus!==!0&&v()})}function v(){z(()=>{if(r.value===null)return;(r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1))?.focus({preventScroll:!0})})}j(G,{bindComponent(a){o.push(a)},unbindComponent(a){const d=o.indexOf(a);d!==-1&&o.splice(d,1)}});let q=!1;return I(()=>{q=!0}),N(()=>{q===!0&&i.autofocus===!0&&v()}),$(()=>{i.autofocus===!0&&v()}),Object.assign(h.proxy,{validate:x,resetValidation:V,submit:S,reset:C,focus:v,getValidationComponents:()=>o}),()=>L("form",{class:"q-form",ref:r,onSubmit:S,onReset:C},M(f.default))}}),le={class:"fullscreen row bg-primary text-center q-pa-md flex flex-center"},ne={class:"col col-md-4"},se={key:0},re={key:1},ue={class:"text-left"},ie={class:"text-red"},ye=W({__name:"Login",setup(i){const f=X();$(()=>{f.connectionCheck()});const t=U({apiKey:"",node:{host:"localhost",port:8108,protocol:"http",path:"",tls:!0},protocolOptions:["http","https"]});function h(){f.login({apiKey:t.value.apiKey,node:t.value.node})}return(r,e)=>(p(),g("div",le,[m("div",ne,[e[7]||(e[7]=m("div",null,[m("h5",{class:"text-h5 text-white q-my-md"},"Typesense Dashboard")],-1)),m("div",null,[n(Z,{bordered:"",class:"q-pa-lg shadow-1"},{default:c(()=>[n(F,null,{default:c(()=>[n(ae,{class:"q-gutter-md"},{default:c(()=>[n(b,{modelValue:t.value.apiKey,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.apiKey=o),filled:"",type:"password",label:"Api Key"},null,8,["modelValue"]),r.$q.platform.is.electron?(p(),g("p",se," requires server with cors enabled only for search function. ")):(p(),g("p",re,"requires server with cors enabled.")),n(ee,{modelValue:t.value.node.protocol,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.node.protocol=o),filled:"",options:t.value.protocolOptions,label:"Protocol"},null,8,["modelValue","options"]),n(b,{modelValue:t.value.node.host,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.node.host=o),filled:"",type:"text",label:"host"},null,8,["modelValue"]),n(b,{modelValue:t.value.node.port,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.node.port=o),modelModifiers:{number:!0},filled:"",type:"number",label:"port"},null,8,["modelValue"]),n(b,{modelValue:t.value.node.path,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.node.path=o),filled:"",type:"text",label:"path",hint:"optional: leave blank or start with / and end without /"},null,8,["modelValue"]),m("div",ue,[r.$q.platform.is.electron&&t.value.node.protocol==="https"?(p(),A(Y,{key:0,modelValue:t.value.node.tls,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.node.tls=o),label:"Check TLS"},null,8,["modelValue"])):E("",!0)])]),_:1})]),_:1}),K(f).error?(p(),A(F,{key:0},{default:c(()=>[m("p",ie,H(K(f).error),1)]),_:1})):E("",!0),n(J,{class:"q-px-md row"},{default:c(()=>[n(P,{unelevated:"",color:"primary",size:"lg",style:{flex:"1"},label:"Login",onClick:e[6]||(e[6]=o=>h())}),n(P,{color:"primary",size:"lg",icon:"sym_s_history"},{default:c(()=>[n(te,null,{default:c(()=>[n(oe)]),_:1})]),_:1})]),_:1})]),_:1})])])]))}});export{ye as default};
