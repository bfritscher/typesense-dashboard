import{Q as pr,a as Ze,b as vr,c as et}from"./QTabPanels-D8czFc3j.js";import{e as pe,h as L,B as Je,p as hr,r as M,i as Ut,s as yr,f as k,ad as _r,w as ve,ae as ye,af as mr,ag as gr,o as br,J as Sr,ah as tt,t as rt,G as xr,A as Rr,ai as qr,g as Tr,aj as Ar,ak as _e,K as Z,Z as W,L as H,M as z,N as T,V as Q,U as V,S as X,a5 as U,_ as Kt,O as E,a6 as Y,ac as at,X as K,$ as J,u as Xe,Q as Jt,R as G,P as nt,Y as Or,W as wr,a7 as Xt,al as Pr,am as Cr,T as Ir,an as kr}from"./index-NE-bokOZ.js";import{Q as Fr}from"./QPage-BS-xOWJk.js";import{a as Ye,Q as fe,b as se,c as jr}from"./QSelect-D6dImk3t.js";import{Q as Yt}from"./QList-4YABNyl2.js";import{Q as it}from"./QResizeObserver-C6Jg7Opa.js";import{Q as zr,T as ot}from"./QScrollObserver-BshpWIcd.js";import{b as te}from"./format-BvkBI9bc.js";import{Q as Zt}from"./QBanner-UACwnb73.js";import{M as $r}from"./MonacoEditor-CZKahp8v.js";import{u as Er}from"./use-quasar-BfjNnnY_.js";import{G as Mr,J as Nr}from"./ExperimentalDynamicWidgets-B3R5RgsO.js";import"./touch-BjYP5sR0.js";const Hr=pe({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(e){return()=>[L("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),L("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),Je(L("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),Je(L("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]}}),st=["vertical","horizontal"],me={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},lt={prevent:!0,mouse:!0,mouseAllDir:!0},ut=e=>e>=250?50:Math.ceil(e/5),Lr=pe({name:"QScrollArea",props:{...hr,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:c,emit:v}){const a=M(!1),l=M(!1),f=M(!1),s={vertical:M(0),horizontal:M(0)},u={vertical:{ref:M(null),position:M(0),size:M(0)},horizontal:{ref:M(null),position:M(0),size:M(0)}},{proxy:x}=Ut(),y=yr(e,x.$q);let _=null,h;const i=M(null),t=k(()=>"q-scrollarea"+(y.value===!0?" q-scrollarea--dark":""));Object.assign(s,{verticalInner:k(()=>s.vertical.value-e.verticalOffset[0]-e.verticalOffset[1]),horizontalInner:k(()=>s.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1])}),u.vertical.percentage=k(()=>{const m=u.vertical.size.value-s.vertical.value;if(m<=0)return 0;const R=te(u.vertical.position.value/m,0,1);return Math.round(R*1e4)/1e4}),u.vertical.thumbHidden=k(()=>(e.visible===null?f.value:e.visible)!==!0&&a.value===!1&&l.value===!1||u.vertical.size.value<=s.vertical.value+1),u.vertical.thumbStart=k(()=>e.verticalOffset[0]+u.vertical.percentage.value*(s.verticalInner.value-u.vertical.thumbSize.value)),u.vertical.thumbSize=k(()=>Math.round(te(s.verticalInner.value*s.verticalInner.value/u.vertical.size.value,ut(s.verticalInner.value),s.verticalInner.value))),u.vertical.style=k(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${u.vertical.thumbStart.value}px`,height:`${u.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`})),u.vertical.thumbClass=k(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.vertical.barClass=k(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),u.horizontal.percentage=k(()=>{const m=u.horizontal.size.value-s.horizontal.value;if(m<=0)return 0;const R=te(Math.abs(u.horizontal.position.value)/m,0,1);return Math.round(R*1e4)/1e4}),u.horizontal.thumbHidden=k(()=>(e.visible===null?f.value:e.visible)!==!0&&a.value===!1&&l.value===!1||u.horizontal.size.value<=s.horizontal.value+1),u.horizontal.thumbStart=k(()=>e.horizontalOffset[0]+u.horizontal.percentage.value*(s.horizontalInner.value-u.horizontal.thumbSize.value)),u.horizontal.thumbSize=k(()=>Math.round(te(s.horizontalInner.value*s.horizontalInner.value/u.horizontal.size.value,ut(s.horizontalInner.value),s.horizontalInner.value))),u.horizontal.style=k(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[x.$q.lang.rtl===!0?"right":"left"]:`${u.horizontal.thumbStart.value}px`,width:`${u.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`})),u.horizontal.thumbClass=k(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.horizontal.barClass=k(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const r=k(()=>u.vertical.thumbHidden.value===!0&&u.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle);function d(){const m={};return st.forEach(R=>{const I=u[R];Object.assign(m,{[R+"Position"]:I.position.value,[R+"Percentage"]:I.percentage.value,[R+"Size"]:I.size.value,[R+"ContainerSize"]:s[R].value,[R+"ContainerInnerSize"]:s[R+"Inner"].value})}),m}const o=_r(()=>{const m=d();m.ref=x,v("scroll",m)},0);function n(m,R,I){if(st.includes(m)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(m==="vertical"?tt:ye)(i.value,R,I)}function p({height:m,width:R}){let I=!1;s.vertical.value!==m&&(s.vertical.value=m,I=!0),s.horizontal.value!==R&&(s.horizontal.value=R,I=!0),I===!0&&O()}function b({position:m}){let R=!1;u.vertical.position.value!==m.top&&(u.vertical.position.value=m.top,R=!0),u.horizontal.position.value!==m.left&&(u.horizontal.position.value=m.left,R=!0),R===!0&&O()}function g({height:m,width:R}){u.horizontal.size.value!==R&&(u.horizontal.size.value=R,O()),u.vertical.size.value!==m&&(u.vertical.size.value=m,O())}function S(m,R){const I=u[R];if(m.isFirst===!0){if(I.thumbHidden.value===!0)return;h=I.position.value,l.value=!0}else if(l.value!==!0)return;m.isFinal===!0&&(l.value=!1);const w=me[R],$=(I.size.value-s[R].value)/(s[R+"Inner"].value-I.thumbSize.value),B=m.distance[w.dist],D=h+(m.direction===w.dir?1:-1)*B*$;j(D,R)}function q(m,R){const I=u[R];if(I.thumbHidden.value!==!0){const w=R==="vertical"?e.verticalOffset[0]:e.horizontalOffset[0],$=m[me[R].offset]-w,B=I.thumbStart.value-w;if($<B||$>B+I.thumbSize.value){const D=$-I.thumbSize.value/2,ee=te(D/(s[R+"Inner"].value-I.thumbSize.value),0,1);j(ee*Math.max(0,I.size.value-s[R].value),R)}I.ref.value!==null&&I.ref.value.dispatchEvent(new MouseEvent(m.type,m))}}function O(){a.value=!0,_!==null&&clearTimeout(_),_=setTimeout(()=>{_=null,a.value=!1},e.delay),e.onScroll!==void 0&&o()}function j(m,R){i.value[me[R].scroll]=m}let P=null;function F(){P!==null&&clearTimeout(P),P=setTimeout(()=>{P=null,f.value=!0},x.$q.platform.is.ios?50:0)}function C(){P!==null&&(clearTimeout(P),P=null),f.value=!1}let A=null;ve(()=>x.$q.lang.rtl,m=>{i.value!==null&&ye(i.value,Math.abs(u.horizontal.position.value)*(m===!0?-1:1))}),mr(()=>{A={top:u.vertical.position.value,left:u.horizontal.position.value}}),gr(()=>{if(A===null)return;const m=i.value;m!==null&&(ye(m,A.left),tt(m,A.top))}),br(o.cancel),Object.assign(x,{getScrollTarget:()=>i.value,getScroll:d,getScrollPosition:()=>({top:u.vertical.position.value,left:u.horizontal.position.value}),getScrollPercentage:()=>({top:u.vertical.percentage.value,left:u.horizontal.percentage.value}),setScrollPosition:n,setScrollPercentage(m,R,I){n(m,R*(u[m].size.value-s[m].value)*(m==="horizontal"&&x.$q.lang.rtl===!0?-1:1),I)}});const N={scroll:u,thumbVertDir:[[ot,m=>{S(m,"vertical")},void 0,{vertical:!0,...lt}]],thumbHorizDir:[[ot,m=>{S(m,"horizontal")},void 0,{horizontal:!0,...lt}]],onVerticalMousedown(m){q(m,"vertical")},onHorizontalMousedown(m){q(m,"horizontal")}};return()=>L("div",{class:t.value,onMouseenter:F,onMouseleave:C},[L("div",{ref:i,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[L("div",{class:"q-scrollarea__content absolute",style:r.value},Sr(c.default,[L(it,{debounce:0,onResize:g})])),L(zr,{axis:"both",onScroll:b})]),L(it,{debounce:0,onResize:p}),L(Hr,{store:N,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}}),Br=pe({name:"QSpace",setup(){const e=L("div",{class:"q-space"});return()=>e}}),Dr={ratio:[String,Number]};function Gr(e,c){return k(()=>{const v=Number(e.ratio||(c!==void 0?c.value:void 0));return isNaN(v)!==!0&&v>0?{paddingBottom:`${100/v}%`}:null})}const Wr=1.7778,Qr=pe({name:"QImg",props:{...Dr,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Wr},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:c,emit:v}){const a=M(e.initialRatio),l=Gr(e,a),f=Ut(),{registerTimeout:s,removeTimeout:u}=rt(),{registerTimeout:x,removeTimeout:y}=rt(),_=k(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),h=k(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),i=[M(null),M(_.value)],t=M(0),r=M(!1),d=M(!1),o=k(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),n=k(()=>({width:e.width,height:e.height})),p=k(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),b=k(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function g(){if(y(),e.loadingShowDelay===0){r.value=!0;return}x(()=>{r.value=!0},e.loadingShowDelay)}function S(){y(),r.value=!1}function q({target:A}){_e(f)===!1&&(u(),a.value=A.naturalHeight===0?.5:A.naturalWidth/A.naturalHeight,O(A,1))}function O(A,N){N===1e3||_e(f)===!0||(A.complete===!0?j(A):s(()=>{O(A,N+1)},50))}function j(A){_e(f)!==!0&&(t.value=t.value^1,i[t.value].value=null,S(),A.getAttribute("__qerror")!=="true"&&(d.value=!1),v("load",A.currentSrc||A.src))}function P(A){u(),S(),d.value=!0,i[t.value].value=h.value,i[t.value^1].value=_.value,v("error",A)}function F(A){const N=i[A].value,m={key:"img_"+A,class:p.value,style:b.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...N};return t.value===A?Object.assign(m,{class:m.class+"current",onLoad:q,onError:P}):m.class+="loaded",L("div",{class:"q-img__container absolute-full",key:"img"+A},L("img",m))}function C(){return r.value===!1?L("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Tr(c[d.value===!0?"error":"default"])):L("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},c.loading!==void 0?c.loading():e.noSpinner===!0?void 0:[L(Ar,{color:e.spinnerColor,size:e.spinnerSize})])}{let A=function(){ve(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,N=>{u(),d.value=!1,N===null?(S(),i[t.value^1].value=_.value):g(),i[t.value].value=N},{immediate:!0})};xr.value===!0?Rr(A):A()}return()=>{const A=[];return l.value!==null&&A.push(L("div",{key:"filler",style:l.value})),i[0].value!==null&&A.push(F(0)),i[1].value!==null&&A.push(F(1)),A.push(L(qr,{name:"q-transition--fade"},C)),L("div",{key:"main",class:o.value,style:n.value,role:"img","aria-label":e.alt},A)}}}),Vr={key:0,class:"img-preview"},Ur=Z({__name:"SearchResultItemAttribute",props:{hit:{}},setup(e){const c=a=>a?(a=String(a),a.startsWith("http://")||a.startsWith("https://")):!1,v=a=>{if(!a)return!1;a=String(a);const l=["jpg","jpeg","png","gif","bmp","svg","webp"],f=a.split(".").pop()?.toLowerCase()||"";return l.includes(f)};return(a,l)=>{const f=W("ais-highlight");return z(),H(U,null,[T(f,{attribute:"a",hit:{_highlightResult:{a:a.hit}}},null,8,["hit"]),v(a.hit?.value)?(z(),H("div",Vr,[T(Qr,{src:a.hit.value,fit:"contain",class:"img-preview"},null,8,["src"])])):Q("",!0),c(a.hit?.value)?(z(),V(X,{key:1,class:"absolute-top-right",flat:"",href:a.hit.value,target:"_blank",size:"sm",padding:"sm",icon:"sym_s_open_in_new",title:"open"},null,8,["href"])):Q("",!0)],64)}}}),ct=Kt(Ur,[["__scopeId","data-v-1b631cd2"]]),Kr={key:0},Jr={key:0},Xr={key:1},Yr=Z({__name:"SearchResultItemNestedDisplay",props:{item:{},includeFields:{default:()=>[]},embedFields:{default:()=>[]}},setup(e){const c=e;function v(s){return s.some(u=>u.value&&u.matchLevel)}function a(s,u){return s.filter(x=>x.startsWith(u)&&x!==u).map(x=>x.replace(`${u}.`,""))}const l=k(()=>{const s=Object.keys(c.item);return c.includeFields.filter(u=>s.includes(u)).concat(s.filter(u=>!c.includeFields.includes(u)))});function f(s){if(s==null||typeof s!="object")return s;if(Array.isArray(s))return s.map(x=>f(x));if(Object.prototype.hasOwnProperty.call(s,"value")&&Object.prototype.hasOwnProperty.call(s,"matchLevel"))return s.value;const u={};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(u[x]=f(s[x]));return u}return(s,u)=>{const x=W("search-result-item-nested-display",!0);return z(),V(Yt,{dense:""},{default:E(()=>[(z(!0),H(U,null,Y(l.value,y=>(z(),V(Ye,{key:y},{default:E(()=>[T(fe,{side:"",class:"q-mt-sm text-body2"},{default:E(()=>[T(se,{caption:"",class:at(c.includeFields.includes(y)?"schema-field":"text-warning unknown-field")},{default:E(()=>[K(J(y)+" ",1),Array.isArray(s.item[y])&&s.item[y].length>1?(z(),H("span",Kr,"["+J(s.item[y].length)+"]",1)):Q("",!0)]),_:2},1032,["class"]),c.embedFields.includes(y)?Q("",!0):(z(),V(se,{key:0,class:"overflow-hidden text-no-wrap text-ellipsis",title:JSON.stringify(f(s.item[y]),null,2)},{default:E(()=>[Array.isArray(s.item[y])?(z(),H("div",{key:0,class:at(v(s.item[y])?"array-field":"nested-field")},[(z(!0),H(U,null,Y(s.item[y],(_,h)=>(z(),H(U,{key:h},[_.value&&_.matchLevel?(z(),H("div",Jr,[T(ct,{hit:_},null,8,["hit"])])):(z(),V(x,{key:1,item:_,"include-fields":a(c.includeFields,y),"embed-fields":a(c.embedFields,y)},null,8,["item","include-fields","embed-fields"]))],64))),128))],2)):(z(),H("div",Xr,[T(ct,{hit:s.item[y]},null,8,["hit"])]))]),_:2},1032,["title"]))]),_:2},1024)]),_:2},1024))),128))]),_:1})}}}),Zr={key:0,class:"column no-wrap search-result-item"},er=Z({__name:"SearchResultItem",props:{item:{}},emits:["deleted"],setup(e,{emit:c}){const v=e,a=c,l=Xe(),f=Er(),s=k(()=>l.currentCollection),u=k(()=>!v.item||!s.value||!s.value.fields?[]:s.value.fields.map(h=>h.name)),x=k(()=>!v.item||!s.value||!s.value.fields?[]:s.value.fields.filter(h=>h.embed).map(h=>h.name)),y=()=>{const h={};v.item&&(Object.keys(v.item).forEach(i=>{!i.startsWith("_")&&!["objectID","text_match"].includes(i)&&(h[i]=v.item?.[i])}),l.editDocuments([JSON.parse(JSON.stringify(h))]))},_=h=>{f.dialog({title:"Confirm",message:`Delete document with id: ${h}?`,cancel:!0,persistent:!0}).onOk(()=>{l.deleteDocumentById(h)?.then(()=>{a("deleted",h)}).catch(i=>{f.notify({type:"negative",message:`Error deleting document: ${i.message}`})})})};return(h,i)=>s.value?(z(),H("div",Zr,[h.item?(z(),V(Yr,{key:0,item:h.item._highlightResult,"include-fields":u.value,"embed-fields":x.value},null,8,["item","include-fields","embed-fields"])):Q("",!0),T(Br),T(Jt),T(Ye,null,{default:E(()=>[T(fe,null,{default:E(()=>[T(se,null,{default:E(()=>[T(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_edit",title:"Edit",onClick:i[0]||(i[0]=t=>y())})]),_:1})]),_:1}),T(fe,{side:""},{default:E(()=>[T(se,null,{default:E(()=>[T(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_delete_forever",title:"Delete",onClick:i[1]||(i[1]=t=>_(h.item?.id))})]),_:1})]),_:1})]),_:1})])):Q("",!0)}}),ea={class:"row"},ta={class:"col-9"},ra={class:"col-3"},aa={class:"q-mt-md"},na={key:1,class:"ais-Hits q-mt-md"},ia={class:"ais-Hits-list"},oa={key:2,class:"text-h5 q-mt-md"},sa={key:3},dt="typesense-search-history",la=Z({__name:"SearchJson",setup(e){const c=Xe(),v=M([]),a=M({q:"stark",query_by:"company_name",filter_by:"num_employees:>100",sort_by:"num_employees:desc",page:1,per_page:10,exhaustive_search:!0}),l=M(null),f=M(null),s=k(()=>c.currentCollection),u=k({get:()=>JSON.stringify(a.value,null,2),set:o=>{try{a.value=JSON.parse(o),l.value=null}catch(n){l.value=n.message}}}),x=k(()=>f.value?.hits?f.value.hits.map(o=>{const n=Object.assign({},o.document),p=b=>{if(b==null)return{value:String(b),matchLevel:"none"};if(Array.isArray(b))return b.map(g=>p(g));if(typeof b=="object"){const g={};for(const S in b)Object.prototype.hasOwnProperty.call(b,S)&&(g[S]=p(b[S]));return g}return{value:String(b),matchLevel:"none"}};return n._highlightResult=p(o.document),o.highlights.forEach(b=>{const g=b.field.split(".");let S=n._highlightResult;for(let O=0;O<g.length-1;O++){const j=g[O];S[j]!==void 0&&(S=S[j])}const q=g[g.length-1];S[q]!==void 0&&(Array.isArray(S[q])?S[q]=S[q].map(O=>typeof O=="object"&&O.value!==void 0?{...O,value:b.snippet,matchLevel:"full"}:{value:b.snippet,matchLevel:"full"}):typeof S[q]=="object"&&S[q].value!==void 0?S[q]={value:b.snippet,matchLevel:"full"}:S[q]={value:b.snippet,matchLevel:"full"})}),n}):[]),y=k(()=>JSON.stringify(f.value,null,2)),_=()=>{f.value&&c.exportToJson(f.value)},h=()=>{if(f.value?.hits){const o=f.value.hits.map(n=>n.document);c.exportToJson(o)}},i=()=>{nt.set(`${dt}-${s.value?.name||""}`,v.value.slice(0,20))},t=()=>{const o=u.value,n=v.value.indexOf(o);n!==0&&(n>0&&v.value.splice(n,1),v.value.unshift(o),i())},r=async()=>{f.value=null,l.value=null,t();try{f.value=await c.search(a.value)}catch(o){l.value=o.message}};return ve(s,()=>{v.value=nt.getItem(`${dt}-${s.value?.name||""}`)||[]},{immediate:!0}),(o,n)=>(z(),H(U,null,[G("div",ea,[G("div",ta,[T($r,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=p=>u.value=p),style:{height:"30vh","min-height":"200px"}},null,8,["modelValue"])]),G("div",ra,[T(Lr,{style:{height:"100%"}},{default:E(()=>[T(Yt,{bordered:"",separator:"",dense:""},{default:E(()=>[T(se,{header:""},{default:E(()=>[...n[4]||(n[4]=[K("History",-1)])]),_:1}),(z(!0),H(U,null,Y(v.value,p=>Je((z(),V(Ye,{key:p,clickable:"",title:p,onClick:b=>u.value=p},{default:E(()=>[T(fe,null,{default:E(()=>[K(J(p.slice(0,60)),1)]),_:2},1024)]),_:2},1032,["title","onClick"])),[[Or]])),128))]),_:1})]),_:1})])]),l.value?(z(),V(Zt,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:E(()=>[K(" Invalid Format: "+J(l.value),1)]),_:1})):Q("",!0),G("div",aa,[T(X,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!l.value,onClick:n[1]||(n[1]=p=>r())},{default:E(()=>[...n[5]||(n[5]=[K("Run Query",-1)])]),_:1},8,["disable"]),T(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!f.value||!f.value.hits,onClick:n[2]||(n[2]=p=>h())},{default:E(()=>[...n[6]||(n[6]=[K("Export Hits",-1)])]),_:1},8,["disable"]),T(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!f.value,onClick:n[3]||(n[3]=p=>_())},{default:E(()=>[...n[7]||(n[7]=[K("Export Raw Results",-1)])]),_:1},8,["disable"])]),x.value?(z(),H("div",na,[G("ol",ia,[(z(!0),H(U,null,Y(x.value,p=>(z(),H("li",{key:p.id,class:"ais-Hits-item"},[T(er,{item:p},null,8,["item"])]))),128))])])):Q("",!0),f.value&&f.value.hits&&f.value.hits.length===0?(z(),H("div",oa," No match found ")):Q("",!0),f.value&&!f.value.hits?(z(),H("pre",sa,"          "+J(y.value)+`
        `,1)):Q("",!0)],64))}}),ua={mixins:[Mr({connector:Nr})],props:{delay:{type:Number,default:200,required:!1}},data(){return{timerId:null,localQuery:""}},computed:{query:{get(){return this.localQuery},set(e){this.localQuery=e,this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.state.refine(this.localQuery)},this.delay)}}},unmounted(){this.timerId&&clearTimeout(this.timerId)},methods:{clear(){this.query=""}}};function ca(e,c,v,a,l,f){return z(),V(Xt,{modelValue:f.query,"onUpdate:modelValue":c[0]||(c[0]=s=>f.query=s),dense:"",autofocus:"",outlined:"",type:"search",clearable:"","clear-icon":"close",placeholder:"Search...",onClear:f.clear},{prepend:E(()=>[T(wr,{name:"search"})]),_:1},8,["modelValue","onClear"])}const da=Kt(ua,[["render",ca]]);var ge={},be={exports:{}},ft;function le(){return ft||(ft=1,function(e){function c(v){return v&&v.__esModule?v:{default:v}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(be)),be.exports}var Se={exports:{}},xe={exports:{}},pt;function tr(){return pt||(pt=1,function(e){function c(v,a){this.v=v,this.k=a}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(xe)),xe.exports}var Re={exports:{}},qe={exports:{}},vt;function rr(){return vt||(vt=1,function(e){function c(v,a,l,f){var s=Object.defineProperty;try{s({},"",{})}catch{s=0}e.exports=c=function(x,y,_,h){function i(t,r){c(x,t,function(d){return this._invoke(t,r,d)})}y?s?s(x,y,{value:_,enumerable:!h,configurable:!h,writable:!h}):x[y]=_:(i("next",0),i("throw",1),i("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,c(v,a,l,f)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(qe)),qe.exports}var ht;function ar(){return ht||(ht=1,function(e){var c=rr();function v(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var a,l,f=typeof Symbol=="function"?Symbol:{},s=f.iterator||"@@iterator",u=f.toStringTag||"@@toStringTag";function x(o,n,p,b){var g=n&&n.prototype instanceof _?n:_,S=Object.create(g.prototype);return c(S,"_invoke",function(q,O,j){var P,F,C,A=0,N=j||[],m=!1,R={p:0,n:0,v:a,a:I,f:I.bind(a,4),d:function($,B){return P=$,F=0,C=a,R.n=B,y}};function I(w,$){for(F=w,C=$,l=0;!m&&A&&!B&&l<N.length;l++){var B,D=N[l],ee=R.p,de=D[2];w>3?(B=de===$)&&(C=D[(F=D[4])?5:(F=3,3)],D[4]=D[5]=a):D[0]<=ee&&((B=w<2&&ee<D[1])?(F=0,R.v=$,R.n=D[1]):ee<de&&(B=w<3||D[0]>$||$>de)&&(D[4]=w,D[5]=$,R.n=de,F=0))}if(B||w>1)return y;throw m=!0,$}return function(w,$,B){if(A>1)throw TypeError("Generator is already running");for(m&&$===1&&I($,B),F=$,C=B;(l=F<2?a:C)||!m;){P||(F?F<3?(F>1&&(R.n=-1),I(F,C)):R.n=C:R.v=C);try{if(A=2,P){if(F||(w="next"),l=P[w]){if(!(l=l.call(P,C)))throw TypeError("iterator result is not an object");if(!l.done)return l;C=l.value,F<2&&(F=0)}else F===1&&(l=P.return)&&l.call(P),F<2&&(C=TypeError("The iterator does not provide a '"+w+"' method"),F=1);P=a}else if((l=(m=R.n<0)?C:q.call(O,R))!==y)break}catch(D){P=a,F=1,C=D}finally{A=1}}return{value:l,done:m}}}(o,p,b),!0),S}var y={};function _(){}function h(){}function i(){}l=Object.getPrototypeOf;var t=[][s]?l(l([][s]())):(c(l={},s,function(){return this}),l),r=i.prototype=_.prototype=Object.create(t);function d(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,i):(o.__proto__=i,c(o,u,"GeneratorFunction")),o.prototype=Object.create(r),o}return h.prototype=i,c(r,"constructor",i),c(i,"constructor",h),h.displayName="GeneratorFunction",c(i,u,"GeneratorFunction"),c(r),c(r,u,"Generator"),c(r,s,function(){return this}),c(r,"toString",function(){return"[object Generator]"}),(e.exports=v=function(){return{w:x,m:d}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Re)),Re.exports}var Te={exports:{}},Ae={exports:{}},Oe={exports:{}},yt;function nr(){return yt||(yt=1,function(e){var c=tr(),v=rr();function a(l,f){function s(x,y,_,h){try{var i=l[x](y),t=i.value;return t instanceof c?f.resolve(t.v).then(function(r){s("next",r,_,h)},function(r){s("throw",r,_,h)}):f.resolve(t).then(function(r){i.value=r,_(i)},function(r){return s("throw",r,_,h)})}catch(r){h(r)}}var u;this.next||(v(a.prototype),v(a.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),v(this,"_invoke",function(x,y,_){function h(){return new f(function(i,t){s(x,_,i,t)})}return u=u?u.then(h,h):h()},!0)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}(Oe)),Oe.exports}var _t;function ir(){return _t||(_t=1,function(e){var c=ar(),v=nr();function a(l,f,s,u,x){return new v(c().w(l,f,s,u),x||Promise)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}(Ae)),Ae.exports}var mt;function fa(){return mt||(mt=1,function(e){var c=ir();function v(a,l,f,s,u){var x=c(a,l,f,s,u);return x.next().then(function(y){return y.done?y.value:x.next()})}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Te)),Te.exports}var we={exports:{}},gt;function pa(){return gt||(gt=1,function(e){function c(v){var a=Object(v),l=[];for(var f in a)l.unshift(f);return function s(){for(;l.length;)if((f=l.pop())in a)return s.value=f,s.done=!1,s;return s.done=!0,s}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(we)),we.exports}var Pe={exports:{}},Ce={exports:{}},bt;function he(){return bt||(bt=1,function(e){function c(v){"@babel/helpers - typeof";return e.exports=c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e.exports.__esModule=!0,e.exports.default=e.exports,c(v)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ce)),Ce.exports}var St;function va(){return St||(St=1,function(e){var c=he().default;function v(a){if(a!=null){var l=a[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],f=0;if(l)return l.call(a);if(typeof a.next=="function")return a;if(!isNaN(a.length))return{next:function(){return a&&f>=a.length&&(a=void 0),{value:a&&a[f++],done:!a}}}}throw new TypeError(c(a)+" is not iterable")}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Pe)),Pe.exports}var xt;function ha(){return xt||(xt=1,function(e){var c=tr(),v=ar(),a=fa(),l=ir(),f=nr(),s=pa(),u=va();function x(){var y=v(),_=y.m(x),h=(Object.getPrototypeOf?Object.getPrototypeOf(_):_.__proto__).constructor;function i(d){var o=typeof d=="function"&&d.constructor;return!!o&&(o===h||(o.displayName||o.name)==="GeneratorFunction")}var t={throw:1,return:2,break:3,continue:3};function r(d){var o,n;return function(p){o||(o={stop:function(){return n(p.a,2)},catch:function(){return p.v},abrupt:function(g,S){return n(p.a,t[g],S)},delegateYield:function(g,S,q){return o.resultName=S,n(p.d,u(g),q)},finish:function(g){return n(p.f,g)}},n=function(g,S,q){p.p=o.prev,p.n=o.next;try{return g(S,q)}finally{o.next=p.n}}),o.resultName&&(o[o.resultName]=p.v,o.resultName=void 0),o.sent=p.v,o.next=p.n;try{return d.call(this,o)}finally{p.p=o.prev,p.n=o.next}}}return(e.exports=x=function(){return{wrap:function(n,p,b,g){return y.w(r(n),p,b,g&&g.reverse())},isGeneratorFunction:i,mark:y.m,awrap:function(n,p){return new c(n,p)},AsyncIterator:f,async:function(n,p,b,g,S){return(i(p)?l:a)(r(n),p,b,g,S)},keys:s,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=x,e.exports.__esModule=!0,e.exports.default=e.exports}(Se)),Se.exports}var Ie,Rt;function or(){if(Rt)return Ie;Rt=1;var e=ha()();Ie=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return Ie}var ke={exports:{}},qt;function sr(){return qt||(qt=1,function(e){function c(a,l,f,s,u,x,y){try{var _=a[x](y),h=_.value}catch(i){return void f(i)}_.done?l(h):Promise.resolve(h).then(s,u)}function v(a){return function(){var l=this,f=arguments;return new Promise(function(s,u){var x=a.apply(l,f);function y(h){c(x,s,u,y,_,"next",h)}function _(h){c(x,s,u,y,_,"throw",h)}y(void 0)})}}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(ke)),ke.exports}var Fe={exports:{}},Tt;function ue(){return Tt||(Tt=1,function(e){function c(v,a){if(!(v instanceof a))throw new TypeError("Cannot call a class as a function")}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Fe)),Fe.exports}var je={exports:{}},ze={exports:{}},$e={exports:{}},At;function ya(){return At||(At=1,function(e){var c=he().default;function v(a,l){if(c(a)!="object"||!a)return a;var f=a[Symbol.toPrimitive];if(f!==void 0){var s=f.call(a,l||"default");if(c(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(a)}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}($e)),$e.exports}var Ot;function lr(){return Ot||(Ot=1,function(e){var c=he().default,v=ya();function a(l){var f=v(l,"string");return c(f)=="symbol"?f:f+""}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}(ze)),ze.exports}var wt;function ce(){return wt||(wt=1,function(e){var c=lr();function v(l,f){for(var s=0;s<f.length;s++){var u=f[s];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,c(u.key),u)}}function a(l,f,s){return f&&v(l.prototype,f),s&&v(l,s),Object.defineProperty(l,"prototype",{writable:!1}),l}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}(je)),je.exports}var re={},Pt;function _a(){if(Pt)return re;Pt=1;var e=le();Object.defineProperty(re,"__esModule",{value:!0}),re.Configuration=void 0;var c=e(ue()),v=e(ce());return re.Configuration=function(){function a(){var l,f,s,u,x,y,_,h,i,t,r,d,o,n=this,p,b,g,S,q,O,j,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,c.default)(this,a),this.server=P.server||{nodes:[{host:"localhost",port:"8108",path:"",protocol:"http"}]},this.server.cacheSearchResultsForSeconds=(l=this.server.cacheSearchResultsForSeconds)!==null&&l!==void 0?l:2*60,this.additionalSearchParameters=(f=P.additionalSearchParameters)!==null&&f!==void 0?f:{},this.additionalSearchParameters.query_by=(s=(u=this.additionalSearchParameters.queryBy)!==null&&u!==void 0?u:this.additionalSearchParameters.query_by)!==null&&s!==void 0?s:"",this.additionalSearchParameters.preset=(x=(y=this.additionalSearchParameters.preset)!==null&&y!==void 0?y:this.additionalSearchParameters.preset)!==null&&x!==void 0?x:"",this.additionalSearchParameters.sort_by=(_=(h=this.additionalSearchParameters.sortBy)!==null&&h!==void 0?h:this.additionalSearchParameters.sort_by)!==null&&_!==void 0?_:"",this.additionalSearchParameters.highlight_full_fields=(i=(t=this.additionalSearchParameters.highlightFullFields)!==null&&t!==void 0?t:this.additionalSearchParameters.highlight_full_fields)!==null&&i!==void 0?i:this.additionalSearchParameters.query_by,this.geoLocationField=(r=P.geoLocationField)!==null&&r!==void 0?r:"_geoloc",this.facetableFieldsWithSpecialCharacters=(d=P.facetableFieldsWithSpecialCharacters)!==null&&d!==void 0?d:[],this.collectionSpecificSearchParameters=(o=P.collectionSpecificSearchParameters)!==null&&o!==void 0?o:{},Object.keys(this.collectionSpecificSearchParameters).forEach(function(F){var C,A,N,m,R,I,w=n.collectionSpecificSearchParameters[F];w.query_by=(C=w.queryBy)!==null&&C!==void 0?C:w.query_by,w.preset=(A=w.preset)!==null&&A!==void 0?A:w.preset,w.sort_by=(N=w.sortBy)!==null&&N!==void 0?N:w.sort_by,w.highlight_full_fields=(m=(R=(I=w.highlightFullFields)!==null&&I!==void 0?I:w.highlight_full_fields)!==null&&R!==void 0?R:n.additionalSearchParameters.highlight_full_fields)!==null&&m!==void 0?m:w.query_by,Object.keys(w).forEach(function($){return w[$]===void 0?delete w[$]:{}})}),this.renderingContent=P.renderingContent,this.flattenGroupedHits=(p=P.flattenGroupedHits)!==null&&p!==void 0?p:!0,this.facetByOptions=(b=P.facetByOptions)!==null&&b!==void 0?b:{},this.filterByOptions=(g=P.filterByOptions)!==null&&g!==void 0?g:{},this.sortByOptions=(S=P.sortByOptions)!==null&&S!==void 0?S:{},this.collectionSpecificFacetByOptions=(q=P.collectionSpecificFacetByOptions)!==null&&q!==void 0?q:{},this.collectionSpecificFilterByOptions=(O=P.collectionSpecificFilterByOptions)!==null&&O!==void 0?O:{},this.collectionSpecificSortByOptions=(j=P.collectionSpecificSortByOptions)!==null&&j!==void 0?j:{}}return(0,v.default)(a,[{key:"validate",value:function(){if((this.additionalSearchParameters.queryBy||Object.values(this.collectionSpecificSearchParameters).some(function(f){return f.queryBy}))&&console.warn("[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version. We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js."),this.additionalSearchParameters.query_by.length===0&&this.additionalSearchParameters.preset.length===0&&(Object.keys(this.collectionSpecificSearchParameters).length===0||Object.values(this.collectionSpecificSearchParameters).some(function(f){return(f.query_by||"").length===0&&(f.preset||"").length===0})))throw new Error("[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.")}}])}(),re}var ae={},Ee={exports:{}},Me={exports:{}},Ct;function ma(){return Ct||(Ct=1,function(e){function c(v,a){if(v==null)return{};var l={};for(var f in v)if({}.hasOwnProperty.call(v,f)){if(a.indexOf(f)!==-1)continue;l[f]=v[f]}return l}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Me)),Me.exports}var It;function ga(){return It||(It=1,function(e){var c=ma();function v(a,l){if(a==null)return{};var f,s,u=c(a,l);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(a);for(s=0;s<x.length;s++)f=x[s],l.indexOf(f)===-1&&{}.propertyIsEnumerable.call(a,f)&&(u[f]=a[f])}return u}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Ee)),Ee.exports}var Ne={exports:{}},He={exports:{}},kt;function ba(){return kt||(kt=1,function(e){function c(v){if(Array.isArray(v))return v}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(He)),He.exports}var Le={exports:{}},Ft;function Sa(){return Ft||(Ft=1,function(e){function c(v,a){var l=v==null?null:typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(l!=null){var f,s,u,x,y=[],_=!0,h=!1;try{if(u=(l=l.call(v)).next,a===0){if(Object(l)!==l)return;_=!1}else for(;!(_=(f=u.call(l)).done)&&(y.push(f.value),y.length!==a);_=!0);}catch(i){h=!0,s=i}finally{try{if(!_&&l.return!=null&&(x=l.return(),Object(x)!==x))return}finally{if(h)throw s}}return y}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Le)),Le.exports}var Be={exports:{}},De={exports:{}},jt;function ur(){return jt||(jt=1,function(e){function c(v,a){(a==null||a>v.length)&&(a=v.length);for(var l=0,f=Array(a);l<a;l++)f[l]=v[l];return f}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(De)),De.exports}var zt;function cr(){return zt||(zt=1,function(e){var c=ur();function v(a,l){if(a){if(typeof a=="string")return c(a,l);var f={}.toString.call(a).slice(8,-1);return f==="Object"&&a.constructor&&(f=a.constructor.name),f==="Map"||f==="Set"?Array.from(a):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?c(a,l):void 0}}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Be)),Be.exports}var Ge={exports:{}},$t;function xa(){return $t||($t=1,function(e){function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ge)),Ge.exports}var Et;function dr(){return Et||(Et=1,function(e){var c=ba(),v=Sa(),a=cr(),l=xa();function f(s,u){return c(s)||v(s,u)||a(s,u)||l()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports}(Ne)),Ne.exports}var Mt;function Ra(){if(Mt)return ae;Mt=1;var e=le();Object.defineProperty(ae,"__esModule",{value:!0}),ae.SearchRequestAdapter=void 0;var c=e(or()),v=e(ga()),a=e(sr()),l=e(dr()),f=e(ue()),s=e(ce()),u=["q","conversation","conversation_id","conversation_model_id"];return ae.SearchRequestAdapter=function(){function x(y,_,h){(0,f.default)(this,x),this.instantsearchRequests=y,this.typesenseClient=_,this.configuration=h,this.additionalSearchParameters=h.additionalSearchParameters,this.collectionSpecificSearchParameters=h.collectionSpecificSearchParameters}return(0,s.default)(x,[{key:"_shouldUseExactMatchForField",value:function(_,h){var i,t;return!(((i=this.configuration.collectionSpecificFilterByOptions)===null||i===void 0||(i=i[h])===null||i===void 0||(i=i[_])===null||i===void 0?void 0:i.exactMatch)===!1||((t=this.configuration.filterByOptions)===null||t===void 0||(t=t[_])===null||t===void 0?void 0:t.exactMatch)===!1)}},{key:"_adaptFacetFilters",value:function(_,h){var i=this,t="";if(!_)return t;var r=_.map(function(d){if(Array.isArray(d)){var o={};d.forEach(function(w){var $=i._parseFacetFilter(w),B=$.fieldName,D=$.fieldValue;o[B]=o[B]||[],o[B].push(D)}),Object.keys(o).length>1&&console.error("[Typesense-Instantsearch-Adapter] Typesense does not support cross-field ORs at the moment. The adapter could not OR values between these fields: ".concat(Object.keys(o).join(",")));var n=Object.keys(o)[0],p=o[n],b=p.reduce(function(w,$){return $.startsWith("-")&&!i._isNumber($)?w[0].push($.substring(1)):w[1].push($),w},[[],[]]),g=(0,l.default)(b,2),S=g[0],q=g[1],O=[];if(q.length>0){var j=i._shouldUseExactMatchForField(n,h)?":=":":";O.push("".concat(n).concat(j,"[").concat(q.map(function(w){return i._escapeFacetValue(w)}).join(","),"]"))}if(S.length>0){var P=i._shouldUseExactMatchForField(n,h)?":!=":":!";O.push("".concat(n).concat(P,"[").concat(S.map(function(w){return i._escapeFacetValue(w)}).join(","),"]"))}var F=O.filter(function(w){return w}).join(" && ");return F}else{var C=i._parseFacetFilter(d),A=C.fieldName,N=C.fieldValue,m;if(N.startsWith("-")&&!i._isNumber(N)){var R=i._shouldUseExactMatchForField(A,h)?":!=":":!";m="".concat(A).concat(R,"[").concat(i._escapeFacetValue(N.substring(1)),"]")}else{var I=i._shouldUseExactMatchForField(A,h)?":=":":";m="".concat(A).concat(I,"[").concat(i._escapeFacetValue(N),"]")}return m}});return t=r.join(" && "),t}},{key:"_parseFacetFilter",value:function(_){var h,i,t,r,d;if(((h=this.configuration.facetableFieldsWithSpecialCharacters)===null||h===void 0?void 0:h.length)>0){var o=this.configuration.facetableFieldsWithSpecialCharacters.flat().map(function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(i=new RegExp("^(".concat(o.join("|"),"):(.*)$")),t=_.match(i),t!=null)return r="".concat(t[1]),d="".concat(t[2]),{fieldName:r,fieldValue:d}}return i=this.constructor.DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX,t=_.match(i),t==null?console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a facet filter `".concat(_,"` with the Regex `").concat(i,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter.")):(r="".concat(t[1]).concat(t[2]),d="".concat(t[3])),{fieldName:r,fieldValue:d}}},{key:"_escapeFacetValue",value:function(_){return typeof _=="boolean"||_==="true"||_==="false"||this._isNumber(_)?_:"`".concat(_,"`")}},{key:"_isNumber",value:function(_){return Number.isInteger(_%1)||!!(_%1)}},{key:"_adaptNumericFilters",value:function(_){var h=this,i="";if(!_)return i;var t={};_.forEach(function(d){var o=h._parseNumericFilter(d),n=o.fieldName,p=o.operator,b=o.fieldValue;t[n]=t[n]||{},t[n][p]=b});var r=[];return Object.keys(t).forEach(function(d){t[d]["<="]!=null&&t[d][">="]!=null?r.push("".concat(d,":=[").concat(t[d][">="],"..").concat(t[d]["<="],"]")):t[d]["<="]!=null?r.push("".concat(d,":<=").concat(t[d]["<="])):t[d][">="]!=null?r.push("".concat(d,":>=").concat(t[d][">="])):t[d]["="]!=null?r.push("".concat(d,":=").concat(t[d]["="])):console.warn("[Typesense-Instantsearch-Adapter] Unsupported operator found ".concat(JSON.stringify(t[d])))}),i=r.join(" && "),i}},{key:"_parseNumericFilter",value:function(_){var h,i,t,r,d,o;if(((h=this.configuration.facetableFieldsWithSpecialCharacters)===null||h===void 0?void 0:h.length)>0){var n=this.configuration.facetableFieldsWithSpecialCharacters.map(function(q){return q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(i=new RegExp("^(".concat(n.join("|"),")(<=|>=|>|<|=)(.*)$")),t=_.match(i),t!=null){var p=t,b=(0,l.default)(p,4);return r=b[1],d=b[2],o=b[3],{fieldName:r,operator:d,fieldValue:o}}}if(i=this.constructor.DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX,t=_.match(i),t==null)console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a numeric filter `".concat(_,"` with the Regex `").concat(i,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter."));else{var g=t,S=(0,l.default)(g,4);r=S[1],d=S[2],o=S[3]}return{fieldName:r,operator:d,fieldValue:o}}},{key:"_adaptGeoFilter",value:function(_){var h=_.insideBoundingBox,i=_.aroundRadius,t=_.aroundLatLng,r=_.insidePolygon;if(h){var d,o,n,p;if(Array.isArray(h)){var b=h.flat(),g=(0,l.default)(b,4);d=g[0],o=g[1],n=g[2],p=g[3]}else{var S=h.split(","),q=(0,l.default)(S,4);d=q[0],o=q[1],n=q[2],p=q[3]}return"".concat(this.configuration.geoLocationField,":(").concat(d,", ").concat(o,", ").concat(d,", ").concat(p,", ").concat(n,", ").concat(p,", ").concat(n,", ").concat(o,")")}if(t||i){if(!i||i==="all")throw new Error("[Typesense-Instantsearch-Adapter] In Typesense, geo-filtering around a lat/lng also requires a numerical radius. So the `aroundRadius` parameter is required when `aroundLatLng` is used. If you intend to just geo-sort around a lat/long, you want to use the sortBy InstantSearch widget (or a virtual sortBy custom widget).");var O="".concat(parseFloat(i)/1e3," km");return"".concat(this.configuration.geoLocationField,":(").concat(t,", ").concat(O,")")}if(r){var j=r;return Array.isArray(r)&&(j=r.flat().join(",")),"".concat(this.configuration.geoLocationField,":(").concat(j,")")}}},{key:"_adaptFilters",value:function(_,h){var i=[];return _.filters&&i.push(_.filters),i.push(this._adaptFacetFilters(_.facetFilters,h)),i.push(this._adaptNumericFilters(_.numericFilters)),i.push(this._adaptGeoFilter(_)),i.filter(function(t){return t&&t!==""}).join(" && ")}},{key:"_adaptIndexName",value:function(_){return _.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[1]}},{key:"_adaptSortBy",value:function(_){return _.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[3]}},{key:"_adaptFacetBy",value:function(_,h){var i=this;return[_].flat().map(function(t){var r;return(r=i.configuration.collectionSpecificFacetByOptions)!==null&&r!==void 0&&(r=r[h])!==null&&r!==void 0&&r[t]?"".concat(t).concat(i.configuration.collectionSpecificFacetByOptions[h][t]):i.configuration.facetByOptions[t]?"".concat(t).concat(i.configuration.facetByOptions[t]):t}).join(",")}},{key:"_adaptRulesContextsToOverrideTags",value:function(_){return _.join(",")}},{key:"_buildSearchParameters",value:function(_){for(var h,i,t=_.params,r=_.indexName,d=this._adaptIndexName(r),o={},n=0,p=Object.entries(this.additionalSearchParameters);n<p.length;n++){var b=(0,l.default)(p[n],2),g=b[0],S=b[1];o[this._camelToSnakeCase(g)]=S}if(this.collectionSpecificSearchParameters[d])for(var q=0,O=Object.entries(this.collectionSpecificSearchParameters[d]);q<O.length;q++){var j=(0,l.default)(O[q],2),P=j[0],F=j[1];o[this._camelToSnakeCase(P)]=F}var C=Object.assign({},o),A=this._adaptSortBy(r);Object.assign(C,{collection:d,q:t.query===""||t.query===void 0?"*":t.query,facet_by:o.facet_by||this._adaptFacetBy(t.facets,d),filter_by:this._adaptFilters(t,d)||o.filter_by,sort_by:A||o.sort_by,max_facet_values:t.maxValuesPerFacet,page:(t.page||0)+1}),t.hitsPerPage!=null&&(C.per_page=t.hitsPerPage),t.facetQuery&&(C.facet_query="".concat(t.facetName,":").concat(t.facetQuery),C.per_page=0),t.ruleContexts&&t.ruleContexts.length>0&&(C.override_tags=this._adaptRulesContextsToOverrideTags(t.ruleContexts)),t.typesenseVectorQuery&&(C.vector_query=t.typesenseVectorQuery);var N=((h=this.configuration.collectionSpecificSortByOptions)===null||h===void 0||(h=h[d])===null||h===void 0?void 0:h[C.sort_by])||((i=this.configuration.sortByOptions)===null||i===void 0?void 0:i[C.sort_by]);return N?.enable_overrides!=null&&(C.enable_overrides=N.enable_overrides),Object.fromEntries(Object.entries(C).filter(function(m){var R=(0,l.default)(m,2);R[0];var I=R[1];return I!=null&&I!==""}))}},{key:"_camelToSnakeCase",value:function(_){return _.split(/(?=[A-Z])/).join("_").toLowerCase()}},{key:"request",value:function(){var y=(0,a.default)(c.default.mark(function h(){var i=this,t,r,d,o,n,p,b,g,S;return c.default.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return d=this.instantsearchRequests.map(function(j){return i._buildSearchParameters(j)}),o={},(((t=d[0])===null||t===void 0?void 0:t.conversation)===!0||((r=d[0])===null||r===void 0?void 0:r.conversation)==="true")&&(n=d[0],p=n.q,b=n.conversation,g=n.conversation_id,S=n.conversation_model_id,o={q:p,conversation:b,conversation_id:g,conversation_model_id:S},d=d.map(function(j){j.q,j.conversation,j.conversation_id,j.conversation_model_id;var P=(0,v.default)(j,u);return P})),O.abrupt("return",this.typesenseClient.multiSearch.perform({searches:d},o));case 4:case"end":return O.stop()}},h,this)}));function _(){return y.apply(this,arguments)}return _}()}],[{key:"INDEX_NAME_MATCHING_REGEX",get:function(){return new RegExp("^(.+?)(?=(/sort/(.*))|$)")}},{key:"DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*)((?!:).):(?!:)(.*)")}},{key:"DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*?)(<=|>=|>|<|=)(.*)")}}])}(),ae}var ne={},We={exports:{}},Qe={exports:{}},Nt;function qa(){return Nt||(Nt=1,function(e){var c=ur();function v(a){if(Array.isArray(a))return c(a)}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Qe)),Qe.exports}var Ve={exports:{}},Ht;function Ta(){return Ht||(Ht=1,function(e){function c(v){if(typeof Symbol<"u"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ve)),Ve.exports}var Ue={exports:{}},Lt;function Aa(){return Lt||(Lt=1,function(e){function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ue)),Ue.exports}var Bt;function Oa(){return Bt||(Bt=1,function(e){var c=qa(),v=Ta(),a=cr(),l=Aa();function f(s){return c(s)||v(s)||a(s)||l()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports}(We)),We.exports}var Ke={exports:{}},Dt;function wa(){return Dt||(Dt=1,function(e){var c=lr();function v(a,l,f){return(l=c(l))in a?Object.defineProperty(a,l,{value:f,enumerable:!0,configurable:!0,writable:!0}):a[l]=f,a}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports}(Ke)),Ke.exports}var ie={},Gt;function fr(){return Gt||(Gt=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.utils=void 0,ie.utils={_adaptHighlightTag:function(c,v,a){return c.replace(new RegExp("<mark>","g"),v||"<mark>").replace(new RegExp("</mark>","g"),a||"</mark>")},_adaptNumberOfPages:function(){var c=this.typesenseResponse.found/this.typesenseResponse.request_params.per_page;return Number.isFinite(c)?Math.ceil(c):1}}),ie}var Wt;function Pa(){if(Wt)return ne;Wt=1;var e=le();Object.defineProperty(ne,"__esModule",{value:!0}),ne.SearchResponseAdapter=void 0;var c=e(he()),v=e(dr()),a=e(Oa()),l=e(wa()),f=e(ue()),s=e(ce()),u=fr();function x(h,i){var t=Object.keys(h);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(h);i&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(h,d).enumerable})),t.push.apply(t,r)}return t}function y(h){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?x(Object(t),!0).forEach(function(r){(0,l.default)(h,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach(function(r){Object.defineProperty(h,r,Object.getOwnPropertyDescriptor(t,r))})}return h}var _=ne.SearchResponseAdapter=function(){function h(i,t,r){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};(0,f.default)(this,h),this.typesenseResponse=i,this.instantsearchRequest=t,this.configuration=r,this.allTypesenseResults=d,this.fullTypesenseResponse=o}return(0,s.default)(h,[{key:"_adaptGroupedHits",value:function(t){var r=this,d=[];return d=t.map(function(o){var n=r._adaptHits(o.hits);return n.forEach(function(p){p.group_key=p._group_key=o.group_key,o.found&&(p._group_found=o.found)}),n}),this.configuration.flattenGroupedHits?d=d.flat():d=d.map(function(o){return y(y({},o[0]),{},{_grouped_hits:o})}),d}},{key:"_adaptHits",value:function(t){var r=this,d=[];return d=t.map(function(o){var n=y({},o.document);n.objectID=o.document.id,n._snippetResult=r._adaptHighlightResult(o,"snippet"),n._highlightResult=r._adaptHighlightResult(o,"value"),n._rawTypesenseHit=o,r.fullTypesenseResponse.conversation&&(n._rawTypesenseConversation=r.fullTypesenseResponse.conversation),["text_match","geo_distance_meters","curated","text_match_info","hybrid_search_info","vector_distance"].forEach(function(b){Object.keys(o).includes(b)&&!Object.keys(n).includes(b)&&(n[b]=o[b])});var p=n[r.configuration.geoLocationField];return p&&(n._geoloc={lat:p[0],lng:p[1]}),n}),d}},{key:"_adaptHighlightResult",value:function(t,r){var d={};return t.highlight!=null&&this.isHighlightPost0240RCN32Format(t.highlight)?this.adaptHighlightObject(t,d,r):this.adaptHighlightsArray(t,d,r),d}},{key:"isHighlightPost0240RCN32Format",value:function(t){return t.full==null&&t.snippet==null}},{key:"adaptHighlightsArray",value:function(t,r,d){var o=this;Object.assign.apply(Object,[r].concat((0,a.default)(Object.entries(t.document).map(function(n){var p=(0,v.default)(n,2),b=p[0],g=p[1];return(0,l.default)({},b,{value:g,matchLevel:"none",matchedWords:[]})})))),t.highlights.forEach(function(n){r[n.field]={value:n[d]||n["".concat(d,"s")],matchLevel:"full",matchedWords:n.matched_tokens},n.indices&&(r[n.field].matchedIndices=n.indices)}),Object.entries(r).forEach(function(n){var p=(0,v.default)(n,2),b=p[0],g=p[1],S=b,q=g.value,O=g.matchLevel,j=g.matchedWords,P=g.matchedIndices;q==null?r[S]=o._adaptHighlightNullValue():Array.isArray(q)?(r[S]=[],t.document[S].forEach(function(F,C){P&&P.includes(C)?r[S].push({value:o._adaptHighlightTag("".concat(q[P.indexOf(C)]),o.instantsearchRequest.params.highlightPreTag,o.instantsearchRequest.params.highlightPostTag),matchLevel:O,matchedWords:j[C]}):(0,c.default)(F)==="object"?r[S].push(o._adaptHighlightInObjectValue(F,{},d)):r[S].push({value:"".concat(F),matchLevel:"none",matchedWords:[]})})):(0,c.default)(q)==="object"?r[S]=o._adaptHighlightInObjectValue(q,{},d):r[S].value=o._adaptHighlightTag("".concat(q),o.instantsearchRequest.params.highlightPreTag,o.instantsearchRequest.params.highlightPostTag)})}},{key:"adaptHighlightObject",value:function(t,r,d){Object.assign(r,this._adaptHighlightInObjectValue(t.document,t.highlight,d))}},{key:"_adaptHighlightInObjectValue",value:function(t,r,d){var o=this;return Object.assign.apply(Object,[{}].concat((0,a.default)(Object.entries(t).map(function(n){var p=(0,v.default)(n,2),b=p[0],g=p[1],S;if(g==null)S=o._adaptHighlightNullValue();else if(Array.isArray(g)){var q;S=o._adaptHighlightInArrayValue(g,(q=r?.[b])!==null&&q!==void 0?q:[],d)}else if((0,c.default)(g)==="object"){var O;S=o._adaptHighlightInObjectValue(g,(O=r?.[b])!==null&&O!==void 0?O:{},d)}else S=o._adaptHighlightInPrimitiveValue(g,r?.[b],d);return(0,l.default)({},b,S)}))))}},{key:"_adaptHighlightInArrayValue",value:function(t,r,d){var o=this;return t.map(function(n,p){var b;if(n==null)b=o._adaptHighlightNullValue();else if(Array.isArray(n)){var g;b=o._adaptHighlightInArrayValue(n,(g=r?.[p])!==null&&g!==void 0?g:[],d)}else if((0,c.default)(n)==="object"){var S;b=o._adaptHighlightInObjectValue(n,(S=r?.[p])!==null&&S!==void 0?S:{},d)}else b=o._adaptHighlightInPrimitiveValue(n,r?.[p],d);return b})}},{key:"_adaptHighlightInPrimitiveValue",value:function(t,r,d){if(r!=null){var o,n;return{value:this._adaptHighlightTag("".concat((o=(n=r[d])!==null&&n!==void 0?n:r.highlight)!==null&&o!==void 0?o:r.snippet),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:(r.matched_tokens||[]).length>0?"full":"none",matchedWords:r.matched_tokens||[]}}else return{value:this._adaptHighlightTag("".concat(t),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:"none",matchedWords:[]}}},{key:"_adaptHighlightNullValue",value:function(){return{value:"",matchLevel:"none",matchedWords:[]}}},{key:"_adaptFacets",value:function(t){var r={};return t.forEach(function(d){Object.assign(r,(0,l.default)({},d.field_name,Object.assign.apply(Object,[{}].concat((0,a.default)(d.counts.map(function(o){return(0,l.default)({},o.value,o.count)}))))))}),r}},{key:"_adaptFacetStats",value:function(t){var r={};return t.forEach(function(d){Object.keys(d.stats).length>0&&Object.assign(r,(0,l.default)({},d.field_name,d.stats))}),r}},{key:"_adaptRenderingContent",value:function(t){var r,d=Object.assign({},this.configuration.renderingContent);return((r=d.facetOrdering)===null||r===void 0||(r=r.facets)===null||r===void 0?void 0:r.order)==null&&(d.facetOrdering=d.facetOrdering||{},d.facetOrdering.facets=d.facetOrdering.facets||{},d.facetOrdering.facets.order=(0,a.default)(new Set(t.map(function(o){return o.field_name}).concat(this.allTypesenseResults.map(function(o){return o.facet_counts||[]}).flat().map(function(o){return o.field_name}).filter(function(o){return o}))))),d}},{key:"_adaptUserData",value:function(t){return t?Array.isArray(t)?t:[t]:[]}},{key:"adapt",value:function(){var t=this._adaptRenderingContent(this.typesenseResponse.facet_counts||[]),r=y({hits:this.typesenseResponse.grouped_hits?this._adaptGroupedHits(this.typesenseResponse.grouped_hits):this._adaptHits(this.typesenseResponse.hits),nbHits:this.typesenseResponse.found,page:this.typesenseResponse.page-1,nbPages:this._adaptNumberOfPages(),hitsPerPage:this.typesenseResponse.request_params.per_page,facets:this._adaptFacets(this.typesenseResponse.facet_counts||[]),facets_stats:this._adaptFacetStats(this.typesenseResponse.facet_counts||{}),query:this.typesenseResponse.request_params.q,processingTimeMS:this.typesenseResponse.search_time_ms},Object.keys(t).length>0?{renderingContent:t}:null);return this.typesenseResponse.metadata&&(r.appliedRules=["typesense-override"],r.userData=this._adaptUserData(this.typesenseResponse.metadata)),this.fullTypesenseResponse.conversation&&r.hits.length===0&&(r.hits=[{_rawTypesenseConversation:this.fullTypesenseResponse.conversation}]),r}}])}();return Object.assign(_.prototype,u.utils),ne}var oe={},Qt;function Ca(){if(Qt)return oe;Qt=1;var e=le();Object.defineProperty(oe,"__esModule",{value:!0}),oe.FacetSearchResponseAdapter=void 0;var c=e(ue()),v=e(ce()),a=fr(),l=oe.FacetSearchResponseAdapter=function(){function f(s,u){(0,c.default)(this,f),this.typesenseResponse=s,this.instantsearchRequest=u}return(0,v.default)(f,[{key:"_adaptFacetHits",value:function(u){var x=this,y={},_=u.find(function(h){return h.field_name===x.instantsearchRequest.params.facetName});return y=_.counts.map(function(h){return{value:h.value,highlighted:x._adaptHighlightTag(h.highlighted,x.instantsearchRequest.params.highlightPreTag,x.instantsearchRequest.params.highlightPostTag),count:h.count}}),y}},{key:"adapt",value:function(){var u={facetHits:this._adaptFacetHits(this.typesenseResponse.facet_counts),exhaustiveFacetsCount:!0,processingTimeMS:this.typesenseResponse.search_time_ms};return u}}])}();return Object.assign(l.prototype,a.utils),oe}var Vt;function Ia(){return Vt||(Vt=1,function(e){var c=le();Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var v=c(or()),a=c(sr()),l=c(ue()),f=c(ce()),s=_a(),u=Pr(),x=Ra(),y=Pa(),_=Ca();e.default=function(){function h(i){var t=this;(0,l.default)(this,h),this.updateConfiguration(i),this.searchClient={clearCache:function(){return t.clearCache()},search:function(d){return t.searchTypesenseAndAdapt(d)},searchForFacetValues:function(d){return t.searchTypesenseForFacetValuesAndAdapt(d)}}}return(0,f.default)(h,[{key:"searchTypesenseAndAdapt",value:function(){var i=(0,a.default)(v.default.mark(function r(d){var o=this,n,p;return v.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return n=g.sent,p=n.results.map(function(S,q){o._validateTypesenseResult(S);var O=new y.SearchResponseAdapter(S,d[q],o.configuration,n.results,n),j=O.adapt();return j}),g.abrupt("return",{results:p});case 8:throw g.prev=8,g.t0=g.catch(0),console.error(g.t0),g.t0;case 12:case"end":return g.stop()}},r,this,[[0,8]])}));function t(r){return i.apply(this,arguments)}return t}()},{key:"searchTypesenseForFacetValuesAndAdapt",value:function(){var i=(0,a.default)(v.default.mark(function r(d){var o=this,n,p;return v.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return n=g.sent,p=n.results.map(function(S,q){o._validateTypesenseResult(S);var O=new _.FacetSearchResponseAdapter(S,d[q],o.configuration);return O.adapt()}),g.abrupt("return",p);case 8:throw g.prev=8,g.t0=g.catch(0),console.error(g.t0),g.t0;case 12:case"end":return g.stop()}},r,this,[[0,8]])}));function t(r){return i.apply(this,arguments)}return t}()},{key:"_adaptAndPerformTypesenseRequest",value:function(){var i=(0,a.default)(v.default.mark(function r(d){var o,n;return v.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return o=new x.SearchRequestAdapter(d,this.typesenseClient,this.configuration),b.next=3,o.request();case 3:return n=b.sent,b.abrupt("return",n);case 5:case"end":return b.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"clearCache",value:function(){return this.typesenseClient=new u.SearchClient(this.configuration.server),this.searchClient}},{key:"updateConfiguration",value:function(t){return this.configuration=new s.Configuration(t),this.configuration.validate(),this.typesenseClient=new u.SearchClient(this.configuration.server),!0}},{key:"_validateTypesenseResult",value:function(t){if(t.error)throw new Error("".concat(t.code," - ").concat(t.error));if(!t.hits&&!t.grouped_hits)throw new Error("Did not find any hits. ".concat(t.code," - ").concat(t.error))}}])}()}(ge)),ge}var ka=Ia();const Fa=Cr(ka),ja={class:"row q-mt-md"},za={class:"col-3 q-pr-sm"},$a={class:"text-subtitle2 q-pt-md"},Ea={class:"text-subtitle2 q-pt-md"},Ma={class:"text-subtitle2 q-pt-md"},Na={class:"col-9"},Ha={key:1},La=Z({__name:"SearchInstantSearch",setup(e){const c=Xe(),v=M(null),a=M(),l=M(),f=M(null),s=M(null),u=M(4),x=[({instantSearchInstance:n})=>({subscribe(){l.value=n},unsubscribe(){l.value=null}})],y=k(()=>c.currentCollection),_=k(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(n=>n.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name)),h=k(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(n=>n.facet&&["string","string[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name)),i=k(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(n=>n.facet&&["bool","bool[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name)),t=k(()=>{if(!y.value||!y.value.fields)return[];const n=[{value:y.value.name,label:"Default"}];return y.value.fields.filter(p=>["int32","float"].includes(p.type)||p.type==="string"&&p.sort).forEach(p=>{y.value&&(n.push({value:`${y.value.name}/sort/${p.name}:asc`,label:`${p.name} asc`}),n.push({value:`${y.value.name}/sort/${p.name}:desc`,label:`${p.name} desc`}))}),n}),r=k(()=>c.data.stopwords.map(n=>n.id)),d=()=>{l.value&&y.value&&c.exportToJson(l.value.renderState[y.value.name].hits.results.hits)},o=()=>{a.value&&y.value&&a.value.updateConfiguration({...a.value.configuration,additionalSearchParameters:{...a.value.configuration.additionalSearchParameters,stopwords:s.value,max_candidates:u.value}})};return ve(()=>y.value,()=>{v.value=null,f.value=null,window.setTimeout(()=>{if(!c.loginData||!y.value)return;const n=(y.value?.fields||[]).filter(p=>p.index&&["string","string[]"].includes(p.type)&&!p.name.includes(".*")).map(p=>p.name).join(",");try{const p=new Fa({server:{nodes:[{...c.loginData.node}],apiKey:c.loginData.apiKey},additionalSearchParameters:{max_candidates:u.value,query_by:n}});a.value=p,v.value=p.searchClient}catch(p){f.value=p.message+"Using query_by: "+n,console.error(p)}})},{immediate:!0}),(n,p)=>{const b=W("ais-configure"),g=W("ais-search-box"),S=W("ais-stats"),q=W("ais-current-refinements"),O=W("ais-hits-per-page"),j=W("ais-sort-by"),P=W("ais-range-input"),F=W("ais-refinement-list"),C=W("ais-pagination"),A=W("ais-hits"),N=W("ais-instant-search");return v.value&&y.value?(z(),V(N,{key:0,"search-client":v.value,"index-name":y.value.name,middlewares:x},{default:E(()=>[T(b,{hitsPerPage:12}),T(g,{"index-name":"instant_search","search-client":v.value},{default:E(()=>[T(da)]),_:1},8,["search-client"]),T(S),T(q),G("div",ja,[G("div",za,[T(O,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"250 hits per page",value:250}]}),T(X,{flat:"",onClick:p[0]||(p[0]=m=>d())},{default:E(()=>[...p[6]||(p[6]=[K("export current page",-1)])]),_:1}),p[7]||(p[7]=G("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1)),T(j,{items:t.value},null,8,["items"]),p[8]||(p[8]=G("div",{class:"text-subtitle2 q-pt-md"},"Stopwords",-1)),T(jr,{modelValue:s.value,"onUpdate:modelValue":[p[1]||(p[1]=m=>s.value=m),p[2]||(p[2]=m=>o())],disable:!Ir(c).data.features.stopwords,outlined:"",clearable:"",dense:"","options-dense":"",options:r.value},null,8,["modelValue","disable","options"]),p[9]||(p[9]=G("div",{class:"text-subtitle2 q-pt-md"},"Max Candidates",-1)),T(Xt,{modelValue:u.value,"onUpdate:modelValue":[p[3]||(p[3]=m=>u.value=m),p[4]||(p[4]=m=>o())],modelModifiers:{number:!0},type:"number",outlined:"",dense:"",min:0,max:1e4,hint:"Number of similar words for prefix and typo searching"},null,8,["modelValue"]),(z(!0),H(U,null,Y(_.value,m=>(z(),H("div",{key:m,class:"q-mb-sm"},[G("div",$a,J(m),1),T(P,{searchable:!0,attribute:m},null,8,["attribute"])]))),128)),(z(!0),H(U,null,Y(h.value,m=>(z(),H("div",{key:m,class:"q-mb-sm"},[G("div",Ea,J(m),1),T(F,{class:"q-mb-sm",searchable:!0,attribute:m},null,8,["attribute"])]))),128)),(z(!0),H(U,null,Y(i.value,m=>(z(),H("div",{key:m,class:"q-mb-sm"},[G("div",Ma,J(m),1),T(F,{class:"q-mb-sm",attribute:m},null,8,["attribute"])]))),128))]),G("div",Na,[T(C,{class:"q-mb-md"}),T(A,null,kr({_:2},[y.value?{name:"item",fn:E(({item:m})=>[T(er,{item:m,onDeleted:p[5]||(p[5]=R=>l.value.refresh())},null,8,["item"])]),key:"0"}:void 0]),1024),T(C,{class:"q-my-md"})])])]),_:1},8,["search-client","index-name"])):f.value?(z(),H("div",Ha,[T(Zt,{"inline-actions":"",class:"text-white bg-red"},{default:E(()=>[K(J(f.value),1)]),_:1})])):Q("",!0)}}}),tn=Z({__name:"Search",setup(e){const c=M("form");return(v,a)=>(z(),V(Fr,{padding:""},{default:E(()=>[T(pr,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=l=>c.value=l),dense:"",class:"bg-primary text-white",align:"justify","narrow-indicator":""},{default:E(()=>[T(Ze,{name:"form",label:"InstantSearch Mode"}),T(Ze,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),T(Jt),T(vr,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=l=>c.value=l),animated:"","keep-alive":""},{default:E(()=>[T(et,{name:"form"},{default:E(()=>[T(La)]),_:1}),T(et,{name:"json",class:"q-pa-none"},{default:E(()=>[T(la)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{tn as default};
