import{K as h,u as y,f as C,U as b,M as S,O as d,R as m,N as r,X as u,W as x,$ as N,T as f,S as k}from"./index-CEKgHZlV.js";import{Q as O}from"./QPage-ClJgVpfE.js";import{u as K}from"./use-quasar-CFBXNBPC.js";import{C as Q}from"./CollectionUi-DZ5vi2-I.js";import"./QTabPanels-C3TLkYfn.js";import"./QResizeObserver-BvVLTfsL.js";import"./QSelect-BTcpWXTK.js";import"./format-BvkBI9bc.js";import"./touch-BjYP5sR0.js";import"./QBanner-vvPrIn6E.js";import"./MonacoEditor-8i3JrqBJ.js";const j={class:"row justify-between q-mb-md"},w={class:"text-h5"},P=h({__name:"Schema",setup(B){const p=K(),a=y(),n=C(()=>{const e=a.currentCollection;if(e){const t={name:e.name,fields:e.fields?.map(o=>{const l=["name","type","facet","optional","index","sort","infix","locale"],g=Object.keys(o).filter(s=>!l.includes(s));return l.concat(g).reduce((s,c)=>(s[c]=o[c],s),{})}),default_sorting_field:e.default_sorting_field};return Object.keys(e).filter(o=>!["name","fields","default_sorting_field","created_at","num_documents"].includes(o)).forEach(o=>{t[o]=e[o]}),t}return{name:"",fields:[],default_sorting_field:"",token_separators:[],symbols_to_index:[],enable_nested_fields:!1}});function _(e){p.dialog({title:"Confirm",message:`Drop ${e} and all documents?`,cancel:!0,persistent:!0}).onOk(()=>{a.dropCollection(e)})}function v(e){if(!n.value||!n.value.name||!n.value.fields)return;const t={fields:n.value.fields.map(i=>({name:i.name,drop:!0})).concat(JSON.parse(JSON.stringify(e.fields)))};a.updateCollection({collectionName:n.value.name,schema:t})}return(e,t)=>(S(),b(O,{padding:"",class:"column"},{default:d(()=>[m("div",j,[m("div",w,[r(x,{size:"md",name:"sym_s_data_object"}),u(" Schema for "+N(f(a).currentCollection?.name),1)]),r(k,{unelevated:"",color:"negative",onClick:t[0]||(t[0]=i=>_(f(a).currentCollection?.name||""))},{default:d(()=>t[1]||(t[1]=[u("Drop Collection")])),_:1,__:[1]})]),r(Q,{"initial-schema":n.value,"primary-action-label":"Update Schema",onSubmit:v},null,8,["initial-schema"])]),_:1}))}});export{P as default};
