import{Q as pr,a as Ze,b as vr,c as et}from"./QTabPanels-DQZI1hQK.js";import{e as Je,h as D,B as Ke,p as hr,r as M,i as Ut,s as yr,f as k,ad as mr,w as pe,ae as he,af as _r,ag as gr,o as br,J as Sr,ah as tt,t as rt,G as xr,A as Rr,ai as qr,g as Tr,aj as Ar,ak as ye,K as Z,Z as W,L as H,M as z,N as T,V as Q,U as V,S as X,a5 as U,_ as Kt,O as E,a6 as Y,ac as at,X as K,$ as J,u as Xe,Q as Jt,R as G,P as nt,Y as Or,W as wr,a7 as Xt,al as Pr,am as Cr,T as Ir,an as kr}from"./index-C-yUslDh.js";import{Q as Fr}from"./QPage-DZDjStMx.js";import{Q as se,a as jr}from"./QSelect-CMVbriqv.js";import{b as te,a as Ye,Q as fe}from"./QItem-GEGTCWs8.js";import{Q as Yt}from"./QList-DZek21Vd.js";import{Q as it}from"./QResizeObserver-8RrKg9DC.js";import{Q as zr,T as ot}from"./QScrollObserver-Bcl5K4EO.js";import{Q as Zt}from"./QBanner-CURL4Vkw.js";import{M as $r}from"./MonacoEditor-aHupVNDR.js";import{Q as Er}from"./QSpace-BB1p9am4.js";import{u as Mr}from"./use-quasar-fdzUVoPs.js";import{G as Nr,J as Hr}from"./ExperimentalDynamicWidgets-CqEUR5ys.js";import"./touch-BjYP5sR0.js";import"./QChip-DEvn5zOm.js";const Lr=Je({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(e){return()=>[D("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),D("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),Ke(D("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),Ke(D("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]}}),st=["vertical","horizontal"],me={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},lt={prevent:!0,mouse:!0,mouseAllDir:!0},ut=e=>e>=250?50:Math.ceil(e/5),Br=Je({name:"QScrollArea",props:{...hr,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:c,emit:v}){const n=M(!1),s=M(!1),f=M(!1),u={vertical:M(0),horizontal:M(0)},l={vertical:{ref:M(null),position:M(0),size:M(0)},horizontal:{ref:M(null),position:M(0),size:M(0)}},{proxy:x}=Ut(),y=yr(e,x.$q);let m=null,h;const i=M(null),t=k(()=>"q-scrollarea"+(y.value===!0?" q-scrollarea--dark":""));Object.assign(u,{verticalInner:k(()=>u.vertical.value-e.verticalOffset[0]-e.verticalOffset[1]),horizontalInner:k(()=>u.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1])}),l.vertical.percentage=k(()=>{const _=l.vertical.size.value-u.vertical.value;if(_<=0)return 0;const R=te(l.vertical.position.value/_,0,1);return Math.round(R*1e4)/1e4}),l.vertical.thumbHidden=k(()=>(e.visible===null?f.value:e.visible)!==!0&&n.value===!1&&s.value===!1||l.vertical.size.value<=u.vertical.value+1),l.vertical.thumbStart=k(()=>e.verticalOffset[0]+l.vertical.percentage.value*(u.verticalInner.value-l.vertical.thumbSize.value)),l.vertical.thumbSize=k(()=>Math.round(te(u.verticalInner.value*u.verticalInner.value/l.vertical.size.value,ut(u.verticalInner.value),u.verticalInner.value))),l.vertical.style=k(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${l.vertical.thumbStart.value}px`,height:`${l.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`})),l.vertical.thumbClass=k(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(l.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),l.vertical.barClass=k(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(l.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),l.horizontal.percentage=k(()=>{const _=l.horizontal.size.value-u.horizontal.value;if(_<=0)return 0;const R=te(Math.abs(l.horizontal.position.value)/_,0,1);return Math.round(R*1e4)/1e4}),l.horizontal.thumbHidden=k(()=>(e.visible===null?f.value:e.visible)!==!0&&n.value===!1&&s.value===!1||l.horizontal.size.value<=u.horizontal.value+1),l.horizontal.thumbStart=k(()=>e.horizontalOffset[0]+l.horizontal.percentage.value*(u.horizontalInner.value-l.horizontal.thumbSize.value)),l.horizontal.thumbSize=k(()=>Math.round(te(u.horizontalInner.value*u.horizontalInner.value/l.horizontal.size.value,ut(u.horizontalInner.value),u.horizontalInner.value))),l.horizontal.style=k(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[x.$q.lang.rtl===!0?"right":"left"]:`${l.horizontal.thumbStart.value}px`,width:`${l.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`})),l.horizontal.thumbClass=k(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(l.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),l.horizontal.barClass=k(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(l.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const r=k(()=>l.vertical.thumbHidden.value===!0&&l.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle);function d(){const _={};return st.forEach(R=>{const I=l[R];Object.assign(_,{[R+"Position"]:I.position.value,[R+"Percentage"]:I.percentage.value,[R+"Size"]:I.size.value,[R+"ContainerSize"]:u[R].value,[R+"ContainerInnerSize"]:u[R+"Inner"].value})}),_}const o=mr(()=>{const _=d();_.ref=x,v("scroll",_)},0);function a(_,R,I){if(st.includes(_)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(_==="vertical"?tt:he)(i.value,R,I)}function p({height:_,width:R}){let I=!1;u.vertical.value!==_&&(u.vertical.value=_,I=!0),u.horizontal.value!==R&&(u.horizontal.value=R,I=!0),I===!0&&O()}function b({position:_}){let R=!1;l.vertical.position.value!==_.top&&(l.vertical.position.value=_.top,R=!0),l.horizontal.position.value!==_.left&&(l.horizontal.position.value=_.left,R=!0),R===!0&&O()}function g({height:_,width:R}){l.horizontal.size.value!==R&&(l.horizontal.size.value=R,O()),l.vertical.size.value!==_&&(l.vertical.size.value=_,O())}function S(_,R){const I=l[R];if(_.isFirst===!0){if(I.thumbHidden.value===!0)return;h=I.position.value,s.value=!0}else if(s.value!==!0)return;_.isFinal===!0&&(s.value=!1);const w=me[R],$=(I.size.value-u[R].value)/(u[R+"Inner"].value-I.thumbSize.value),L=_.distance[w.dist],B=h+(_.direction===w.dir?1:-1)*L*$;j(B,R)}function q(_,R){const I=l[R];if(I.thumbHidden.value!==!0){const w=R==="vertical"?e.verticalOffset[0]:e.horizontalOffset[0],$=_[me[R].offset]-w,L=I.thumbStart.value-w;if($<L||$>L+I.thumbSize.value){const B=$-I.thumbSize.value/2,ee=te(B/(u[R+"Inner"].value-I.thumbSize.value),0,1);j(ee*Math.max(0,I.size.value-u[R].value),R)}I.ref.value!==null&&I.ref.value.dispatchEvent(new MouseEvent(_.type,_))}}function O(){n.value=!0,m!==null&&clearTimeout(m),m=setTimeout(()=>{m=null,n.value=!1},e.delay),e.onScroll!==void 0&&o()}function j(_,R){i.value[me[R].scroll]=_}let P=null;function F(){P!==null&&clearTimeout(P),P=setTimeout(()=>{P=null,f.value=!0},x.$q.platform.is.ios?50:0)}function C(){P!==null&&(clearTimeout(P),P=null),f.value=!1}let A=null;pe(()=>x.$q.lang.rtl,_=>{i.value!==null&&he(i.value,Math.abs(l.horizontal.position.value)*(_===!0?-1:1))}),_r(()=>{A={top:l.vertical.position.value,left:l.horizontal.position.value}}),gr(()=>{if(A===null)return;const _=i.value;_!==null&&(he(_,A.left),tt(_,A.top))}),br(o.cancel),Object.assign(x,{getScrollTarget:()=>i.value,getScroll:d,getScrollPosition:()=>({top:l.vertical.position.value,left:l.horizontal.position.value}),getScrollPercentage:()=>({top:l.vertical.percentage.value,left:l.horizontal.percentage.value}),setScrollPosition:a,setScrollPercentage(_,R,I){a(_,R*(l[_].size.value-u[_].value)*(_==="horizontal"&&x.$q.lang.rtl===!0?-1:1),I)}});const N={scroll:l,thumbVertDir:[[ot,_=>{S(_,"vertical")},void 0,{vertical:!0,...lt}]],thumbHorizDir:[[ot,_=>{S(_,"horizontal")},void 0,{horizontal:!0,...lt}]],onVerticalMousedown(_){q(_,"vertical")},onHorizontalMousedown(_){q(_,"horizontal")}};return()=>D("div",{class:t.value,onMouseenter:F,onMouseleave:C},[D("div",{ref:i,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[D("div",{class:"q-scrollarea__content absolute",style:r.value},Sr(c.default,[D(it,{debounce:0,onResize:g})])),D(zr,{axis:"both",onScroll:b})]),D(it,{debounce:0,onResize:p}),D(Lr,{store:N,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}}),Dr={ratio:[String,Number]};function Gr(e,c){return k(()=>{const v=Number(e.ratio||(c!==void 0?c.value:void 0));return isNaN(v)!==!0&&v>0?{paddingBottom:`${100/v}%`}:null})}const Wr=1.7778,Qr=Je({name:"QImg",props:{...Dr,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Wr},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:c,emit:v}){const n=M(e.initialRatio),s=Gr(e,n),f=Ut(),{registerTimeout:u,removeTimeout:l}=rt(),{registerTimeout:x,removeTimeout:y}=rt(),m=k(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),h=k(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),i=[M(null),M(m.value)],t=M(0),r=M(!1),d=M(!1),o=k(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),a=k(()=>({width:e.width,height:e.height})),p=k(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),b=k(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function g(){if(y(),e.loadingShowDelay===0){r.value=!0;return}x(()=>{r.value=!0},e.loadingShowDelay)}function S(){y(),r.value=!1}function q({target:A}){ye(f)===!1&&(l(),n.value=A.naturalHeight===0?.5:A.naturalWidth/A.naturalHeight,O(A,1))}function O(A,N){N===1e3||ye(f)===!0||(A.complete===!0?j(A):u(()=>{O(A,N+1)},50))}function j(A){ye(f)!==!0&&(t.value=t.value^1,i[t.value].value=null,S(),A.getAttribute("__qerror")!=="true"&&(d.value=!1),v("load",A.currentSrc||A.src))}function P(A){l(),S(),d.value=!0,i[t.value].value=h.value,i[t.value^1].value=m.value,v("error",A)}function F(A){const N=i[A].value,_={key:"img_"+A,class:p.value,style:b.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...N};return t.value===A?Object.assign(_,{class:_.class+"current",onLoad:q,onError:P}):_.class+="loaded",D("div",{class:"q-img__container absolute-full",key:"img"+A},D("img",_))}function C(){return r.value===!1?D("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Tr(c[d.value===!0?"error":"default"])):D("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},c.loading!==void 0?c.loading():e.noSpinner===!0?void 0:[D(Ar,{color:e.spinnerColor,size:e.spinnerSize})])}{let A=function(){pe(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,N=>{l(),d.value=!1,N===null?(S(),i[t.value^1].value=m.value):g(),i[t.value].value=N},{immediate:!0})};xr.value===!0?Rr(A):A()}return()=>{const A=[];return s.value!==null&&A.push(D("div",{key:"filler",style:s.value})),i[0].value!==null&&A.push(F(0)),i[1].value!==null&&A.push(F(1)),A.push(D(qr,{name:"q-transition--fade"},C)),D("div",{key:"main",class:o.value,style:a.value,role:"img","aria-label":e.alt},A)}}}),Vr={key:0,class:"img-preview"},Ur=Z({__name:"SearchResultItemAttribute",props:{hit:{}},setup(e){const c=n=>n?(n=String(n),n.startsWith("http://")||n.startsWith("https://")):!1,v=n=>{if(!n)return!1;n=String(n);const s=["jpg","jpeg","png","gif","bmp","svg","webp"],f=n.split(".").pop()?.toLowerCase()||"";return s.includes(f)};return(n,s)=>{const f=W("ais-highlight");return z(),H(U,null,[T(f,{attribute:"a",hit:{_highlightResult:{a:e.hit}}},null,8,["hit"]),v(e.hit?.value)?(z(),H("div",Vr,[T(Qr,{src:e.hit.value,fit:"contain",class:"img-preview"},null,8,["src"])])):Q("",!0),c(e.hit?.value)?(z(),V(X,{key:1,class:"absolute-top-right",flat:"",href:e.hit.value,target:"_blank",size:"sm",padding:"sm",icon:"sym_s_open_in_new",title:"open"},null,8,["href"])):Q("",!0)],64)}}}),ct=Kt(Ur,[["__scopeId","data-v-1b631cd2"]]),Kr={key:0},Jr={key:0},Xr={key:1},Yr=Z({__name:"SearchResultItemNestedDisplay",props:{item:{},includeFields:{default:()=>[]},embedFields:{default:()=>[]}},setup(e){const c=e;function v(u){return u.some(l=>l.value&&l.matchLevel)}function n(u,l){return u.filter(x=>x.startsWith(l)&&x!==l).map(x=>x.replace(`${l}.`,""))}const s=k(()=>{const u=Object.keys(c.item);return c.includeFields.filter(l=>u.includes(l)).concat(u.filter(l=>!c.includeFields.includes(l)))});function f(u){if(u==null||typeof u!="object")return u;if(Array.isArray(u))return u.map(x=>f(x));if(Object.prototype.hasOwnProperty.call(u,"value")&&Object.prototype.hasOwnProperty.call(u,"matchLevel"))return u.value;const l={};for(const x in u)Object.prototype.hasOwnProperty.call(u,x)&&(l[x]=f(u[x]));return l}return(u,l)=>{const x=W("search-result-item-nested-display",!0);return z(),V(Yt,{dense:""},{default:E(()=>[(z(!0),H(U,null,Y(s.value,y=>(z(),V(Ye,{key:y},{default:E(()=>[T(fe,{side:"",class:"q-mt-sm text-body2"},{default:E(()=>[T(se,{caption:"",class:at(c.includeFields.includes(y)?"schema-field":"text-warning unknown-field")},{default:E(()=>[K(J(y)+" ",1),Array.isArray(e.item[y])&&e.item[y].length>1?(z(),H("span",Kr,"["+J(e.item[y].length)+"]",1)):Q("",!0)]),_:2},1032,["class"]),c.embedFields.includes(y)?Q("",!0):(z(),V(se,{key:0,class:"overflow-hidden text-no-wrap text-ellipsis",title:JSON.stringify(f(e.item[y]),null,2)},{default:E(()=>[Array.isArray(e.item[y])?(z(),H("div",{key:0,class:at(v(e.item[y])?"array-field":"nested-field")},[(z(!0),H(U,null,Y(e.item[y],(m,h)=>(z(),H(U,{key:h},[m.value&&m.matchLevel?(z(),H("div",Jr,[T(ct,{hit:m},null,8,["hit"])])):(z(),V(x,{key:1,item:m,"include-fields":n(c.includeFields,y),"embed-fields":n(c.embedFields,y)},null,8,["item","include-fields","embed-fields"]))],64))),128))],2)):(z(),H("div",Xr,[T(ct,{hit:e.item[y]},null,8,["hit"])]))]),_:2},1032,["title"]))]),_:2},1024)]),_:2},1024))),128))]),_:1})}}}),Zr={key:0,class:"column no-wrap search-result-item"},er=Z({__name:"SearchResultItem",props:{item:{}},emits:["deleted"],setup(e,{emit:c}){const v=e,n=c,s=Xe(),f=Mr(),u=k(()=>s.currentCollection),l=k(()=>!v.item||!u.value||!u.value.fields?[]:u.value.fields.map(h=>h.name)),x=k(()=>!v.item||!u.value||!u.value.fields?[]:u.value.fields.filter(h=>h.embed).map(h=>h.name)),y=()=>{const h={};v.item&&(Object.keys(v.item).forEach(i=>{!i.startsWith("_")&&!["objectID","text_match"].includes(i)&&(h[i]=v.item?.[i])}),s.editDocuments([JSON.parse(JSON.stringify(h))]))},m=h=>{f.dialog({title:"Confirm",message:`Delete document with id: ${h}?`,cancel:!0,persistent:!0}).onOk(()=>{s.deleteDocumentById(h)?.then(()=>{n("deleted",h)}).catch(i=>{f.notify({type:"negative",message:`Error deleting document: ${i.message}`})})})};return(h,i)=>u.value?(z(),H("div",Zr,[e.item?(z(),V(Yr,{key:0,item:e.item._highlightResult,"include-fields":l.value,"embed-fields":x.value},null,8,["item","include-fields","embed-fields"])):Q("",!0),T(Er),T(Jt),T(Ye,null,{default:E(()=>[T(fe,null,{default:E(()=>[T(se,null,{default:E(()=>[T(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_edit",title:"Edit",onClick:i[0]||(i[0]=t=>y())})]),_:1})]),_:1}),T(fe,{side:""},{default:E(()=>[T(se,null,{default:E(()=>[T(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_delete_forever",title:"Delete",onClick:i[1]||(i[1]=t=>m(e.item?.id))})]),_:1})]),_:1})]),_:1})])):Q("",!0)}}),ea={class:"row"},ta={class:"col-9"},ra={class:"col-3"},aa={class:"q-mt-md"},na={key:1,class:"ais-Hits q-mt-md"},ia={class:"ais-Hits-list"},oa={key:2,class:"text-h5 q-mt-md"},sa={key:3},dt="typesense-search-history",la=Z({__name:"SearchJson",setup(e){const c=Xe(),v=M([]),n=M({q:"stark",query_by:"company_name",filter_by:"num_employees:>100",sort_by:"num_employees:desc",page:1,per_page:10,exhaustive_search:!0}),s=M(null),f=M(null),u=k(()=>c.currentCollection),l=k({get:()=>JSON.stringify(n.value,null,2),set:o=>{try{n.value=JSON.parse(o),s.value=null}catch(a){s.value=a.message}}}),x=k(()=>f.value?.hits?f.value.hits.map(o=>{const a=Object.assign({},o.document),p=b=>{if(b==null)return{value:String(b),matchLevel:"none"};if(Array.isArray(b))return b.map(g=>p(g));if(typeof b=="object"){const g={};for(const S in b)Object.prototype.hasOwnProperty.call(b,S)&&(g[S]=p(b[S]));return g}return{value:String(b),matchLevel:"none"}};return a._highlightResult=p(o.document),o.highlights.forEach(b=>{const g=b.field.split(".");let S=a._highlightResult;for(let O=0;O<g.length-1;O++){const j=g[O];S[j]!==void 0&&(S=S[j])}const q=g[g.length-1];S[q]!==void 0&&(Array.isArray(S[q])?S[q]=S[q].map(O=>typeof O=="object"&&O.value!==void 0?{...O,value:b.snippet,matchLevel:"full"}:{value:b.snippet,matchLevel:"full"}):typeof S[q]=="object"&&S[q].value!==void 0?S[q]={value:b.snippet,matchLevel:"full"}:S[q]={value:b.snippet,matchLevel:"full"})}),a}):[]),y=k(()=>JSON.stringify(f.value,null,2)),m=()=>{f.value&&c.exportToJson(f.value)},h=()=>{if(f.value?.hits){const o=f.value.hits.map(a=>a.document);c.exportToJson(o)}},i=()=>{nt.set(`${dt}-${u.value?.name||""}`,v.value.slice(0,20))},t=()=>{const o=l.value,a=v.value.indexOf(o);a!==0&&(a>0&&v.value.splice(a,1),v.value.unshift(o),i())},r=async()=>{f.value=null,s.value=null,t();try{f.value=await c.search(n.value)}catch(o){s.value=o.message}};return pe(u,()=>{v.value=nt.getItem(`${dt}-${u.value?.name||""}`)||[]},{immediate:!0}),(o,a)=>(z(),H(U,null,[G("div",ea,[G("div",ta,[T($r,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=p=>l.value=p),style:{height:"30vh","min-height":"200px"}},null,8,["modelValue"])]),G("div",ra,[T(Br,{style:{height:"100%"}},{default:E(()=>[T(Yt,{bordered:"",separator:"",dense:""},{default:E(()=>[T(se,{header:""},{default:E(()=>[...a[4]||(a[4]=[K("History",-1)])]),_:1}),(z(!0),H(U,null,Y(v.value,p=>Ke((z(),V(Ye,{key:p,clickable:"",title:p,onClick:b=>l.value=p},{default:E(()=>[T(fe,null,{default:E(()=>[K(J(p.slice(0,60)),1)]),_:2},1024)]),_:2},1032,["title","onClick"])),[[Or]])),128))]),_:1})]),_:1})])]),s.value?(z(),V(Zt,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:E(()=>[K(" Invalid Format: "+J(s.value),1)]),_:1})):Q("",!0),G("div",aa,[T(X,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!s.value,onClick:a[1]||(a[1]=p=>r())},{default:E(()=>[...a[5]||(a[5]=[K("Run Query",-1)])]),_:1},8,["disable"]),T(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!f.value||!f.value.hits,onClick:a[2]||(a[2]=p=>h())},{default:E(()=>[...a[6]||(a[6]=[K("Export Hits",-1)])]),_:1},8,["disable"]),T(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!f.value,onClick:a[3]||(a[3]=p=>m())},{default:E(()=>[...a[7]||(a[7]=[K("Export Raw Results",-1)])]),_:1},8,["disable"])]),x.value?(z(),H("div",na,[G("ol",ia,[(z(!0),H(U,null,Y(x.value,p=>(z(),H("li",{key:p.id,class:"ais-Hits-item"},[T(er,{item:p},null,8,["item"])]))),128))])])):Q("",!0),f.value&&f.value.hits&&f.value.hits.length===0?(z(),H("div",oa," No match found ")):Q("",!0),f.value&&!f.value.hits?(z(),H("pre",sa,"          "+J(y.value)+`
        `,1)):Q("",!0)],64))}}),ua={mixins:[Nr({connector:Hr})],props:{delay:{type:Number,default:200,required:!1}},data(){return{timerId:null,localQuery:""}},computed:{query:{get(){return this.localQuery},set(e){this.localQuery=e,this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.state.refine(this.localQuery)},this.delay)}}},unmounted(){this.timerId&&clearTimeout(this.timerId)},methods:{clear(){this.query=""}}};function ca(e,c,v,n,s,f){return z(),V(Xt,{modelValue:f.query,"onUpdate:modelValue":c[0]||(c[0]=u=>f.query=u),dense:"",autofocus:"",outlined:"",type:"search",clearable:"","clear-icon":"close",placeholder:"Search...",onClear:f.clear},{prepend:E(()=>[T(wr,{name:"search"})]),_:1},8,["modelValue","onClear"])}const da=Kt(ua,[["render",ca]]);var _e={},ge={exports:{}},ft;function le(){return ft||(ft=1,(function(e){function c(v){return v&&v.__esModule?v:{default:v}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(ge)),ge.exports}var be={exports:{}},Se={exports:{}},pt;function tr(){return pt||(pt=1,(function(e){function c(v,n){this.v=v,this.k=n}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Se)),Se.exports}var xe={exports:{}},Re={exports:{}},vt;function rr(){return vt||(vt=1,(function(e){function c(v,n,s,f){var u=Object.defineProperty;try{u({},"",{})}catch{u=0}e.exports=c=function(x,y,m,h){function i(t,r){c(x,t,function(d){return this._invoke(t,r,d)})}y?u?u(x,y,{value:m,enumerable:!h,configurable:!h,writable:!h}):x[y]=m:(i("next",0),i("throw",1),i("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,c(v,n,s,f)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Re)),Re.exports}var ht;function ar(){return ht||(ht=1,(function(e){var c=rr();function v(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,s,f=typeof Symbol=="function"?Symbol:{},u=f.iterator||"@@iterator",l=f.toStringTag||"@@toStringTag";function x(o,a,p,b){var g=a&&a.prototype instanceof m?a:m,S=Object.create(g.prototype);return c(S,"_invoke",(function(q,O,j){var P,F,C,A=0,N=j||[],_=!1,R={p:0,n:0,v:n,a:I,f:I.bind(n,4),d:function($,L){return P=$,F=0,C=n,R.n=L,y}};function I(w,$){for(F=w,C=$,s=0;!_&&A&&!L&&s<N.length;s++){var L,B=N[s],ee=R.p,de=B[2];w>3?(L=de===$)&&(C=B[(F=B[4])?5:(F=3,3)],B[4]=B[5]=n):B[0]<=ee&&((L=w<2&&ee<B[1])?(F=0,R.v=$,R.n=B[1]):ee<de&&(L=w<3||B[0]>$||$>de)&&(B[4]=w,B[5]=$,R.n=de,F=0))}if(L||w>1)return y;throw _=!0,$}return function(w,$,L){if(A>1)throw TypeError("Generator is already running");for(_&&$===1&&I($,L),F=$,C=L;(s=F<2?n:C)||!_;){P||(F?F<3?(F>1&&(R.n=-1),I(F,C)):R.n=C:R.v=C);try{if(A=2,P){if(F||(w="next"),s=P[w]){if(!(s=s.call(P,C)))throw TypeError("iterator result is not an object");if(!s.done)return s;C=s.value,F<2&&(F=0)}else F===1&&(s=P.return)&&s.call(P),F<2&&(C=TypeError("The iterator does not provide a '"+w+"' method"),F=1);P=n}else if((s=(_=R.n<0)?C:q.call(O,R))!==y)break}catch(B){P=n,F=1,C=B}finally{A=1}}return{value:s,done:_}}})(o,p,b),!0),S}var y={};function m(){}function h(){}function i(){}s=Object.getPrototypeOf;var t=[][u]?s(s([][u]())):(c(s={},u,function(){return this}),s),r=i.prototype=m.prototype=Object.create(t);function d(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,i):(o.__proto__=i,c(o,l,"GeneratorFunction")),o.prototype=Object.create(r),o}return h.prototype=i,c(r,"constructor",i),c(i,"constructor",h),h.displayName="GeneratorFunction",c(i,l,"GeneratorFunction"),c(r),c(r,l,"Generator"),c(r,u,function(){return this}),c(r,"toString",function(){return"[object Generator]"}),(e.exports=v=function(){return{w:x,m:d}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(xe)),xe.exports}var qe={exports:{}},Te={exports:{}},Ae={exports:{}},yt;function nr(){return yt||(yt=1,(function(e){var c=tr(),v=rr();function n(s,f){function u(x,y,m,h){try{var i=s[x](y),t=i.value;return t instanceof c?f.resolve(t.v).then(function(r){u("next",r,m,h)},function(r){u("throw",r,m,h)}):f.resolve(t).then(function(r){i.value=r,m(i)},function(r){return u("throw",r,m,h)})}catch(r){h(r)}}var l;this.next||(v(n.prototype),v(n.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),v(this,"_invoke",function(x,y,m){function h(){return new f(function(i,t){u(x,m,i,t)})}return l=l?l.then(h,h):h()},!0)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Ae)),Ae.exports}var mt;function ir(){return mt||(mt=1,(function(e){var c=ar(),v=nr();function n(s,f,u,l,x){return new v(c().w(s,f,u,l),x||Promise)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Te)),Te.exports}var _t;function fa(){return _t||(_t=1,(function(e){var c=ir();function v(n,s,f,u,l){var x=c(n,s,f,u,l);return x.next().then(function(y){return y.done?y.value:x.next()})}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(qe)),qe.exports}var Oe={exports:{}},gt;function pa(){return gt||(gt=1,(function(e){function c(v){var n=Object(v),s=[];for(var f in n)s.unshift(f);return function u(){for(;s.length;)if((f=s.pop())in n)return u.value=f,u.done=!1,u;return u.done=!0,u}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Oe)),Oe.exports}var we={exports:{}},Pe={exports:{}},bt;function ve(){return bt||(bt=1,(function(e){function c(v){"@babel/helpers - typeof";return e.exports=c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,c(v)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Pe)),Pe.exports}var St;function va(){return St||(St=1,(function(e){var c=ve().default;function v(n){if(n!=null){var s=n[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],f=0;if(s)return s.call(n);if(typeof n.next=="function")return n;if(!isNaN(n.length))return{next:function(){return n&&f>=n.length&&(n=void 0),{value:n&&n[f++],done:!n}}}}throw new TypeError(c(n)+" is not iterable")}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(we)),we.exports}var xt;function ha(){return xt||(xt=1,(function(e){var c=tr(),v=ar(),n=fa(),s=ir(),f=nr(),u=pa(),l=va();function x(){var y=v(),m=y.m(x),h=(Object.getPrototypeOf?Object.getPrototypeOf(m):m.__proto__).constructor;function i(d){var o=typeof d=="function"&&d.constructor;return!!o&&(o===h||(o.displayName||o.name)==="GeneratorFunction")}var t={throw:1,return:2,break:3,continue:3};function r(d){var o,a;return function(p){o||(o={stop:function(){return a(p.a,2)},catch:function(){return p.v},abrupt:function(g,S){return a(p.a,t[g],S)},delegateYield:function(g,S,q){return o.resultName=S,a(p.d,l(g),q)},finish:function(g){return a(p.f,g)}},a=function(g,S,q){p.p=o.prev,p.n=o.next;try{return g(S,q)}finally{o.next=p.n}}),o.resultName&&(o[o.resultName]=p.v,o.resultName=void 0),o.sent=p.v,o.next=p.n;try{return d.call(this,o)}finally{p.p=o.prev,p.n=o.next}}}return(e.exports=x=function(){return{wrap:function(a,p,b,g){return y.w(r(a),p,b,g&&g.reverse())},isGeneratorFunction:i,mark:y.m,awrap:function(a,p){return new c(a,p)},AsyncIterator:f,async:function(a,p,b,g,S){return(i(p)?s:n)(r(a),p,b,g,S)},keys:u,values:l}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=x,e.exports.__esModule=!0,e.exports.default=e.exports})(be)),be.exports}var Ce,Rt;function or(){if(Rt)return Ce;Rt=1;var e=ha()();Ce=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return Ce}var Ie={exports:{}},qt;function sr(){return qt||(qt=1,(function(e){function c(n,s,f,u,l,x,y){try{var m=n[x](y),h=m.value}catch(i){return void f(i)}m.done?s(h):Promise.resolve(h).then(u,l)}function v(n){return function(){var s=this,f=arguments;return new Promise(function(u,l){var x=n.apply(s,f);function y(h){c(x,u,l,y,m,"next",h)}function m(h){c(x,u,l,y,m,"throw",h)}y(void 0)})}}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(Ie)),Ie.exports}var ke={exports:{}},Tt;function ue(){return Tt||(Tt=1,(function(e){function c(v,n){if(!(v instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(ke)),ke.exports}var Fe={exports:{}},je={exports:{}},ze={exports:{}},At;function ya(){return At||(At=1,(function(e){var c=ve().default;function v(n,s){if(c(n)!="object"||!n)return n;var f=n[Symbol.toPrimitive];if(f!==void 0){var u=f.call(n,s||"default");if(c(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(ze)),ze.exports}var Ot;function lr(){return Ot||(Ot=1,(function(e){var c=ve().default,v=ya();function n(s){var f=v(s,"string");return c(f)=="symbol"?f:f+""}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(je)),je.exports}var wt;function ce(){return wt||(wt=1,(function(e){var c=lr();function v(s,f){for(var u=0;u<f.length;u++){var l=f[u];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(s,c(l.key),l)}}function n(s,f,u){return f&&v(s.prototype,f),u&&v(s,u),Object.defineProperty(s,"prototype",{writable:!1}),s}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Fe)),Fe.exports}var re={},Pt;function ma(){if(Pt)return re;Pt=1;var e=le();Object.defineProperty(re,"__esModule",{value:!0}),re.Configuration=void 0;var c=e(ue()),v=e(ce());return re.Configuration=(function(){function n(){var s,f,u,l,x,y,m,h,i,t,r,d,o,a=this,p,b,g,S,q,O,j,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,c.default)(this,n),this.server=P.server||{nodes:[{host:"localhost",port:"8108",path:"",protocol:"http"}]},this.server.cacheSearchResultsForSeconds=(s=this.server.cacheSearchResultsForSeconds)!==null&&s!==void 0?s:120,this.additionalSearchParameters=(f=P.additionalSearchParameters)!==null&&f!==void 0?f:{},this.additionalSearchParameters.query_by=(u=(l=this.additionalSearchParameters.queryBy)!==null&&l!==void 0?l:this.additionalSearchParameters.query_by)!==null&&u!==void 0?u:"",this.additionalSearchParameters.preset=(x=(y=this.additionalSearchParameters.preset)!==null&&y!==void 0?y:this.additionalSearchParameters.preset)!==null&&x!==void 0?x:"",this.additionalSearchParameters.sort_by=(m=(h=this.additionalSearchParameters.sortBy)!==null&&h!==void 0?h:this.additionalSearchParameters.sort_by)!==null&&m!==void 0?m:"",this.additionalSearchParameters.highlight_full_fields=(i=(t=this.additionalSearchParameters.highlightFullFields)!==null&&t!==void 0?t:this.additionalSearchParameters.highlight_full_fields)!==null&&i!==void 0?i:this.additionalSearchParameters.query_by,this.geoLocationField=(r=P.geoLocationField)!==null&&r!==void 0?r:"_geoloc",this.facetableFieldsWithSpecialCharacters=(d=P.facetableFieldsWithSpecialCharacters)!==null&&d!==void 0?d:[],this.collectionSpecificSearchParameters=(o=P.collectionSpecificSearchParameters)!==null&&o!==void 0?o:{},Object.keys(this.collectionSpecificSearchParameters).forEach(function(F){var C,A,N,_,R,I,w=a.collectionSpecificSearchParameters[F];w.query_by=(C=w.queryBy)!==null&&C!==void 0?C:w.query_by,w.preset=(A=w.preset)!==null&&A!==void 0?A:w.preset,w.sort_by=(N=w.sortBy)!==null&&N!==void 0?N:w.sort_by,w.highlight_full_fields=(_=(R=(I=w.highlightFullFields)!==null&&I!==void 0?I:w.highlight_full_fields)!==null&&R!==void 0?R:a.additionalSearchParameters.highlight_full_fields)!==null&&_!==void 0?_:w.query_by,Object.keys(w).forEach(function($){return w[$]===void 0?delete w[$]:{}})}),this.renderingContent=P.renderingContent,this.flattenGroupedHits=(p=P.flattenGroupedHits)!==null&&p!==void 0?p:!0,this.facetByOptions=(b=P.facetByOptions)!==null&&b!==void 0?b:{},this.filterByOptions=(g=P.filterByOptions)!==null&&g!==void 0?g:{},this.sortByOptions=(S=P.sortByOptions)!==null&&S!==void 0?S:{},this.collectionSpecificFacetByOptions=(q=P.collectionSpecificFacetByOptions)!==null&&q!==void 0?q:{},this.collectionSpecificFilterByOptions=(O=P.collectionSpecificFilterByOptions)!==null&&O!==void 0?O:{},this.collectionSpecificSortByOptions=(j=P.collectionSpecificSortByOptions)!==null&&j!==void 0?j:{}}return(0,v.default)(n,[{key:"validate",value:function(){if((this.additionalSearchParameters.queryBy||Object.values(this.collectionSpecificSearchParameters).some(function(f){return f.queryBy}))&&console.warn("[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version. We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js."),this.additionalSearchParameters.query_by.length===0&&this.additionalSearchParameters.preset.length===0&&(Object.keys(this.collectionSpecificSearchParameters).length===0||Object.values(this.collectionSpecificSearchParameters).some(function(f){return(f.query_by||"").length===0&&(f.preset||"").length===0})))throw new Error("[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.")}}])})(),re}var ae={},$e={exports:{}},Ee={exports:{}},Ct;function _a(){return Ct||(Ct=1,(function(e){function c(v,n){if(v==null)return{};var s={};for(var f in v)if({}.hasOwnProperty.call(v,f)){if(n.indexOf(f)!==-1)continue;s[f]=v[f]}return s}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Ee)),Ee.exports}var It;function ga(){return It||(It=1,(function(e){var c=_a();function v(n,s){if(n==null)return{};var f,u,l=c(n,s);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(n);for(u=0;u<x.length;u++)f=x[u],s.indexOf(f)===-1&&{}.propertyIsEnumerable.call(n,f)&&(l[f]=n[f])}return l}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})($e)),$e.exports}var Me={exports:{}},Ne={exports:{}},kt;function ba(){return kt||(kt=1,(function(e){function c(v){if(Array.isArray(v))return v}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Ne)),Ne.exports}var He={exports:{}},Ft;function Sa(){return Ft||(Ft=1,(function(e){function c(v,n){var s=v==null?null:typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(s!=null){var f,u,l,x,y=[],m=!0,h=!1;try{if(l=(s=s.call(v)).next,n===0){if(Object(s)!==s)return;m=!1}else for(;!(m=(f=l.call(s)).done)&&(y.push(f.value),y.length!==n);m=!0);}catch(i){h=!0,u=i}finally{try{if(!m&&s.return!=null&&(x=s.return(),Object(x)!==x))return}finally{if(h)throw u}}return y}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(He)),He.exports}var Le={exports:{}},Be={exports:{}},jt;function ur(){return jt||(jt=1,(function(e){function c(v,n){(n==null||n>v.length)&&(n=v.length);for(var s=0,f=Array(n);s<n;s++)f[s]=v[s];return f}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Be)),Be.exports}var zt;function cr(){return zt||(zt=1,(function(e){var c=ur();function v(n,s){if(n){if(typeof n=="string")return c(n,s);var f={}.toString.call(n).slice(8,-1);return f==="Object"&&n.constructor&&(f=n.constructor.name),f==="Map"||f==="Set"?Array.from(n):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?c(n,s):void 0}}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(Le)),Le.exports}var De={exports:{}},$t;function xa(){return $t||($t=1,(function(e){function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(De)),De.exports}var Et;function dr(){return Et||(Et=1,(function(e){var c=ba(),v=Sa(),n=cr(),s=xa();function f(u,l){return c(u)||v(u,l)||n(u,l)||s()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports})(Me)),Me.exports}var Mt;function Ra(){if(Mt)return ae;Mt=1;var e=le();Object.defineProperty(ae,"__esModule",{value:!0}),ae.SearchRequestAdapter=void 0;var c=e(or()),v=e(ga()),n=e(sr()),s=e(dr()),f=e(ue()),u=e(ce()),l=["q","conversation","conversation_id","conversation_model_id"];return ae.SearchRequestAdapter=(function(){function x(y,m,h){(0,f.default)(this,x),this.instantsearchRequests=y,this.typesenseClient=m,this.configuration=h,this.additionalSearchParameters=h.additionalSearchParameters,this.collectionSpecificSearchParameters=h.collectionSpecificSearchParameters}return(0,u.default)(x,[{key:"_shouldUseExactMatchForField",value:function(m,h){var i,t;return!(((i=this.configuration.collectionSpecificFilterByOptions)===null||i===void 0||(i=i[h])===null||i===void 0||(i=i[m])===null||i===void 0?void 0:i.exactMatch)===!1||((t=this.configuration.filterByOptions)===null||t===void 0||(t=t[m])===null||t===void 0?void 0:t.exactMatch)===!1)}},{key:"_adaptFacetFilters",value:function(m,h){var i=this,t="";if(!m)return t;var r=m.map(function(d){if(Array.isArray(d)){var o={};d.forEach(function(w){var $=i._parseFacetFilter(w),L=$.fieldName,B=$.fieldValue;o[L]=o[L]||[],o[L].push(B)}),Object.keys(o).length>1&&console.error("[Typesense-Instantsearch-Adapter] Typesense does not support cross-field ORs at the moment. The adapter could not OR values between these fields: ".concat(Object.keys(o).join(",")));var a=Object.keys(o)[0],p=o[a],b=p.reduce(function(w,$){return $.startsWith("-")&&!i._isNumber($)?w[0].push($.substring(1)):w[1].push($),w},[[],[]]),g=(0,s.default)(b,2),S=g[0],q=g[1],O=[];if(q.length>0){var j=i._shouldUseExactMatchForField(a,h)?":=":":";O.push("".concat(a).concat(j,"[").concat(q.map(function(w){return i._escapeFacetValue(w)}).join(","),"]"))}if(S.length>0){var P=i._shouldUseExactMatchForField(a,h)?":!=":":!";O.push("".concat(a).concat(P,"[").concat(S.map(function(w){return i._escapeFacetValue(w)}).join(","),"]"))}var F=O.filter(function(w){return w}).join(" && ");return F}else{var C=i._parseFacetFilter(d),A=C.fieldName,N=C.fieldValue,_;if(N.startsWith("-")&&!i._isNumber(N)){var R=i._shouldUseExactMatchForField(A,h)?":!=":":!";_="".concat(A).concat(R,"[").concat(i._escapeFacetValue(N.substring(1)),"]")}else{var I=i._shouldUseExactMatchForField(A,h)?":=":":";_="".concat(A).concat(I,"[").concat(i._escapeFacetValue(N),"]")}return _}});return t=r.join(" && "),t}},{key:"_parseFacetFilter",value:function(m){var h,i,t,r,d;if(((h=this.configuration.facetableFieldsWithSpecialCharacters)===null||h===void 0?void 0:h.length)>0){var o=this.configuration.facetableFieldsWithSpecialCharacters.flat().map(function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(i=new RegExp("^(".concat(o.join("|"),"):(.*)$")),t=m.match(i),t!=null)return r="".concat(t[1]),d="".concat(t[2]),{fieldName:r,fieldValue:d}}return i=this.constructor.DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX,t=m.match(i),t==null?console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a facet filter `".concat(m,"` with the Regex `").concat(i,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter.")):(r="".concat(t[1]).concat(t[2]),d="".concat(t[3])),{fieldName:r,fieldValue:d}}},{key:"_escapeFacetValue",value:function(m){return typeof m=="boolean"||m==="true"||m==="false"||this._isNumber(m)?m:"`".concat(m,"`")}},{key:"_isNumber",value:function(m){return Number.isInteger(m%1)||!!(m%1)}},{key:"_adaptNumericFilters",value:function(m){var h=this,i="";if(!m)return i;var t={};m.forEach(function(d){var o=h._parseNumericFilter(d),a=o.fieldName,p=o.operator,b=o.fieldValue;t[a]=t[a]||{},t[a][p]=b});var r=[];return Object.keys(t).forEach(function(d){t[d]["<="]!=null&&t[d][">="]!=null?r.push("".concat(d,":=[").concat(t[d][">="],"..").concat(t[d]["<="],"]")):t[d]["<="]!=null?r.push("".concat(d,":<=").concat(t[d]["<="])):t[d][">="]!=null?r.push("".concat(d,":>=").concat(t[d][">="])):t[d]["="]!=null?r.push("".concat(d,":=").concat(t[d]["="])):console.warn("[Typesense-Instantsearch-Adapter] Unsupported operator found ".concat(JSON.stringify(t[d])))}),i=r.join(" && "),i}},{key:"_parseNumericFilter",value:function(m){var h,i,t,r,d,o;if(((h=this.configuration.facetableFieldsWithSpecialCharacters)===null||h===void 0?void 0:h.length)>0){var a=this.configuration.facetableFieldsWithSpecialCharacters.map(function(q){return q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(i=new RegExp("^(".concat(a.join("|"),")(<=|>=|>|<|=)(.*)$")),t=m.match(i),t!=null){var p=t,b=(0,s.default)(p,4);return r=b[1],d=b[2],o=b[3],{fieldName:r,operator:d,fieldValue:o}}}if(i=this.constructor.DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX,t=m.match(i),t==null)console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a numeric filter `".concat(m,"` with the Regex `").concat(i,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter."));else{var g=t,S=(0,s.default)(g,4);r=S[1],d=S[2],o=S[3]}return{fieldName:r,operator:d,fieldValue:o}}},{key:"_adaptGeoFilter",value:function(m){var h=m.insideBoundingBox,i=m.aroundRadius,t=m.aroundLatLng,r=m.insidePolygon;if(h){var d,o,a,p;if(Array.isArray(h)){var b=h.flat(),g=(0,s.default)(b,4);d=g[0],o=g[1],a=g[2],p=g[3]}else{var S=h.split(","),q=(0,s.default)(S,4);d=q[0],o=q[1],a=q[2],p=q[3]}return"".concat(this.configuration.geoLocationField,":(").concat(d,", ").concat(o,", ").concat(d,", ").concat(p,", ").concat(a,", ").concat(p,", ").concat(a,", ").concat(o,")")}if(t||i){if(!i||i==="all")throw new Error("[Typesense-Instantsearch-Adapter] In Typesense, geo-filtering around a lat/lng also requires a numerical radius. So the `aroundRadius` parameter is required when `aroundLatLng` is used. If you intend to just geo-sort around a lat/long, you want to use the sortBy InstantSearch widget (or a virtual sortBy custom widget).");var O="".concat(parseFloat(i)/1e3," km");return"".concat(this.configuration.geoLocationField,":(").concat(t,", ").concat(O,")")}if(r){var j=r;return Array.isArray(r)&&(j=r.flat().join(",")),"".concat(this.configuration.geoLocationField,":(").concat(j,")")}}},{key:"_adaptFilters",value:function(m,h){var i=[];return m.filters&&i.push(m.filters),i.push(this._adaptFacetFilters(m.facetFilters,h)),i.push(this._adaptNumericFilters(m.numericFilters)),i.push(this._adaptGeoFilter(m)),i.filter(function(t){return t&&t!==""}).join(" && ")}},{key:"_adaptIndexName",value:function(m){return m.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[1]}},{key:"_adaptSortBy",value:function(m){return m.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[3]}},{key:"_adaptFacetBy",value:function(m,h){var i=this;return[m].flat().map(function(t){var r;return(r=i.configuration.collectionSpecificFacetByOptions)!==null&&r!==void 0&&(r=r[h])!==null&&r!==void 0&&r[t]?"".concat(t).concat(i.configuration.collectionSpecificFacetByOptions[h][t]):i.configuration.facetByOptions[t]?"".concat(t).concat(i.configuration.facetByOptions[t]):t}).join(",")}},{key:"_adaptRulesContextsToOverrideTags",value:function(m){return m.join(",")}},{key:"_buildSearchParameters",value:function(m){for(var h,i,t=m.params,r=m.indexName,d=this._adaptIndexName(r),o={},a=0,p=Object.entries(this.additionalSearchParameters);a<p.length;a++){var b=(0,s.default)(p[a],2),g=b[0],S=b[1];o[this._camelToSnakeCase(g)]=S}if(this.collectionSpecificSearchParameters[d])for(var q=0,O=Object.entries(this.collectionSpecificSearchParameters[d]);q<O.length;q++){var j=(0,s.default)(O[q],2),P=j[0],F=j[1];o[this._camelToSnakeCase(P)]=F}var C=Object.assign({},o),A=this._adaptSortBy(r);Object.assign(C,{collection:d,q:t.query===""||t.query===void 0?"*":t.query,facet_by:o.facet_by||this._adaptFacetBy(t.facets,d),filter_by:this._adaptFilters(t,d)||o.filter_by,sort_by:A||o.sort_by,max_facet_values:t.maxValuesPerFacet,page:(t.page||0)+1}),t.hitsPerPage!=null&&(C.per_page=t.hitsPerPage),t.facetQuery&&(C.facet_query="".concat(t.facetName,":").concat(t.facetQuery),C.per_page=0),t.ruleContexts&&t.ruleContexts.length>0&&(C.override_tags=this._adaptRulesContextsToOverrideTags(t.ruleContexts)),t.typesenseVectorQuery&&(C.vector_query=t.typesenseVectorQuery);var N=((h=this.configuration.collectionSpecificSortByOptions)===null||h===void 0||(h=h[d])===null||h===void 0?void 0:h[C.sort_by])||((i=this.configuration.sortByOptions)===null||i===void 0?void 0:i[C.sort_by]);return N?.enable_overrides!=null&&(C.enable_overrides=N.enable_overrides),Object.fromEntries(Object.entries(C).filter(function(_){var R=(0,s.default)(_,2);R[0];var I=R[1];return I!=null&&I!==""}))}},{key:"_camelToSnakeCase",value:function(m){return m.split(/(?=[A-Z])/).join("_").toLowerCase()}},{key:"request",value:(function(){var y=(0,n.default)(c.default.mark(function h(){var i=this,t,r,d,o,a,p,b,g,S;return c.default.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return d=this.instantsearchRequests.map(function(j){return i._buildSearchParameters(j)}),o={},(((t=d[0])===null||t===void 0?void 0:t.conversation)===!0||((r=d[0])===null||r===void 0?void 0:r.conversation)==="true")&&(a=d[0],p=a.q,b=a.conversation,g=a.conversation_id,S=a.conversation_model_id,o={q:p,conversation:b,conversation_id:g,conversation_model_id:S},d=d.map(function(j){j.q,j.conversation,j.conversation_id,j.conversation_model_id;var P=(0,v.default)(j,l);return P})),O.abrupt("return",this.typesenseClient.multiSearch.perform({searches:d},o));case 4:case"end":return O.stop()}},h,this)}));function m(){return y.apply(this,arguments)}return m})()}],[{key:"INDEX_NAME_MATCHING_REGEX",get:function(){return new RegExp("^(.+?)(?=(/sort/(.*))|$)")}},{key:"DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*)((?!:).):(?!:)(.*)")}},{key:"DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*?)(<=|>=|>|<|=)(.*)")}}])})(),ae}var ne={},Ge={exports:{}},We={exports:{}},Nt;function qa(){return Nt||(Nt=1,(function(e){var c=ur();function v(n){if(Array.isArray(n))return c(n)}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(We)),We.exports}var Qe={exports:{}},Ht;function Ta(){return Ht||(Ht=1,(function(e){function c(v){if(typeof Symbol<"u"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Qe)),Qe.exports}var Ve={exports:{}},Lt;function Aa(){return Lt||(Lt=1,(function(e){function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(Ve)),Ve.exports}var Bt;function Oa(){return Bt||(Bt=1,(function(e){var c=qa(),v=Ta(),n=cr(),s=Aa();function f(u){return c(u)||v(u)||n(u)||s()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports})(Ge)),Ge.exports}var Ue={exports:{}},Dt;function wa(){return Dt||(Dt=1,(function(e){var c=lr();function v(n,s,f){return(s=c(s))in n?Object.defineProperty(n,s,{value:f,enumerable:!0,configurable:!0,writable:!0}):n[s]=f,n}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(Ue)),Ue.exports}var ie={},Gt;function fr(){return Gt||(Gt=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.utils=void 0,ie.utils={_adaptHighlightTag:function(c,v,n){return c.replace(new RegExp("<mark>","g"),v||"<mark>").replace(new RegExp("</mark>","g"),n||"</mark>")},_adaptNumberOfPages:function(){var c=this.typesenseResponse.found/this.typesenseResponse.request_params.per_page;return Number.isFinite(c)?Math.ceil(c):1}}),ie}var Wt;function Pa(){if(Wt)return ne;Wt=1;var e=le();Object.defineProperty(ne,"__esModule",{value:!0}),ne.SearchResponseAdapter=void 0;var c=e(ve()),v=e(dr()),n=e(Oa()),s=e(wa()),f=e(ue()),u=e(ce()),l=fr();function x(h,i){var t=Object.keys(h);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(h);i&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(h,d).enumerable})),t.push.apply(t,r)}return t}function y(h){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?x(Object(t),!0).forEach(function(r){(0,s.default)(h,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach(function(r){Object.defineProperty(h,r,Object.getOwnPropertyDescriptor(t,r))})}return h}var m=ne.SearchResponseAdapter=(function(){function h(i,t,r){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};(0,f.default)(this,h),this.typesenseResponse=i,this.instantsearchRequest=t,this.configuration=r,this.allTypesenseResults=d,this.fullTypesenseResponse=o}return(0,u.default)(h,[{key:"_adaptGroupedHits",value:function(t){var r=this,d=[];return d=t.map(function(o){var a=r._adaptHits(o.hits);return a.forEach(function(p){p.group_key=p._group_key=o.group_key,o.found&&(p._group_found=o.found)}),a}),this.configuration.flattenGroupedHits?d=d.flat():d=d.map(function(o){return y(y({},o[0]),{},{_grouped_hits:o})}),d}},{key:"_adaptHits",value:function(t){var r=this,d=[];return d=t.map(function(o){var a=y({},o.document);a.objectID=o.document.id,a._snippetResult=r._adaptHighlightResult(o,"snippet"),a._highlightResult=r._adaptHighlightResult(o,"value"),a._rawTypesenseHit=o,r.fullTypesenseResponse.conversation&&(a._rawTypesenseConversation=r.fullTypesenseResponse.conversation),["text_match","geo_distance_meters","curated","text_match_info","hybrid_search_info","vector_distance"].forEach(function(b){Object.keys(o).includes(b)&&!Object.keys(a).includes(b)&&(a[b]=o[b])});var p=a[r.configuration.geoLocationField];return p&&(a._geoloc={lat:p[0],lng:p[1]}),a}),d}},{key:"_adaptHighlightResult",value:function(t,r){var d={};return t.highlight!=null&&this.isHighlightPost0240RCN32Format(t.highlight)?this.adaptHighlightObject(t,d,r):this.adaptHighlightsArray(t,d,r),d}},{key:"isHighlightPost0240RCN32Format",value:function(t){return t.full==null&&t.snippet==null}},{key:"adaptHighlightsArray",value:function(t,r,d){var o=this;Object.assign.apply(Object,[r].concat((0,n.default)(Object.entries(t.document).map(function(a){var p=(0,v.default)(a,2),b=p[0],g=p[1];return(0,s.default)({},b,{value:g,matchLevel:"none",matchedWords:[]})})))),t.highlights.forEach(function(a){r[a.field]={value:a[d]||a["".concat(d,"s")],matchLevel:"full",matchedWords:a.matched_tokens},a.indices&&(r[a.field].matchedIndices=a.indices)}),Object.entries(r).forEach(function(a){var p=(0,v.default)(a,2),b=p[0],g=p[1],S=b,q=g.value,O=g.matchLevel,j=g.matchedWords,P=g.matchedIndices;q==null?r[S]=o._adaptHighlightNullValue():Array.isArray(q)?(r[S]=[],t.document[S].forEach(function(F,C){P&&P.includes(C)?r[S].push({value:o._adaptHighlightTag("".concat(q[P.indexOf(C)]),o.instantsearchRequest.params.highlightPreTag,o.instantsearchRequest.params.highlightPostTag),matchLevel:O,matchedWords:j[C]}):(0,c.default)(F)==="object"?r[S].push(o._adaptHighlightInObjectValue(F,{},d)):r[S].push({value:"".concat(F),matchLevel:"none",matchedWords:[]})})):(0,c.default)(q)==="object"?r[S]=o._adaptHighlightInObjectValue(q,{},d):r[S].value=o._adaptHighlightTag("".concat(q),o.instantsearchRequest.params.highlightPreTag,o.instantsearchRequest.params.highlightPostTag)})}},{key:"adaptHighlightObject",value:function(t,r,d){Object.assign(r,this._adaptHighlightInObjectValue(t.document,t.highlight,d))}},{key:"_adaptHighlightInObjectValue",value:function(t,r,d){var o=this;return Object.assign.apply(Object,[{}].concat((0,n.default)(Object.entries(t).map(function(a){var p=(0,v.default)(a,2),b=p[0],g=p[1],S;if(g==null)S=o._adaptHighlightNullValue();else if(Array.isArray(g)){var q;S=o._adaptHighlightInArrayValue(g,(q=r?.[b])!==null&&q!==void 0?q:[],d)}else if((0,c.default)(g)==="object"){var O;S=o._adaptHighlightInObjectValue(g,(O=r?.[b])!==null&&O!==void 0?O:{},d)}else S=o._adaptHighlightInPrimitiveValue(g,r?.[b],d);return(0,s.default)({},b,S)}))))}},{key:"_adaptHighlightInArrayValue",value:function(t,r,d){var o=this;return t.map(function(a,p){var b;if(a==null)b=o._adaptHighlightNullValue();else if(Array.isArray(a)){var g;b=o._adaptHighlightInArrayValue(a,(g=r?.[p])!==null&&g!==void 0?g:[],d)}else if((0,c.default)(a)==="object"){var S;b=o._adaptHighlightInObjectValue(a,(S=r?.[p])!==null&&S!==void 0?S:{},d)}else b=o._adaptHighlightInPrimitiveValue(a,r?.[p],d);return b})}},{key:"_adaptHighlightInPrimitiveValue",value:function(t,r,d){if(r!=null){var o,a;return{value:this._adaptHighlightTag("".concat((o=(a=r[d])!==null&&a!==void 0?a:r.highlight)!==null&&o!==void 0?o:r.snippet),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:(r.matched_tokens||[]).length>0?"full":"none",matchedWords:r.matched_tokens||[]}}else return{value:this._adaptHighlightTag("".concat(t),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:"none",matchedWords:[]}}},{key:"_adaptHighlightNullValue",value:function(){return{value:"",matchLevel:"none",matchedWords:[]}}},{key:"_adaptFacets",value:function(t){var r={};return t.forEach(function(d){Object.assign(r,(0,s.default)({},d.field_name,Object.assign.apply(Object,[{}].concat((0,n.default)(d.counts.map(function(o){return(0,s.default)({},o.value,o.count)}))))))}),r}},{key:"_adaptFacetStats",value:function(t){var r={};return t.forEach(function(d){Object.keys(d.stats).length>0&&Object.assign(r,(0,s.default)({},d.field_name,d.stats))}),r}},{key:"_adaptRenderingContent",value:function(t){var r,d=Object.assign({},this.configuration.renderingContent);return((r=d.facetOrdering)===null||r===void 0||(r=r.facets)===null||r===void 0?void 0:r.order)==null&&(d.facetOrdering=d.facetOrdering||{},d.facetOrdering.facets=d.facetOrdering.facets||{},d.facetOrdering.facets.order=(0,n.default)(new Set(t.map(function(o){return o.field_name}).concat(this.allTypesenseResults.map(function(o){return o.facet_counts||[]}).flat().map(function(o){return o.field_name}).filter(function(o){return o}))))),d}},{key:"_adaptUserData",value:function(t){return t?Array.isArray(t)?t:[t]:[]}},{key:"adapt",value:function(){var t=this._adaptRenderingContent(this.typesenseResponse.facet_counts||[]),r=y({hits:this.typesenseResponse.grouped_hits?this._adaptGroupedHits(this.typesenseResponse.grouped_hits):this._adaptHits(this.typesenseResponse.hits),nbHits:this.typesenseResponse.found,page:this.typesenseResponse.page-1,nbPages:this._adaptNumberOfPages(),hitsPerPage:this.typesenseResponse.request_params.per_page,facets:this._adaptFacets(this.typesenseResponse.facet_counts||[]),facets_stats:this._adaptFacetStats(this.typesenseResponse.facet_counts||{}),query:this.typesenseResponse.request_params.q,processingTimeMS:this.typesenseResponse.search_time_ms},Object.keys(t).length>0?{renderingContent:t}:null);return this.typesenseResponse.metadata&&(r.appliedRules=["typesense-override"],r.userData=this._adaptUserData(this.typesenseResponse.metadata)),this.fullTypesenseResponse.conversation&&r.hits.length===0&&(r.hits=[{_rawTypesenseConversation:this.fullTypesenseResponse.conversation}]),r}}])})();return Object.assign(m.prototype,l.utils),ne}var oe={},Qt;function Ca(){if(Qt)return oe;Qt=1;var e=le();Object.defineProperty(oe,"__esModule",{value:!0}),oe.FacetSearchResponseAdapter=void 0;var c=e(ue()),v=e(ce()),n=fr(),s=oe.FacetSearchResponseAdapter=(function(){function f(u,l){(0,c.default)(this,f),this.typesenseResponse=u,this.instantsearchRequest=l}return(0,v.default)(f,[{key:"_adaptFacetHits",value:function(l){var x=this,y={},m=l.find(function(h){return h.field_name===x.instantsearchRequest.params.facetName});return y=m.counts.map(function(h){return{value:h.value,highlighted:x._adaptHighlightTag(h.highlighted,x.instantsearchRequest.params.highlightPreTag,x.instantsearchRequest.params.highlightPostTag),count:h.count}}),y}},{key:"adapt",value:function(){var l={facetHits:this._adaptFacetHits(this.typesenseResponse.facet_counts),exhaustiveFacetsCount:!0,processingTimeMS:this.typesenseResponse.search_time_ms};return l}}])})();return Object.assign(s.prototype,n.utils),oe}var Vt;function Ia(){return Vt||(Vt=1,(function(e){var c=le();Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var v=c(or()),n=c(sr()),s=c(ue()),f=c(ce()),u=ma(),l=Pr(),x=Ra(),y=Pa(),m=Ca();e.default=(function(){function h(i){var t=this;(0,s.default)(this,h),this.updateConfiguration(i),this.searchClient={clearCache:function(){return t.clearCache()},search:function(d){return t.searchTypesenseAndAdapt(d)},searchForFacetValues:function(d){return t.searchTypesenseForFacetValuesAndAdapt(d)}}}return(0,f.default)(h,[{key:"searchTypesenseAndAdapt",value:(function(){var i=(0,n.default)(v.default.mark(function r(d){var o=this,a,p;return v.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return a=g.sent,p=a.results.map(function(S,q){o._validateTypesenseResult(S);var O=new y.SearchResponseAdapter(S,d[q],o.configuration,a.results,a),j=O.adapt();return j}),g.abrupt("return",{results:p});case 8:throw g.prev=8,g.t0=g.catch(0),console.error(g.t0),g.t0;case 12:case"end":return g.stop()}},r,this,[[0,8]])}));function t(r){return i.apply(this,arguments)}return t})()},{key:"searchTypesenseForFacetValuesAndAdapt",value:(function(){var i=(0,n.default)(v.default.mark(function r(d){var o=this,a,p;return v.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return a=g.sent,p=a.results.map(function(S,q){o._validateTypesenseResult(S);var O=new m.FacetSearchResponseAdapter(S,d[q],o.configuration);return O.adapt()}),g.abrupt("return",p);case 8:throw g.prev=8,g.t0=g.catch(0),console.error(g.t0),g.t0;case 12:case"end":return g.stop()}},r,this,[[0,8]])}));function t(r){return i.apply(this,arguments)}return t})()},{key:"_adaptAndPerformTypesenseRequest",value:(function(){var i=(0,n.default)(v.default.mark(function r(d){var o,a;return v.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return o=new x.SearchRequestAdapter(d,this.typesenseClient,this.configuration),b.next=3,o.request();case 3:return a=b.sent,b.abrupt("return",a);case 5:case"end":return b.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t})()},{key:"clearCache",value:function(){return this.typesenseClient=new l.SearchClient(this.configuration.server),this.searchClient}},{key:"updateConfiguration",value:function(t){return this.configuration=new u.Configuration(t),this.configuration.validate(),this.typesenseClient=new l.SearchClient(this.configuration.server),!0}},{key:"_validateTypesenseResult",value:function(t){if(t.error)throw new Error("".concat(t.code," - ").concat(t.error));if(!t.hits&&!t.grouped_hits)throw new Error("Did not find any hits. ".concat(t.code," - ").concat(t.error))}}])})()})(_e)),_e}var ka=Ia();const Fa=Cr(ka),ja={class:"row q-mt-md"},za={class:"col-3 q-pr-sm"},$a={class:"text-subtitle2 q-pt-md"},Ea={class:"text-subtitle2 q-pt-md"},Ma={class:"text-subtitle2 q-pt-md"},Na={class:"col-9"},Ha={key:1},La=Z({__name:"SearchInstantSearch",setup(e){const c=Xe(),v=M(null),n=M(),s=M(),f=M(null),u=M(null),l=M(4),x=[({instantSearchInstance:a})=>({subscribe(){s.value=a},unsubscribe(){s.value=null}})],y=k(()=>c.currentCollection),m=k(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(a=>a.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(a.type)&&!a.name.includes(".*")).map(a=>a.name)),h=k(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(a=>a.facet&&["string","string[]"].includes(a.type)&&!a.name.includes(".*")).map(a=>a.name)),i=k(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(a=>a.facet&&["bool","bool[]"].includes(a.type)&&!a.name.includes(".*")).map(a=>a.name)),t=k(()=>{if(!y.value||!y.value.fields)return[];const a=[{value:y.value.name,label:"Default"}];return y.value.fields.filter(p=>["int32","float"].includes(p.type)||p.type==="string"&&p.sort).forEach(p=>{y.value&&(a.push({value:`${y.value.name}/sort/${p.name}:asc`,label:`${p.name} asc`}),a.push({value:`${y.value.name}/sort/${p.name}:desc`,label:`${p.name} desc`}))}),a}),r=k(()=>c.data.stopwords.map(a=>a.id)),d=()=>{s.value&&y.value&&c.exportToJson(s.value.renderState[y.value.name].hits.results.hits)},o=()=>{n.value&&y.value&&n.value.updateConfiguration({...n.value.configuration,additionalSearchParameters:{...n.value.configuration.additionalSearchParameters,stopwords:u.value,max_candidates:l.value}})};return pe(()=>y.value,()=>{v.value=null,f.value=null,window.setTimeout(()=>{if(!c.loginData||!y.value)return;const a=(y.value?.fields||[]).filter(p=>p.index&&["string","string[]"].includes(p.type)&&!p.name.includes(".*")).map(p=>p.name).join(",");try{const p=new Fa({server:{nodes:[{...c.loginData.node}],apiKey:c.loginData.apiKey},additionalSearchParameters:{max_candidates:l.value,query_by:a}});n.value=p,v.value=p.searchClient}catch(p){f.value=p.message+"Using query_by: "+a,console.error(p)}})},{immediate:!0}),(a,p)=>{const b=W("ais-configure"),g=W("ais-search-box"),S=W("ais-stats"),q=W("ais-current-refinements"),O=W("ais-hits-per-page"),j=W("ais-sort-by"),P=W("ais-range-input"),F=W("ais-refinement-list"),C=W("ais-pagination"),A=W("ais-hits"),N=W("ais-instant-search");return v.value&&y.value?(z(),V(N,{key:0,"search-client":v.value,"index-name":y.value.name,middlewares:x},{default:E(()=>[T(b,{hitsPerPage:12}),T(g,{"index-name":"instant_search","search-client":v.value},{default:E(()=>[T(da)]),_:1},8,["search-client"]),T(S),T(q),G("div",ja,[G("div",za,[T(O,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"250 hits per page",value:250}]}),T(X,{flat:"",onClick:p[0]||(p[0]=_=>d())},{default:E(()=>[...p[6]||(p[6]=[K("export current page",-1)])]),_:1}),p[7]||(p[7]=G("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1)),T(j,{items:t.value},null,8,["items"]),p[8]||(p[8]=G("div",{class:"text-subtitle2 q-pt-md"},"Stopwords",-1)),T(jr,{modelValue:u.value,"onUpdate:modelValue":[p[1]||(p[1]=_=>u.value=_),p[2]||(p[2]=_=>o())],disable:!Ir(c).data.features.stopwords,outlined:"",clearable:"",dense:"","options-dense":"",options:r.value},null,8,["modelValue","disable","options"]),p[9]||(p[9]=G("div",{class:"text-subtitle2 q-pt-md"},"Max Candidates",-1)),T(Xt,{modelValue:l.value,"onUpdate:modelValue":[p[3]||(p[3]=_=>l.value=_),p[4]||(p[4]=_=>o())],modelModifiers:{number:!0},type:"number",outlined:"",dense:"",min:0,max:1e4,hint:"Number of similar words for prefix and typo searching"},null,8,["modelValue"]),(z(!0),H(U,null,Y(m.value,_=>(z(),H("div",{key:_,class:"q-mb-sm"},[G("div",$a,J(_),1),T(P,{searchable:!0,attribute:_},null,8,["attribute"])]))),128)),(z(!0),H(U,null,Y(h.value,_=>(z(),H("div",{key:_,class:"q-mb-sm"},[G("div",Ea,J(_),1),T(F,{class:"q-mb-sm",searchable:!0,attribute:_},null,8,["attribute"])]))),128)),(z(!0),H(U,null,Y(i.value,_=>(z(),H("div",{key:_,class:"q-mb-sm"},[G("div",Ma,J(_),1),T(F,{class:"q-mb-sm",attribute:_},null,8,["attribute"])]))),128))]),G("div",Na,[T(C,{class:"q-mb-md"}),T(A,null,kr({_:2},[y.value?{name:"item",fn:E(({item:_})=>[T(er,{item:_,onDeleted:p[5]||(p[5]=R=>s.value.refresh())},null,8,["item"])]),key:"0"}:void 0]),1024),T(C,{class:"q-my-md"})])])]),_:1},8,["search-client","index-name"])):f.value?(z(),H("div",Ha,[T(Zt,{"inline-actions":"",class:"text-white bg-red"},{default:E(()=>[K(J(f.value),1)]),_:1})])):Q("",!0)}}}),an=Z({__name:"Search",setup(e){const c=M("form");return(v,n)=>(z(),V(Fr,{padding:""},{default:E(()=>[T(pr,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=s=>c.value=s),dense:"",class:"bg-primary text-white",align:"justify","narrow-indicator":""},{default:E(()=>[T(Ze,{name:"form",label:"InstantSearch Mode"}),T(Ze,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),T(Jt),T(vr,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=s=>c.value=s),animated:"","keep-alive":""},{default:E(()=>[T(et,{name:"form"},{default:E(()=>[T(La)]),_:1}),T(et,{name:"json",class:"q-pa-none"},{default:E(()=>[T(la)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{an as default};
