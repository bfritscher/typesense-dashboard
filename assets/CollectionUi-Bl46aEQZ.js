import{Q as C,a as b,b as F,c as y}from"./QTabPanels-BvpfzdAv.js";import{K as Q,aL as N,u as D,_ as j,Z as _,U as i,M as n,O as s,N as o,Q as p,aM as q,a4 as g,R as c,L as M,a7 as m,a5 as O,a6 as w,a3 as h,V as r,a9 as U,aa as d,S as f,X as u,$ as S}from"./index-CWCfc1R0.js";import{a as V}from"./QSelect-B2bCo1Ml.js";import{Q as $}from"./QBanner-C-wBSwOC.js";import{M as J}from"./MonacoEditor-Ddc3-1-c.js";const B=Q({name:"CollectionUi",components:{MonacoEditor:J},props:{initialSchema:{type:Object,default:()=>({name:"",fields:[{name:"",type:"string",facet:!1,optional:!1,index:!0,sort:!1,infix:!1,stem:!1,locale:"",num_dim:void 0,stem_dictionary:""}],default_sorting_field:"",token_separators:[],symbols_to_index:[],enable_nested_fields:!1})},primaryActionLabel:{type:String,required:!0},createMode:{type:Boolean,default:!1}},emits:["submit"],data(){return{tab:"form",schema:{name:"",fields:[],default_sorting_field:"",token_separators:[],symbols_to_index:[],enable_nested_fields:!1},types:["string","string[]","int32","int32[]","int64","int64[]","float","float[]","bool","bool[]","geopoint","geopoint[]","geopolygon","object","object[]","string*","image","auto"],jsonError:null}},computed:{...N(D,{stemmingDictionaries:e=>e.data.stemmingDictionaries}),availableSortFields(){const e=(this.schema.fields||[]).filter(a=>["int32","int64","float"].includes(a.type)||a.type==="string"&&a.sort);return[""].concat(e.map(a=>a.name))},stemmingDictionaryOptions(){return["default"].concat(this.stemmingDictionaries||[])},schemaJson:{get(){return JSON.stringify(this.schema,null,2)},set(e){try{this.schema=JSON.parse(e),this.jsonError=null}catch(a){this.jsonError=a.message}}}},watch:{initialSchema:{immediate:!0,handler(e){this.schema=JSON.parse(JSON.stringify(e))}}},methods:{addField(){this.schema.fields&&this.schema.fields.push({name:"",type:"string",facet:!1,optional:!1,index:!0,sort:!1,infix:!1,stem:!1,locale:"",num_dim:void 0,stem_dictionary:""})},removeField(e){if(this.schema.fields){const a=this.schema.fields.indexOf(e);a>-1&&this.schema.fields.splice(a,1)}},getStemDictionaryValue(e){return e.stem_dictionary||"default"},setStemDictionaryValue(e,a){a==="default"?e.stem_dictionary="":e.stem_dictionary=a}}}),E={class:"row q-gutter-md"};function L(e,a,T,z,A,I){const v=_("monaco-editor");return n(),i(h,null,{default:s(()=>[o(C,{modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=l=>e.tab=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[o(b,{name:"form",label:"Form Mode"}),o(b,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),o(p),o(F,{modelValue:e.tab,"onUpdate:modelValue":a[4]||(a[4]=l=>e.tab=l),animated:"",style:q(e.createMode?"height: 60vh":""),class:"bg-surface"},{default:s(()=>[o(y,{name:"form"},{default:s(()=>[o(g,null,{default:s(()=>[c("div",E,[o(m,{modelValue:e.schema.name,"onUpdate:modelValue":a[1]||(a[1]=l=>e.schema.name=l),class:"col",filled:"",dense:"",label:"Collection Name",placeholder:"books",disable:!e.createMode,rules:[l=>!!l||"Field is required"]},null,8,["modelValue","disable","rules"]),o(V,{modelValue:e.schema.default_sorting_field,"onUpdate:modelValue":a[2]||(a[2]=l=>e.schema.default_sorting_field=l),filled:"",class:"col",dense:"",options:e.availableSortFields,label:"Default sort field optional, but must be int32 or float"},null,8,["modelValue","options"])]),a[8]||(a[8]=c("div",{class:"text-subtitle1 q-pt-md"},"Fields",-1)),(n(!0),M(O,null,w(e.schema.fields,(l,k)=>(n(),i(h,{key:k,flat:"",bordered:"",class:"q-mb-md"},{default:s(()=>[o(g,{class:"row q-col-gutter-md"},{default:s(()=>[o(m,{modelValue:l.name,"onUpdate:modelValue":t=>l.name=t,class:"col-12 col-sm-6",dense:"",outlined:"",label:"Field Name",placeholder:"title",rules:[t=>!!t||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),o(V,{modelValue:l.type,"onUpdate:modelValue":t=>l.type=t,class:"col-12 col-sm-4",dense:"",outlined:"",label:"type",options:e.types,rules:[t=>!!t||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","options","rules"]),l.type==="float[]"?(n(),i(m,{key:0,modelValue:l.num_dim,"onUpdate:modelValue":t=>l.num_dim=t,modelModifiers:{number:!0},class:"col-12 col-sm-2",dense:"",outlined:"",type:"number",label:"num_dim",placeholder:""},null,8,["modelValue","onUpdate:modelValue"])):r("",!0),l.type.startsWith("string")?(n(),i(m,{key:1,modelValue:l.locale,"onUpdate:modelValue":t=>l.locale=t,class:"col-12 col-sm-2",dense:"",outlined:"",label:"locale",placeholder:""},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)]),_:2},1024),o(p),o(U,{align:"between"},{default:s(()=>[c("div",null,[o(d,{modelValue:l.optional,"onUpdate:modelValue":t=>l.optional=t,label:"optional"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:l.facet,"onUpdate:modelValue":t=>l.facet=t,label:"facet"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:l.index,"onUpdate:modelValue":t=>l.index=t,label:"index"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:l.sort,"onUpdate:modelValue":t=>l.sort=t,label:"sort"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:l.infix,"onUpdate:modelValue":t=>l.infix=t,label:"infix"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:l.stem,"onUpdate:modelValue":t=>l.stem=t,label:"stem"},null,8,["modelValue","onUpdate:modelValue"]),l.stem?(n(),i(V,{key:0,"model-value":e.getStemDictionaryValue(l),options:e.stemmingDictionaryOptions,dense:"",outlined:"",label:"Stemming Dictionary",class:"q-mt-sm",style:{"min-width":"200px"},"onUpdate:modelValue":t=>e.setStemDictionaryValue(l,t)},null,8,["model-value","options","onUpdate:modelValue"])):r("",!0)]),o(f,{size:"md",padding:"sm lg",unelevated:"",onClick:t=>e.removeField(l)},{default:s(()=>[...a[7]||(a[7]=[u("Remove Field",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),o(y,{name:"json",class:"q-pa-none"},{default:s(()=>[o(v,{modelValue:e.schemaJson,"onUpdate:modelValue":a[3]||(a[3]=l=>e.schemaJson=l),style:{height:"60vh"}},null,8,["modelValue"]),e.jsonError?(n(),i($,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:s(()=>[u(" Invalid Format: "+S(e.jsonError),1)]),_:1})):r("",!0)]),_:1})]),_:1},8,["modelValue","style"]),o(p),o(U,{align:"between",class:"bg-primary"},{default:s(()=>[o(f,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:a[5]||(a[5]=l=>e.addField())},{default:s(()=>[...a[9]||(a[9]=[u("Add field",-1)])]),_:1}),o(f,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:a[6]||(a[6]=l=>e.$emit("submit",e.schema))},{default:s(()=>[u(S(e.primaryActionLabel),1)]),_:1})]),_:1})]),_:1})}const Z=j(B,[["render",L]]);export{Z as C};
