import{a as R,Q as k}from"./QItem-CTM6MChZ.js";import{e as ke,bb as U,n as we,aH as Se,q as Ce,i as xe,r as N,f as C,aQ as Pe,t as _e,bc as He,v as Qe,bd as Le,w as Y,o as Z,aw as ee,aA as te,aI as Ee,h as oe,ai as Oe,g as Ne,aF as Ve,av as De,aO as Ke,be as $e,bf as qe,K as Ae,u as Be,H as Ie,U as h,M as g,O as r,B as V,V as w,N as i,L as W,T as Q,X as S,W as ae,Q as ne,a6 as Me,a5 as je,a3 as Re,a4 as le,R as L,a9 as Ue,S as E,a8 as We,$ as O,ap as Fe}from"./index-BTiO3EOl.js";import{v as ze,f as se,g as Ge,p as ie,h as Xe,i as Je,j as Ye,k as re,s as Ze,c as ue,Q as de,a as et}from"./QSelect-JfnYGCod.js";import{Q as tt}from"./QChip-CO2E2fvA.js";import{Q as ot}from"./QList-DRl8fJm7.js";const at=ke({name:"QTooltip",inheritAttrs:!1,props:{...Ge,...Ce,...U,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...U.transitionShow,default:"jump-down"},transitionHide:{...U.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:se},self:{type:String,default:"top middle",validator:se},offset:{type:Array,default:()=>[14,14],validator:ze},scrollTarget:Se,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...we],setup(t,{slots:u,emit:n,attrs:f}){let v,l;const p=xe(),{proxy:{$q:c}}=p,m=N(null),b=N(!1),K=C(()=>ie(t.anchor,c.lang.rtl)),x=C(()=>ie(t.self,c.lang.rtl)),P=C(()=>t.persistent!==!0),{registerTick:$,removeTick:q}=Pe(),{registerTimeout:T}=_e(),{transitionProps:A,transitionStyle:B}=He(t),{localScrollTarget:o,changeScrollEvent:e,unconfigureScrollTarget:a}=Xe(t,X),{anchorEl:s,canShow:I,anchorEvents:_}=Je({showing:b,configureAnchorEl:he}),{show:fe,hide:M}=Qe({showing:b,canShow:I,handleShow:ge,handleHide:pe,hideOnRouteChange:P,processOnMount:!0});Object.assign(_,{delayShow:me,delayHide:ye});const{showPortal:F,hidePortal:z,renderPortal:ve}=Le(p,m,Te,"tooltip");if(c.platform.is.mobile===!0){const d={anchorEl:s,innerRef:m,onClickOutside(y){return M(y),y.target.classList.contains("q-dialog__backdrop")&&Ve(y),!0}},j=C(()=>t.modelValue===null&&t.persistent!==!0&&b.value===!0);Y(j,y=>{(y===!0?Ye:re)(d)}),Z(()=>{re(d)})}function ge(d){F(),$(()=>{l=new MutationObserver(()=>H()),l.observe(m.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),H(),X()}),v===void 0&&(v=Y(()=>c.screen.width+"|"+c.screen.height+"|"+t.self+"|"+t.anchor+"|"+c.lang.rtl,H)),T(()=>{F(!0),n("show",d)},t.transitionDuration)}function pe(d){q(),z(),G(),T(()=>{z(!0),n("hide",d)},t.transitionDuration)}function G(){l!==void 0&&(l.disconnect(),l=void 0),v!==void 0&&(v(),v=void 0),a(),ee(_,"tooltipTemp")}function H(){Ze({targetEl:m.value,offset:t.offset,anchorEl:s.value,anchorOrigin:K.value,selfOrigin:x.value,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function me(d){if(c.platform.is.mobile===!0){ue(),document.body.classList.add("non-selectable");const j=s.value,y=["touchmove","touchcancel","touchend","click"].map(J=>[j,J,"delayHide","passiveCapture"]);te(_,"tooltipTemp",y)}T(()=>{fe(d)},t.delay)}function ye(d){c.platform.is.mobile===!0&&(ee(_,"tooltipTemp"),ue(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),T(()=>{M(d)},t.hideDelay)}function he(){if(t.noParentEvent===!0||s.value===null)return;const d=c.platform.is.mobile===!0?[[s.value,"touchstart","delayShow","passive"]]:[[s.value,"mouseenter","delayShow","passive"],[s.value,"mouseleave","delayHide","passive"]];te(_,"anchor",d)}function X(){if(s.value!==null||t.scrollTarget!==void 0){o.value=Ee(s.value,t.scrollTarget);const d=t.noParentEvent===!0?H:M;e(o.value,d)}}function be(){return b.value===!0?oe("div",{...f,ref:m,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",f.class],style:[f.style,B.value],role:"tooltip"},Ne(u.default)):null}function Te(){return oe(Oe,A.value,be)}return Z(G),Object.assign(p.proxy,{updatePosition:H}),ve}});function ce(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const u=parseInt(t,10);return isNaN(u)?0:u}const D=De({name:"close-popup",beforeMount(t,{value:u}){const n={depth:ce(u),handler(f){n.depth!==0&&setTimeout(()=>{const v=$e(t);v!==void 0&&qe(v,f,n.depth)})},handlerKey(f){Ke(f,13)===!0&&n.handler(f)}};t.__qclosepopup=n,t.addEventListener("click",n.handler),t.addEventListener("keyup",n.handlerKey)},updated(t,{value:u,oldValue:n}){u!==n&&(t.__qclosepopup.depth=ce(u))},beforeUnmount(t){const u=t.__qclosepopup;t.removeEventListener("click",u.handler),t.removeEventListener("keyup",u.handlerKey),delete t.__qclosepopup}}),nt={class:"row items-center no-wrap"},lt={class:"col"},st={key:0,class:"text-caption text-grey-7"},it={key:0,class:"col-auto"},vt=Ae({__name:"ServerHistory",props:{showLogout:{type:Boolean,default:!1}},setup(t){const u=t,n=Be();function f(o){const e=u.showLogout;n.login({...o,forceHomeRedirect:e})}function v(o){n.removeHistoryAt(o),l.visible=!1}const l=Ie({index:null,visible:!1,value:""}),p=N(""),c=N("");function m(o){l.index=o;const e=n.loginHistoryParsed[o];l.value=e?.clusterTag||"",p.value=l.value,c.value=l.value,l.visible=!0}function b(){if(l.index===null)return;const o=p.value.trim(),e=(l.value||"").trim(),a=c.value.trim(),s=o&&o!==a?o:e;s.length>0&&n.setHistoryTag(l.index,s),l.visible=!1}function K(){l.index!==null&&(n.removeHistoryTag(l.index),l.visible=!1)}const x=C(()=>{const o=new Set;return n.loginHistoryParsed.forEach(e=>{e.clusterTag&&o.add(e.clusterTag)}),Array.from(o).sort()}),P=N(x.value);function $(o,e){e(()=>{if(p.value=o||"",!o)P.value=x.value;else{const a=o.toLowerCase();P.value=x.value.filter(s=>s.toLowerCase().includes(a))}})}function q(o,e){e(o)}const T=C(()=>{const o=new Map;for(const e of n.loginHistoryParsed){if(!e?.node)continue;const a=`${e.node.host}:${String(e.node.port??"")}`;let s=o.get(a);s||(s=new Set,o.set(a,s)),e.apiKey&&s.add(e.apiKey)}return o});function A(o){const e=`${o.node.host}:${String(o.node.port??"")}`,a=T.value.get(e);return!!a&&a.size>1}function B(o){return(o.apiKey||"").toString().slice(0,3)}return(o,e)=>(g(),h(ot,{style:{"min-width":"100px"}},{default:r(()=>[u.showLogout?V((g(),h(R,{key:0,clickable:"",onClick:Q(n).logout},{default:r(()=>[i(k,null,{default:r(()=>[...e[5]||(e[5]=[S("Logout",-1)])]),_:1}),i(k,{avatar:""},{default:r(()=>[i(ae,{name:"sym_s_logout"})]),_:1})]),_:1},8,["onClick"])),[[D]]):w("",!0),u.showLogout?(g(),h(ne,{key:1})):w("",!0),V((g(),h(R,{clickable:"",onClick:Q(n).clearHistory},{default:r(()=>[i(k,null,{default:r(()=>[...e[6]||(e[6]=[S("Clear history",-1)])]),_:1}),i(k,{avatar:""},{default:r(()=>[i(ae,{name:"sym_s_delete"})]),_:1})]),_:1},8,["onClick"])),[[D]]),i(ne),Q(n).loginHistoryParsed.length===0?(g(),h(de,{key:2,header:""},{default:r(()=>[...e[7]||(e[7]=[S("No History",-1)])]),_:1})):w("",!0),Q(n).loginHistoryParsed.length>0?(g(),h(de,{key:3,header:""},{default:r(()=>[...e[8]||(e[8]=[S("Server History",-1)])]),_:1})):w("",!0),(g(!0),W(je,null,Me(Q(n).loginHistoryParsed,(a,s)=>V((g(),h(R,{key:s,clickable:"",dense:"",onClick:I=>f(a)},{default:r(()=>[i(k,null,{default:r(()=>[L("div",nt,[L("div",lt,[L("div",null,O(a.node.protocol)+"://"+O(a.node.host)+":"+O(a.node.port),1),a.apiKey&&A(a)?(g(),W("div",st," key: "+O(B(a))+"â€¦ ",1)):w("",!0)]),a.clusterTag?(g(),W("div",it,[i(tt,{size:"sm",color:"accent","text-color":"white",dense:""},{default:r(()=>[S(O(a.clusterTag),1)]),_:2},1024)])):w("",!0)])]),_:2},1024),i(k,{side:""},{default:r(()=>[i(E,{flat:"",round:"",dense:"",icon:"sym_s_edit",onClick:Fe(I=>m(s),["stop"])},{default:r(()=>[i(at,null,{default:r(()=>[...e[9]||(e[9]=[S("Set cluster tag or delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])),[[D]])),128)),i(We,{modelValue:l.visible,"onUpdate:modelValue":e[4]||(e[4]=a=>l.visible=a)},{default:r(()=>[i(Re,{style:{"min-width":"320px"}},{default:r(()=>[i(le,null,{default:r(()=>[...e[10]||(e[10]=[L("div",{class:"text-h6"},"Set Cluster Tag",-1),L("div",{class:"text-subtitle2 text-grey-7"},"Group servers by giving them the same tag.",-1)])]),_:1}),i(le,null,{default:r(()=>[i(et,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),options:P.value,"use-input":"","fill-input":"","hide-selected":"","input-debounce":"0","new-value-mode":"add",outlined:"",label:"Cluster tag",onFilter:$,onNewValue:q},null,8,["modelValue","options"])]),_:1}),i(Ue,{align:"right"},{default:r(()=>[i(E,{flat:"",label:"Delete entry",color:"negative",onClick:e[1]||(e[1]=a=>v(l.index))}),i(E,{flat:"",label:"Remove tag",color:"warning",onClick:e[2]||(e[2]=a=>K())}),V(i(E,{flat:"",label:"Cancel"},null,512),[[D]]),i(E,{unelevated:"",color:"accent",label:"Save",onClick:e[3]||(e[3]=a=>b())})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{vt as _};
