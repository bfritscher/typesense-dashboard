import{K as x,u as P,H as N,f as c,A as Q,U as p,M as f,O as r,N as t,a3 as k,V as C,a4 as w,a7 as g,S as n,T as i,X as d,$ as _,a9 as E,W as y,R as O}from"./index-TreL_WJR.js";import{Q as J}from"./QBanner-DHWR3dzq.js";import{Q as U,a as $,b as j}from"./QTable-BDOh6kVp.js";import{Q as q}from"./QPage-BEEUHEA3.js";import{u as A}from"./use-quasar-BZWIP0gQ.js";import{M as B}from"./MonacoEditor-BIY3YNJC.js";import"./QSelect-DI4b5CBb.js";import"./format-BvkBI9bc.js";import"./QList-CP_2Mym6.js";import"./QLinearProgress-CpLcujzc.js";import"./QResizeObserver-DQ42bq8d.js";const D={class:"text-h6"},Y=x({__name:"SearchPresets",setup(I){const h=A(),o=P(),e=N({jsonError:null,preset:{name:"",value:{collection:"products",q:"*",sort_by:"popularity"}},expanded:o.data.searchPresets.length===0,filter:"",columns:[{label:"Name",name:"name",field:"name",sortable:!0,align:"left"},{label:"Search Parameters",name:"value",field:l=>JSON.stringify(l.value),sortable:!0,align:"left"},{label:"Actions",name:"actions_op",align:"right"}]}),m=c({get:()=>JSON.stringify(e.preset.value,null,2),set:l=>{try{e.preset.value=JSON.parse(l),e.jsonError=null}catch(a){e.jsonError=a.message}}}),u=c(()=>o.data.searchPresets.map(l=>l.name).includes(e.preset.name));async function b(){await o.upsertSearchPreset(JSON.parse(JSON.stringify(e.preset)))}function S(l){e.preset=JSON.parse(JSON.stringify(l)),e.expanded=!0}function v(l){h.dialog({title:"Confirm",message:`Delete preset ${l}?`,cancel:!0,persistent:!0}).onOk(()=>{o.deleteSearchPreset(l)})}return Q(()=>{o.getSearchPresets()}),(l,a)=>(f(),p(q,{padding:""},{default:r(()=>[t(U,{modelValue:e.expanded,"onUpdate:modelValue":a[3]||(a[3]=s=>e.expanded=s),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:`${u.value?"Update":"Add"} Search Preset`,"header-class":"bg-primary text-white"},{default:r(()=>[t(k,{style:{height:"60vh"},class:"bg-surface column"},{default:r(()=>[t(w,{class:"q-col-gutter-md row"},{default:r(()=>[t(g,{modelValue:e.preset.name,"onUpdate:modelValue":a[0]||(a[0]=s=>e.preset.name=s),class:"col-12 col-sm-6",label:"Name",filled:"",rules:[s=>!!s||"Field is required"]},null,8,["modelValue","rules"]),t(n,{type:"a",icon:"sym_s_help","no-caps":"",color:"info",flat:"",dense:"",href:`https://typesense.org/docs/${i(o).data.debug.version||i(o).data.defaultDocVersion}/api/search.html#presets`,target:"_blank"},{default:r(()=>[...a[5]||(a[5]=[d("Documentation",-1)])]),_:1},8,["href"])]),_:1}),t(B,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=s=>m.value=s)},null,8,["modelValue"]),e.jsonError?(f(),p(J,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:r(()=>[d(" Invalid Format: "+_(e.jsonError),1)]),_:1})):C("",!0),t(E,{align:"right",class:"bg-primary"},{default:r(()=>[t(n,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!e.jsonError,onClick:a[2]||(a[2]=s=>b())},{default:r(()=>[d(_(u.value?"Update":"Add")+" Preset",1)]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),t($,{class:"q-mt-md",title:"Search Presets",flat:"",bordered:"",filter:e.filter,rows:i(o).data.searchPresets,columns:e.columns,"row-key":"id"},{"top-left":r(()=>[O("div",D,[t(y,{size:"md",name:"sym_s_manage_search"}),a[6]||(a[6]=d(" Search Presets",-1))])]),"top-right":r(()=>[t(g,{modelValue:e.filter,"onUpdate:modelValue":a[4]||(a[4]=s=>e.filter=s),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:r(()=>[t(y,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions_op":r(s=>[t(j,{class:"text-right"},{default:r(()=>[t(n,{flat:"",icon:"sym_s_edit",title:"Edit",onClick:V=>S(s.row)},null,8,["onClick"]),t(n,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:V=>v(s.row.name)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{Y as default};
