import{K as y,u as A,H as V,f as r,U as v,M as Q,O as s,N as a,a3 as C,a4 as N,a7 as c,a9 as k,S as i,X as u,$ as w,T as S,W as p,R as U}from"./index-DnHRCA39.js";import{c as $}from"./QSelect-DR-JzzAA.js";import{Q as B,a as T,b as O}from"./QTable-D1Z6WW5k.js";import{Q as D}from"./QPage-C9y48WQW.js";import{u as I}from"./use-quasar-EYoWDy1A.js";import"./format-BvkBI9bc.js";import"./QList-B_1Lixfi.js";import"./QLinearProgress-C9DFsjuP.js";const P={class:"text-h6"},W=y({__name:"Aliases",setup(h){const f=I(),n=A(),e=V({alias:{name:"",collection_name:""},expanded:n.data.aliases.length===0,filter:"",columns:[{label:"Alias Name",name:"name",field:"name",align:"left",sortable:!0},{label:"Collection Name",name:"collection_name",field:"collection_name",align:"left",sortable:!0},{label:"Actions",name:"actions",align:"right"}]}),d=r(()=>n.data.collections.map(o=>o.name).sort()),m=r(()=>n.data.aliases.map(o=>o.name).includes(e.alias.name));async function _(){await n.createAlias({name:e.alias.name,collection_name:e.alias.collection_name}),e.alias={name:"",collection_name:""},e.expanded=!1}function g(o){e.alias=JSON.parse(JSON.stringify(o)),e.expanded=!0}function b(o){f.dialog({title:"Confirm",message:`Delete alias ${o}?`,cancel:!0,persistent:!0}).onOk(()=>{n.deleteAlias(o)})}return(o,t)=>(Q(),v(D,{padding:""},{default:s(()=>[a(B,{modelValue:e.expanded,"onUpdate:modelValue":t[3]||(t[3]=l=>e.expanded=l),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:`${m.value?"Update":"Add"} Alias`,"header-class":"bg-primary text-white"},{default:s(()=>[a(C,{class:"bg-surface column"},{default:s(()=>[a(N,null,{default:s(()=>[a(c,{modelValue:e.alias.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.alias.name=l),label:"Alias name",filled:"",rules:[l=>!d.value.includes(l)||"Must not be a collection name"]},null,8,["modelValue","rules"]),a($,{modelValue:e.alias.collection_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.alias.collection_name=l),label:"Target Collection",filled:"",options:d.value},null,8,["modelValue","options"])]),_:1}),a(k,{align:"right",class:"bg-primary"},{default:s(()=>[a(i,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:t[2]||(t[2]=l=>_())},{default:s(()=>[u(w(m.value?"Update":"Add")+" Alias",1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),a(T,{class:"q-mt-md",title:"Aliases",flat:"",bordered:"",filter:e.filter,rows:S(n).data.aliases,columns:e.columns,"row-key":"name","visible-columns":["name","collection_name","actions"],pagination:{rowsPerPage:50,sortBy:"name"}},{"top-left":s(()=>[U("div",P,[a(p,{size:"md",name:"sym_s_call_split"}),t[5]||(t[5]=u(" Aliases",-1))])]),"top-right":s(()=>[a(c,{modelValue:e.filter,"onUpdate:modelValue":t[4]||(t[4]=l=>e.filter=l),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:s(()=>[a(p,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions":s(l=>[a(O,{class:"text-right"},{default:s(()=>[a(i,{flat:"",icon:"sym_s_edit",title:"Edit",onClick:x=>g(l.row)},null,8,["onClick"]),a(i,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:x=>b(l.row.name)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{W as default};
