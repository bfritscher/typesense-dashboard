import{Q as qa,a as fr,b as Ta,c as hr}from"./QTabPanels-Du0_ggQB.js";import{e as qt,h as Y,B as sr,p as xa,r as Q,i as ea,s as ja,f as z,ac as ka,w as Tt,ad as Mt,ae as Ia,af as Ma,o as Na,J as Ha,ag as pr,t as vr,G as Da,A as Fa,ah as Ua,g as za,ai as $a,aj as Nt,K as me,Z as re,L as J,M as L,N as I,V as ae,U as ie,S as pe,a5 as le,_ as ta,O as K,a6 as ve,ab as _r,X as de,$ as fe,u as lr,Q as ra,R as ne,P as mr,Y as La,W as Ba,a7 as Wa,ak as j,al as Ka,am as Qa,an as ur,ao as Ga,T as Ja,ap as Va}from"./index-BI7ap2PB.js";import{Q as Xa}from"./QPage-Bb5okTBx.js";import{a as cr,Q as Et,b as Te,c as Ya}from"./QSelect-IrRwlxg4.js";import{Q as na}from"./QList-MPtiu80E.js";import{Q as yr}from"./QResizeObserver-CwBQzNLq.js";import{Q as Za,T as gr}from"./QScrollObserver-CCfsiQW3.js";import{b as ge}from"./format-BvkBI9bc.js";import{Q as aa}from"./QBanner-CRzn7ZS9.js";import{M as ei}from"./MonacoEditor-DV2eji2C.js";import{u as ti}from"./use-quasar-vhP78jHF.js";import{G as ri,J as ni}from"./ExperimentalDynamicWidgets-C7GXvVL_.js";import"./touch-BjYP5sR0.js";const ai=qt({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(e){return()=>[Y("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),Y("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),sr(Y("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),sr(Y("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]}}),br=["vertical","horizontal"],Ht={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},Sr={prevent:!0,mouse:!0,mouseAllDir:!0},Cr=e=>e>=250?50:Math.ceil(e/5),ii=qt({name:"QScrollArea",props:{...xa,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:l,emit:c}){const r=Q(!1),t=Q(!1),i=Q(!1),o={vertical:Q(0),horizontal:Q(0)},u={vertical:{ref:Q(null),position:Q(0),size:Q(0)},horizontal:{ref:Q(null),position:Q(0),size:Q(0)}},{proxy:v}=ea(),m=ja(e,v.$q);let _=null,p;const n=Q(null),a=z(()=>"q-scrollarea"+(m.value===!0?" q-scrollarea--dark":""));Object.assign(o,{verticalInner:z(()=>o.vertical.value-e.verticalOffset[0]-e.verticalOffset[1]),horizontalInner:z(()=>o.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1])}),u.vertical.percentage=z(()=>{const O=u.vertical.size.value-o.vertical.value;if(O<=0)return 0;const x=ge(u.vertical.position.value/O,0,1);return Math.round(x*1e4)/1e4}),u.vertical.thumbHidden=z(()=>(e.visible===null?i.value:e.visible)!==!0&&r.value===!1&&t.value===!1||u.vertical.size.value<=o.vertical.value+1),u.vertical.thumbStart=z(()=>e.verticalOffset[0]+u.vertical.percentage.value*(o.verticalInner.value-u.vertical.thumbSize.value)),u.vertical.thumbSize=z(()=>Math.round(ge(o.verticalInner.value*o.verticalInner.value/u.vertical.size.value,Cr(o.verticalInner.value),o.verticalInner.value))),u.vertical.style=z(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${u.vertical.thumbStart.value}px`,height:`${u.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`})),u.vertical.thumbClass=z(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.vertical.barClass=z(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),u.horizontal.percentage=z(()=>{const O=u.horizontal.size.value-o.horizontal.value;if(O<=0)return 0;const x=ge(Math.abs(u.horizontal.position.value)/O,0,1);return Math.round(x*1e4)/1e4}),u.horizontal.thumbHidden=z(()=>(e.visible===null?i.value:e.visible)!==!0&&r.value===!1&&t.value===!1||u.horizontal.size.value<=o.horizontal.value+1),u.horizontal.thumbStart=z(()=>e.horizontalOffset[0]+u.horizontal.percentage.value*(o.horizontalInner.value-u.horizontal.thumbSize.value)),u.horizontal.thumbSize=z(()=>Math.round(ge(o.horizontalInner.value*o.horizontalInner.value/u.horizontal.size.value,Cr(o.horizontalInner.value),o.horizontalInner.value))),u.horizontal.style=z(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[v.$q.lang.rtl===!0?"right":"left"]:`${u.horizontal.thumbStart.value}px`,width:`${u.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`})),u.horizontal.thumbClass=z(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.horizontal.barClass=z(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const s=z(()=>u.vertical.thumbHidden.value===!0&&u.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle);function d(){const O={};return br.forEach(x=>{const U=u[x];Object.assign(O,{[x+"Position"]:U.position.value,[x+"Percentage"]:U.percentage.value,[x+"Size"]:U.size.value,[x+"ContainerSize"]:o[x].value,[x+"ContainerInnerSize"]:o[x+"Inner"].value})}),O}const f=ka(()=>{const O=d();O.ref=v,c("scroll",O)},0);function h(O,x,U){if(br.includes(O)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(O==="vertical"?pr:Mt)(n.value,x,U)}function y({height:O,width:x}){let U=!1;o.vertical.value!==O&&(o.vertical.value=O,U=!0),o.horizontal.value!==x&&(o.horizontal.value=x,U=!0),U===!0&&q()}function S({position:O}){let x=!1;u.vertical.position.value!==O.top&&(u.vertical.position.value=O.top,x=!0),u.horizontal.position.value!==O.left&&(u.horizontal.position.value=O.left,x=!0),x===!0&&q()}function b({height:O,width:x}){u.horizontal.size.value!==x&&(u.horizontal.size.value=x,q()),u.vertical.size.value!==O&&(u.vertical.size.value=O,q())}function A(O,x){const U=u[x];if(O.isFirst===!0){if(U.thumbHidden.value===!0)return;p=U.position.value,t.value=!0}else if(t.value!==!0)return;O.isFinal===!0&&(t.value=!1);const D=Ht[x],$=(U.size.value-o[x].value)/(o[x+"Inner"].value-U.thumbSize.value),P=O.distance[D.dist],g=p+(O.direction===D.dir?1:-1)*P*$;k(g,x)}function E(O,x){const U=u[x];if(U.thumbHidden.value!==!0){const D=x==="vertical"?e.verticalOffset[0]:e.horizontalOffset[0],$=O[Ht[x].offset]-D,P=U.thumbStart.value-D;if($<P||$>P+U.thumbSize.value){const g=$-U.thumbSize.value/2,w=ge(g/(o[x+"Inner"].value-U.thumbSize.value),0,1);k(w*Math.max(0,U.size.value-o[x].value),x)}U.ref.value!==null&&U.ref.value.dispatchEvent(new MouseEvent(O.type,O))}}function q(){r.value=!0,_!==null&&clearTimeout(_),_=setTimeout(()=>{_=null,r.value=!1},e.delay),e.onScroll!==void 0&&f()}function k(O,x){n.value[Ht[x].scroll]=O}let C=null;function F(){C!==null&&clearTimeout(C),C=setTimeout(()=>{C=null,i.value=!0},v.$q.platform.is.ios?50:0)}function B(){C!==null&&(clearTimeout(C),C=null),i.value=!1}let T=null;Tt(()=>v.$q.lang.rtl,O=>{n.value!==null&&Mt(n.value,Math.abs(u.horizontal.position.value)*(O===!0?-1:1))}),Ia(()=>{T={top:u.vertical.position.value,left:u.horizontal.position.value}}),Ma(()=>{if(T===null)return;const O=n.value;O!==null&&(Mt(O,T.left),pr(O,T.top))}),Na(f.cancel),Object.assign(v,{getScrollTarget:()=>n.value,getScroll:d,getScrollPosition:()=>({top:u.vertical.position.value,left:u.horizontal.position.value}),getScrollPercentage:()=>({top:u.vertical.percentage.value,left:u.horizontal.percentage.value}),setScrollPosition:h,setScrollPercentage(O,x,U){h(O,x*(u[O].size.value-o[O].value)*(O==="horizontal"&&v.$q.lang.rtl===!0?-1:1),U)}});const H={scroll:u,thumbVertDir:[[gr,O=>{A(O,"vertical")},void 0,{vertical:!0,...Sr}]],thumbHorizDir:[[gr,O=>{A(O,"horizontal")},void 0,{horizontal:!0,...Sr}]],onVerticalMousedown(O){E(O,"vertical")},onHorizontalMousedown(O){E(O,"horizontal")}};return()=>Y("div",{class:a.value,onMouseenter:F,onMouseleave:B},[Y("div",{ref:n,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[Y("div",{class:"q-scrollarea__content absolute",style:s.value},Ha(l.default,[Y(yr,{debounce:0,onResize:b})])),Y(Za,{axis:"both",onScroll:S})]),Y(yr,{debounce:0,onResize:y}),Y(ai,{store:H,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}}),oi=qt({name:"QSpace",setup(){const e=Y("div",{class:"q-space"});return()=>e}}),si={ratio:[String,Number]};function ui(e,l){return z(()=>{const c=Number(e.ratio||(l!==void 0?l.value:void 0));return isNaN(c)!==!0&&c>0?{paddingBottom:`${100/c}%`}:null})}const li=1.7778,ci=qt({name:"QImg",props:{...si,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:li},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:l,emit:c}){const r=Q(e.initialRatio),t=ui(e,r),i=ea(),{registerTimeout:o,removeTimeout:u}=vr(),{registerTimeout:v,removeTimeout:m}=vr(),_=z(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),p=z(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),n=[Q(null),Q(_.value)],a=Q(0),s=Q(!1),d=Q(!1),f=z(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),h=z(()=>({width:e.width,height:e.height})),y=z(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),S=z(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function b(){if(m(),e.loadingShowDelay===0){s.value=!0;return}v(()=>{s.value=!0},e.loadingShowDelay)}function A(){m(),s.value=!1}function E({target:T}){Nt(i)===!1&&(u(),r.value=T.naturalHeight===0?.5:T.naturalWidth/T.naturalHeight,q(T,1))}function q(T,H){H===1e3||Nt(i)===!0||(T.complete===!0?k(T):o(()=>{q(T,H+1)},50))}function k(T){Nt(i)!==!0&&(a.value=a.value^1,n[a.value].value=null,A(),T.getAttribute("__qerror")!=="true"&&(d.value=!1),c("load",T.currentSrc||T.src))}function C(T){u(),A(),d.value=!0,n[a.value].value=p.value,n[a.value^1].value=_.value,c("error",T)}function F(T){const H=n[T].value,O={key:"img_"+T,class:y.value,style:S.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...H};return a.value===T?Object.assign(O,{class:O.class+"current",onLoad:E,onError:C}):O.class+="loaded",Y("div",{class:"q-img__container absolute-full",key:"img"+T},Y("img",O))}function B(){return s.value===!1?Y("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},za(l[d.value===!0?"error":"default"])):Y("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},l.loading!==void 0?l.loading():e.noSpinner===!0?void 0:[Y($a,{color:e.spinnerColor,size:e.spinnerSize})])}{let T=function(){Tt(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,H=>{u(),d.value=!1,H===null?(A(),n[a.value^1].value=_.value):b(),n[a.value].value=H},{immediate:!0})};Da.value===!0?Fa(T):T()}return()=>{const T=[];return t.value!==null&&T.push(Y("div",{key:"filler",style:t.value})),n[0].value!==null&&T.push(F(0)),n[1].value!==null&&T.push(F(1)),T.push(Y(Ua,{name:"q-transition--fade"},B)),Y("div",{key:"main",class:f.value,style:h.value,role:"img","aria-label":e.alt},T)}}}),di={key:0,class:"img-preview"},fi=me({__name:"SearchResultItemAttribute",props:{hit:{}},setup(e){const l=r=>r?(r=String(r),r.startsWith("http://")||r.startsWith("https://")):!1,c=r=>{if(!r)return!1;r=String(r);const t=["jpg","jpeg","png","gif","bmp","svg","webp"],i=r.split(".").pop()?.toLowerCase()||"";return t.includes(i)};return(r,t)=>{const i=re("ais-highlight");return L(),J(le,null,[I(i,{attribute:"a",hit:{_highlightResult:{a:r.hit}}},null,8,["hit"]),c(r.hit?.value)?(L(),J("div",di,[I(ci,{src:r.hit.value,fit:"contain",class:"img-preview"},null,8,["src"])])):ae("",!0),l(r.hit?.value)?(L(),ie(pe,{key:1,class:"absolute-top-right",flat:"",href:r.hit.value,target:"_blank",size:"sm",padding:"sm",icon:"sym_s_open_in_new",title:"open"},null,8,["href"])):ae("",!0)],64)}}}),Rr=ta(fi,[["__scopeId","data-v-1b631cd2"]]),hi={key:0},pi={key:0},vi={key:1},_i=me({__name:"SearchResultItemNestedDisplay",props:{item:{},includeFields:{default:()=>[]},embedFields:{default:()=>[]}},setup(e){const l=e;function c(o){return o.some(u=>u.value&&u.matchLevel)}function r(o,u){return o.filter(v=>v.startsWith(u)&&v!==u).map(v=>v.replace(`${u}.`,""))}const t=z(()=>{const o=Object.keys(l.item);return l.includeFields.filter(u=>o.includes(u)).concat(o.filter(u=>!l.includeFields.includes(u)))});function i(o,u=0,v=new WeakSet){if(u>10)return"[Max depth reached]";if(o==null||typeof o!="object")return o;if(v.has(o))return"[Circular reference]";if(v.add(o),Array.isArray(o))return o.map(_=>i(_,u+1,v));if(Object.prototype.hasOwnProperty.call(o,"value")&&Object.prototype.hasOwnProperty.call(o,"matchLevel"))return o.value;const m={};for(const _ in o)Object.prototype.hasOwnProperty.call(o,_)&&(m[_]=i(o[_],u+1,v));return m}return(o,u)=>{const v=re("search-result-item-nested-display",!0);return L(),ie(na,{dense:""},{default:K(()=>[(L(!0),J(le,null,ve(t.value,m=>(L(),ie(cr,{key:m},{default:K(()=>[I(Et,{side:"",class:"q-mt-sm text-body2"},{default:K(()=>[I(Te,{caption:"",class:_r(l.includeFields.includes(m)?"schema-field":"text-warning unknown-field")},{default:K(()=>[de(fe(m)+" ",1),Array.isArray(o.item[m])&&o.item[m].length>1?(L(),J("span",hi,"["+fe(o.item[m].length)+"]",1)):ae("",!0)]),_:2},1032,["class"]),l.embedFields.includes(m)?ae("",!0):(L(),ie(Te,{key:0,class:"overflow-hidden text-no-wrap text-ellipsis",title:JSON.stringify(i(o.item[m]),null,2)},{default:K(()=>[Array.isArray(o.item[m])?(L(),J("div",{key:0,class:_r(c(o.item[m])?"array-field":"nested-field")},[(L(!0),J(le,null,ve(o.item[m],(_,p)=>(L(),J(le,{key:p},[_.value&&_.matchLevel?(L(),J("div",pi,[I(Rr,{hit:_},null,8,["hit"])])):(L(),ie(v,{key:1,item:_,"include-fields":r(l.includeFields,m),"embed-fields":r(l.embedFields,m)},null,8,["item","include-fields","embed-fields"]))],64))),128))],2)):(L(),J("div",vi,[I(Rr,{hit:o.item[m]},null,8,["hit"])]))]),_:2},1032,["title"]))]),_:2},1024)]),_:2},1024))),128))]),_:1})}}}),mi={key:0,class:"column no-wrap search-result-item"},ia=me({__name:"SearchResultItem",props:{item:{}},emits:["deleted"],setup(e,{emit:l}){const c=e,r=l,t=lr(),i=ti(),o=z(()=>t.currentCollection),u=z(()=>!c.item||!o.value||!o.value.fields?[]:o.value.fields.map(p=>p.name)),v=z(()=>!c.item||!o.value||!o.value.fields?[]:o.value.fields.filter(p=>p.embed).map(p=>p.name)),m=()=>{const p={};c.item&&(Object.keys(c.item).forEach(n=>{!n.startsWith("_")&&!["objectID","text_match"].includes(n)&&(p[n]=c.item?.[n])}),t.editDocuments([JSON.parse(JSON.stringify(p))]))},_=p=>{i.dialog({title:"Confirm",message:`Delete document with id: ${p}?`,cancel:!0,persistent:!0}).onOk(()=>{t.deleteDocumentById(p)?.then(()=>{r("deleted",p)}).catch(n=>{i.notify({type:"negative",message:`Error deleting document: ${n.message}`})})})};return(p,n)=>o.value?(L(),J("div",mi,[p.item?(L(),ie(_i,{key:0,item:p.item._highlightResult,"include-fields":u.value,"embed-fields":v.value},null,8,["item","include-fields","embed-fields"])):ae("",!0),I(oi),I(ra),I(cr,null,{default:K(()=>[I(Et,null,{default:K(()=>[I(Te,null,{default:K(()=>[I(pe,{flat:"",size:"sm",padding:"sm",icon:"sym_s_edit",title:"Edit",onClick:n[0]||(n[0]=a=>m())})]),_:1})]),_:1}),I(Et,{side:""},{default:K(()=>[I(Te,null,{default:K(()=>[I(pe,{flat:"",size:"sm",padding:"sm",icon:"sym_s_delete_forever",title:"Delete",onClick:n[1]||(n[1]=a=>_(p.item?.id))})]),_:1})]),_:1})]),_:1})])):ae("",!0)}}),yi={class:"row"},gi={class:"col-9"},bi={class:"col-3"},Si={class:"q-mt-md"},Ci={key:1,class:"ais-Hits q-mt-md"},Ri={class:"ais-Hits-list"},Pi={key:2,class:"text-h5 q-mt-md"},wi={key:3},Pr="typesense-search-history",Oi=me({__name:"SearchJson",setup(e){const l=lr(),c=Q([]),r=Q({q:"stark",query_by:"company_name",filter_by:"num_employees:>100",sort_by:"num_employees:desc",page:1,per_page:10,exhaustive_search:!0}),t=Q(null),i=Q(null),o=z(()=>l.currentCollection),u=z({get:()=>JSON.stringify(r.value,null,2),set:f=>{try{r.value=JSON.parse(f),t.value=null}catch(h){t.value=h.message}}}),v=z(()=>i.value?.hits?i.value.hits.map(f=>{const h=Object.assign({},f.document);return h._highlightResult=Object.keys(f.document).reduce((y,S)=>(y[S]={value:String(f.document[S])},y),{}),f.highlights.forEach(y=>{h._highlightResult[y.field]={value:y.snippet}}),h}):[]),m=z(()=>JSON.stringify(i.value,null,2)),_=()=>{i.value&&l.exportToJson(i.value)},p=()=>{if(i.value?.hits){const f=i.value.hits.map(h=>h.document);l.exportToJson(f)}},n=()=>{mr.set(`${Pr}-${o.value?.name||""}`,c.value.slice(0,20))},a=()=>{const f=u.value,h=c.value.indexOf(f);h!==0&&(h>0&&c.value.splice(h,1),c.value.unshift(f),n())},s=async()=>{i.value=null,t.value=null,a();try{i.value=await l.search(r.value)}catch(f){t.value=f.message}};return Tt(o,()=>{c.value=mr.getItem(`${Pr}-${o.value?.name||""}`)||[]},{immediate:!0}),(f,h)=>(L(),J(le,null,[ne("div",yi,[ne("div",gi,[I(ei,{modelValue:u.value,"onUpdate:modelValue":h[0]||(h[0]=y=>u.value=y),style:{height:"30vh","min-height":"200px"}},null,8,["modelValue"])]),ne("div",bi,[I(ii,{style:{height:"100%"}},{default:K(()=>[I(na,{bordered:"",separator:"",dense:""},{default:K(()=>[I(Te,{header:""},{default:K(()=>h[4]||(h[4]=[de("History")])),_:1,__:[4]}),(L(!0),J(le,null,ve(c.value,y=>sr((L(),ie(cr,{key:y,clickable:"",title:y,onClick:S=>u.value=y},{default:K(()=>[I(Et,null,{default:K(()=>[de(fe(y.slice(0,60)),1)]),_:2},1024)]),_:2},1032,["title","onClick"])),[[La]])),128))]),_:1})]),_:1})])]),t.value?(L(),ie(aa,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:K(()=>[de(" Invalid Format: "+fe(t.value),1)]),_:1})):ae("",!0),ne("div",Si,[I(pe,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!t.value,onClick:h[1]||(h[1]=y=>s())},{default:K(()=>h[5]||(h[5]=[de("Run Query")])),_:1,__:[5]},8,["disable"]),I(pe,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!i.value||!i.value.hits,onClick:h[2]||(h[2]=y=>p())},{default:K(()=>h[6]||(h[6]=[de("Export Hits")])),_:1,__:[6]},8,["disable"]),I(pe,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!i.value,onClick:h[3]||(h[3]=y=>_())},{default:K(()=>h[7]||(h[7]=[de("Export Raw Results")])),_:1,__:[7]},8,["disable"])]),v.value?(L(),J("div",Ci,[ne("ol",Ri,[(L(!0),J(le,null,ve(v.value,y=>(L(),J("li",{key:y.id,class:"ais-Hits-item"},[I(ia,{item:y},null,8,["item"])]))),128))])])):ae("",!0),i.value&&i.value.hits&&i.value.hits.length===0?(L(),J("div",Pi," No match found ")):ae("",!0),i.value&&!i.value.hits?(L(),J("pre",wi,"          "+fe(m.value)+`
        `,1)):ae("",!0)],64))}}),Ai={mixins:[ri({connector:ni})],props:{delay:{type:Number,default:200,required:!1}},data(){return{timerId:null,localQuery:""}},computed:{query:{get(){return this.localQuery},set(e){this.localQuery=e,this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.state.refine(this.localQuery)},this.delay)}}},unmounted(){this.timerId&&clearTimeout(this.timerId)},methods:{clear(){this.query=""}}};function Ei(e,l,c,r,t,i){return L(),ie(Wa,{modelValue:i.query,"onUpdate:modelValue":l[0]||(l[0]=o=>i.query=o),dense:"",autofocus:"",outlined:"",type:"search",clearable:"","clear-icon":"close",placeholder:"Search...",onClear:i.clear},{prepend:K(()=>[I(Ba,{name:"search"})]),_:1},8,["modelValue","onClear"])}const qi=ta(Ai,[["render",Ei]]);var Dt={},Ft={exports:{}},wr;function xe(){return wr||(wr=1,function(e){function l(c){return c&&c.__esModule?c:{default:c}}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(Ft)),Ft.exports}var Ut={exports:{}},zt={exports:{}},Or;function xt(){return Or||(Or=1,function(e){function l(c){"@babel/helpers - typeof";return e.exports=l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},e.exports.__esModule=!0,e.exports.default=e.exports,l(c)}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(zt)),zt.exports}var Ar;function Ti(){return Ar||(Ar=1,function(e){var l=xt().default;function c(){e.exports=c=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var r,t={},i=Object.prototype,o=i.hasOwnProperty,u=Object.defineProperty||function(P,g,w){P[g]=w.value},v=typeof Symbol=="function"?Symbol:{},m=v.iterator||"@@iterator",_=v.asyncIterator||"@@asyncIterator",p=v.toStringTag||"@@toStringTag";function n(P,g,w){return Object.defineProperty(P,g,{value:w,enumerable:!0,configurable:!0,writable:!0}),P[g]}try{n({},"")}catch{n=function(w,R,N){return w[R]=N}}function a(P,g,w,R){var N=g&&g.prototype instanceof b?g:b,M=Object.create(N.prototype),G=new D(R||[]);return u(M,"_invoke",{value:H(P,w,G)}),M}function s(P,g,w){try{return{type:"normal",arg:P.call(g,w)}}catch(R){return{type:"throw",arg:R}}}t.wrap=a;var d="suspendedStart",f="suspendedYield",h="executing",y="completed",S={};function b(){}function A(){}function E(){}var q={};n(q,m,function(){return this});var k=Object.getPrototypeOf,C=k&&k(k($([])));C&&C!==i&&o.call(C,m)&&(q=C);var F=E.prototype=b.prototype=Object.create(q);function B(P){["next","throw","return"].forEach(function(g){n(P,g,function(w){return this._invoke(g,w)})})}function T(P,g){function w(N,M,G,Z){var X=s(P[N],P,M);if(X.type!=="throw"){var ee=X.arg,W=ee.value;return W&&l(W)=="object"&&o.call(W,"__await")?g.resolve(W.__await).then(function(se){w("next",se,G,Z)},function(se){w("throw",se,G,Z)}):g.resolve(W).then(function(se){ee.value=se,G(ee)},function(se){return w("throw",se,G,Z)})}Z(X.arg)}var R;u(this,"_invoke",{value:function(M,G){function Z(){return new g(function(X,ee){w(M,G,X,ee)})}return R=R?R.then(Z,Z):Z()}})}function H(P,g,w){var R=d;return function(N,M){if(R===h)throw Error("Generator is already running");if(R===y){if(N==="throw")throw M;return{value:r,done:!0}}for(w.method=N,w.arg=M;;){var G=w.delegate;if(G){var Z=O(G,w);if(Z){if(Z===S)continue;return Z}}if(w.method==="next")w.sent=w._sent=w.arg;else if(w.method==="throw"){if(R===d)throw R=y,w.arg;w.dispatchException(w.arg)}else w.method==="return"&&w.abrupt("return",w.arg);R=h;var X=s(P,g,w);if(X.type==="normal"){if(R=w.done?y:f,X.arg===S)continue;return{value:X.arg,done:w.done}}X.type==="throw"&&(R=y,w.method="throw",w.arg=X.arg)}}}function O(P,g){var w=g.method,R=P.iterator[w];if(R===r)return g.delegate=null,w==="throw"&&P.iterator.return&&(g.method="return",g.arg=r,O(P,g),g.method==="throw")||w!=="return"&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+w+"' method")),S;var N=s(R,P.iterator,g.arg);if(N.type==="throw")return g.method="throw",g.arg=N.arg,g.delegate=null,S;var M=N.arg;return M?M.done?(g[P.resultName]=M.value,g.next=P.nextLoc,g.method!=="return"&&(g.method="next",g.arg=r),g.delegate=null,S):M:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,S)}function x(P){var g={tryLoc:P[0]};1 in P&&(g.catchLoc=P[1]),2 in P&&(g.finallyLoc=P[2],g.afterLoc=P[3]),this.tryEntries.push(g)}function U(P){var g=P.completion||{};g.type="normal",delete g.arg,P.completion=g}function D(P){this.tryEntries=[{tryLoc:"root"}],P.forEach(x,this),this.reset(!0)}function $(P){if(P||P===""){var g=P[m];if(g)return g.call(P);if(typeof P.next=="function")return P;if(!isNaN(P.length)){var w=-1,R=function N(){for(;++w<P.length;)if(o.call(P,w))return N.value=P[w],N.done=!1,N;return N.value=r,N.done=!0,N};return R.next=R}}throw new TypeError(l(P)+" is not iterable")}return A.prototype=E,u(F,"constructor",{value:E,configurable:!0}),u(E,"constructor",{value:A,configurable:!0}),A.displayName=n(E,p,"GeneratorFunction"),t.isGeneratorFunction=function(P){var g=typeof P=="function"&&P.constructor;return!!g&&(g===A||(g.displayName||g.name)==="GeneratorFunction")},t.mark=function(P){return Object.setPrototypeOf?Object.setPrototypeOf(P,E):(P.__proto__=E,n(P,p,"GeneratorFunction")),P.prototype=Object.create(F),P},t.awrap=function(P){return{__await:P}},B(T.prototype),n(T.prototype,_,function(){return this}),t.AsyncIterator=T,t.async=function(P,g,w,R,N){N===void 0&&(N=Promise);var M=new T(a(P,g,w,R),N);return t.isGeneratorFunction(g)?M:M.next().then(function(G){return G.done?G.value:M.next()})},B(F),n(F,p,"Generator"),n(F,m,function(){return this}),n(F,"toString",function(){return"[object Generator]"}),t.keys=function(P){var g=Object(P),w=[];for(var R in g)w.push(R);return w.reverse(),function N(){for(;w.length;){var M=w.pop();if(M in g)return N.value=M,N.done=!1,N}return N.done=!0,N}},t.values=$,D.prototype={constructor:D,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(U),!g)for(var w in this)w.charAt(0)==="t"&&o.call(this,w)&&!isNaN(+w.slice(1))&&(this[w]=r)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if(g.type==="throw")throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var w=this;function R(ee,W){return G.type="throw",G.arg=g,w.next=ee,W&&(w.method="next",w.arg=r),!!W}for(var N=this.tryEntries.length-1;N>=0;--N){var M=this.tryEntries[N],G=M.completion;if(M.tryLoc==="root")return R("end");if(M.tryLoc<=this.prev){var Z=o.call(M,"catchLoc"),X=o.call(M,"finallyLoc");if(Z&&X){if(this.prev<M.catchLoc)return R(M.catchLoc,!0);if(this.prev<M.finallyLoc)return R(M.finallyLoc)}else if(Z){if(this.prev<M.catchLoc)return R(M.catchLoc,!0)}else{if(!X)throw Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return R(M.finallyLoc)}}}},abrupt:function(g,w){for(var R=this.tryEntries.length-1;R>=0;--R){var N=this.tryEntries[R];if(N.tryLoc<=this.prev&&o.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var M=N;break}}M&&(g==="break"||g==="continue")&&M.tryLoc<=w&&w<=M.finallyLoc&&(M=null);var G=M?M.completion:{};return G.type=g,G.arg=w,M?(this.method="next",this.next=M.finallyLoc,S):this.complete(G)},complete:function(g,w){if(g.type==="throw")throw g.arg;return g.type==="break"||g.type==="continue"?this.next=g.arg:g.type==="return"?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):g.type==="normal"&&w&&(this.next=w),S},finish:function(g){for(var w=this.tryEntries.length-1;w>=0;--w){var R=this.tryEntries[w];if(R.finallyLoc===g)return this.complete(R.completion,R.afterLoc),U(R),S}},catch:function(g){for(var w=this.tryEntries.length-1;w>=0;--w){var R=this.tryEntries[w];if(R.tryLoc===g){var N=R.completion;if(N.type==="throw"){var M=N.arg;U(R)}return M}}throw Error("illegal catch attempt")},delegateYield:function(g,w,R){return this.delegate={iterator:$(g),resultName:w,nextLoc:R},this.method==="next"&&(this.arg=r),S}},t}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ut)),Ut.exports}var $t,Er;function oa(){if(Er)return $t;Er=1;var e=Ti()();$t=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return $t}var Lt={exports:{}},qr;function sa(){return qr||(qr=1,function(e){function l(r,t,i,o,u,v,m){try{var _=r[v](m),p=_.value}catch(n){return void i(n)}_.done?t(p):Promise.resolve(p).then(o,u)}function c(r){return function(){var t=this,i=arguments;return new Promise(function(o,u){var v=r.apply(t,i);function m(p){l(v,o,u,m,_,"next",p)}function _(p){l(v,o,u,m,_,"throw",p)}m(void 0)})}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Lt)),Lt.exports}var Bt={exports:{}},Tr;function je(){return Tr||(Tr=1,function(e){function l(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(Bt)),Bt.exports}var Wt={exports:{}},Kt={exports:{}},Qt={exports:{}},xr;function xi(){return xr||(xr=1,function(e){var l=xt().default;function c(r,t){if(l(r)!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var o=i.call(r,t||"default");if(l(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Qt)),Qt.exports}var jr;function ua(){return jr||(jr=1,function(e){var l=xt().default,c=xi();function r(t){var i=c(t,"string");return l(i)=="symbol"?i:i+""}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(Kt)),Kt.exports}var kr;function ke(){return kr||(kr=1,function(e){var l=ua();function c(t,i){for(var o=0;o<i.length;o++){var u=i[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,l(u.key),u)}}function r(t,i,o){return i&&c(t.prototype,i),o&&c(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(Wt)),Wt.exports}var be={},Ir;function ji(){if(Ir)return be;Ir=1;var e=xe();Object.defineProperty(be,"__esModule",{value:!0}),be.Configuration=void 0;var l=e(je()),c=e(ke());return be.Configuration=function(){function r(){var t,i,o,u,v,m,_,p,n,a,s,d,f,h=this,y,S,b,A,E,q,k,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,l.default)(this,r),this.server=C.server||{nodes:[{host:"localhost",port:"8108",path:"",protocol:"http"}]},this.server.cacheSearchResultsForSeconds=(t=this.server.cacheSearchResultsForSeconds)!==null&&t!==void 0?t:2*60,this.additionalSearchParameters=(i=C.additionalSearchParameters)!==null&&i!==void 0?i:{},this.additionalSearchParameters.query_by=(o=(u=this.additionalSearchParameters.queryBy)!==null&&u!==void 0?u:this.additionalSearchParameters.query_by)!==null&&o!==void 0?o:"",this.additionalSearchParameters.preset=(v=(m=this.additionalSearchParameters.preset)!==null&&m!==void 0?m:this.additionalSearchParameters.preset)!==null&&v!==void 0?v:"",this.additionalSearchParameters.sort_by=(_=(p=this.additionalSearchParameters.sortBy)!==null&&p!==void 0?p:this.additionalSearchParameters.sort_by)!==null&&_!==void 0?_:"",this.additionalSearchParameters.highlight_full_fields=(n=(a=this.additionalSearchParameters.highlightFullFields)!==null&&a!==void 0?a:this.additionalSearchParameters.highlight_full_fields)!==null&&n!==void 0?n:this.additionalSearchParameters.query_by,this.geoLocationField=(s=C.geoLocationField)!==null&&s!==void 0?s:"_geoloc",this.facetableFieldsWithSpecialCharacters=(d=C.facetableFieldsWithSpecialCharacters)!==null&&d!==void 0?d:[],this.collectionSpecificSearchParameters=(f=C.collectionSpecificSearchParameters)!==null&&f!==void 0?f:{},Object.keys(this.collectionSpecificSearchParameters).forEach(function(F){var B,T,H,O,x,U,D=h.collectionSpecificSearchParameters[F];D.query_by=(B=D.queryBy)!==null&&B!==void 0?B:D.query_by,D.preset=(T=D.preset)!==null&&T!==void 0?T:D.preset,D.sort_by=(H=D.sortBy)!==null&&H!==void 0?H:D.sort_by,D.highlight_full_fields=(O=(x=(U=D.highlightFullFields)!==null&&U!==void 0?U:D.highlight_full_fields)!==null&&x!==void 0?x:h.additionalSearchParameters.highlight_full_fields)!==null&&O!==void 0?O:D.query_by,Object.keys(D).forEach(function($){return D[$]===void 0?delete D[$]:{}})}),this.renderingContent=C.renderingContent,this.flattenGroupedHits=(y=C.flattenGroupedHits)!==null&&y!==void 0?y:!0,this.facetByOptions=(S=C.facetByOptions)!==null&&S!==void 0?S:{},this.filterByOptions=(b=C.filterByOptions)!==null&&b!==void 0?b:{},this.sortByOptions=(A=C.sortByOptions)!==null&&A!==void 0?A:{},this.collectionSpecificFacetByOptions=(E=C.collectionSpecificFacetByOptions)!==null&&E!==void 0?E:{},this.collectionSpecificFilterByOptions=(q=C.collectionSpecificFilterByOptions)!==null&&q!==void 0?q:{},this.collectionSpecificSortByOptions=(k=C.collectionSpecificSortByOptions)!==null&&k!==void 0?k:{}}return(0,c.default)(r,[{key:"validate",value:function(){if((this.additionalSearchParameters.queryBy||Object.values(this.collectionSpecificSearchParameters).some(function(i){return i.queryBy}))&&console.warn("[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version. We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js."),this.additionalSearchParameters.query_by.length===0&&this.additionalSearchParameters.preset.length===0&&(Object.keys(this.collectionSpecificSearchParameters).length===0||Object.values(this.collectionSpecificSearchParameters).some(function(i){return(i.query_by||"").length===0&&(i.preset||"").length===0})))throw new Error("[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.")}}])}(),be}var ue={},Me={},Ne={},V={},He={},De={},Mr;function oe(){if(Mr)return De;Mr=1,Object.defineProperty(De,"__esModule",{value:!0});var e=j,l=function(c){e.__extends(r,c);function r(t,i,o){var u=this.constructor,v=c.call(this,t)||this;return v.name=u.name,v.httpBody=i,v.httpStatus=o,Object.setPrototypeOf(v,u.prototype),v}return r}(Error);return De.default=l,De}var Nr;function ki(){if(Nr)return He;Nr=1,Object.defineProperty(He,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return He.default=c,He}var Fe={},Hr;function Ii(){if(Hr)return Fe;Hr=1,Object.defineProperty(Fe,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return Fe.default=c,Fe}var Ue={},Dr;function Mi(){if(Dr)return Ue;Dr=1,Object.defineProperty(Ue,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return Ue.default=c,Ue}var ze={},Fr;function Ni(){if(Fr)return ze;Fr=1,Object.defineProperty(ze,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return ze.default=c,ze}var $e={},Ur;function Hi(){if(Ur)return $e;Ur=1,Object.defineProperty($e,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return $e.default=c,$e}var Le={},zr;function Di(){if(zr)return Le;zr=1,Object.defineProperty(Le,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return Le.default=c,Le}var Be={},$r;function Fi(){if($r)return Be;$r=1,Object.defineProperty(Be,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return Be.default=c,Be}var We={},Lr;function Ui(){if(Lr)return We;Lr=1,Object.defineProperty(We,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(l.default);return We.default=c,We}var Ke={},Br;function zi(){if(Br)return Ke;Br=1,Object.defineProperty(Ke,"__esModule",{value:!0});var e=j,l=e.__importDefault(oe()),c=function(r){e.__extends(t,r);function t(i,o,u){var v=r.call(this,i)||this;return v.importResults=o,v.payload=u,v}return t}(l.default);return Ke.default=c,Ke}var Wr;function Ie(){if(Wr)return V;Wr=1,Object.defineProperty(V,"__esModule",{value:!0}),V.ImportError=V.TypesenseError=V.ServerError=V.RequestUnauthorized=V.RequestMalformed=V.ObjectUnprocessable=V.ObjectNotFound=V.ObjectAlreadyExists=V.MissingConfigurationError=V.HTTPError=void 0;var e=j,l=e.__importDefault(ki());V.HTTPError=l.default;var c=e.__importDefault(Ii());V.MissingConfigurationError=c.default;var r=e.__importDefault(Mi());V.ObjectAlreadyExists=r.default;var t=e.__importDefault(Ni());V.ObjectNotFound=t.default;var i=e.__importDefault(Hi());V.ObjectUnprocessable=i.default;var o=e.__importDefault(Di());V.RequestMalformed=o.default;var u=e.__importDefault(Fi());V.RequestUnauthorized=u.default;var v=e.__importDefault(Ui());V.ServerError=v.default;var m=e.__importDefault(zi());V.ImportError=m.default;var _=e.__importDefault(oe());return V.TypesenseError=_.default,V}var Kr;function la(){if(Kr)return Ne;Kr=1,Object.defineProperty(Ne,"__esModule",{value:!0});var e=j,l=e.__importStar(Ka()),c=Ie(),r=function(){function t(i){var o=this;this.nodes=i.nodes||[],this.nodes=this.nodes.map(function(u){return o.setDefaultPathInNode(u)}).map(function(u){return o.setDefaultPortInNode(u)}).map(function(u){return e.__assign({},u)}),i.randomizeNodes==null&&(i.randomizeNodes=!0),i.randomizeNodes===!0&&this.shuffleArray(this.nodes),this.nearestNode=i.nearestNode,this.nearestNode=this.setDefaultPathInNode(this.nearestNode),this.nearestNode=this.setDefaultPortInNode(this.nearestNode),this.connectionTimeoutSeconds=i.connectionTimeoutSeconds||i.timeoutSeconds||5,this.healthcheckIntervalSeconds=i.healthcheckIntervalSeconds||60,this.numRetries=(i.numRetries!==void 0&&i.numRetries>=0?i.numRetries:this.nodes.length+(this.nearestNode==null?0:1))||3,this.retryIntervalSeconds=i.retryIntervalSeconds||.1,this.apiKey=i.apiKey,this.sendApiKeyAsQueryParam=i.sendApiKeyAsQueryParam,this.cacheSearchResultsForSeconds=i.cacheSearchResultsForSeconds||0,this.useServerSideSearchCache=i.useServerSideSearchCache||!1,this.axiosAdapter=i.axiosAdapter,this.logger=i.logger||l,this.logLevel=i.logLevel||"warn",this.logger.setLevel(this.logLevel),this.additionalHeaders=i.additionalHeaders,this.httpAgent=i.httpAgent,this.httpsAgent=i.httpsAgent,this.paramsSerializer=i.paramsSerializer,this.streamConfig=i.streamConfig,this.showDeprecationWarnings(i),this.validate()}return t.prototype.validate=function(){if(this.nodes==null||this.nodes.length===0||this.validateNodes())throw new c.MissingConfigurationError("Ensure that nodes[].protocol, nodes[].host and nodes[].port are set");if(this.nearestNode!=null&&this.isNodeMissingAnyParameters(this.nearestNode))throw new c.MissingConfigurationError("Ensure that nearestNodes.protocol, nearestNodes.host and nearestNodes.port are set");if(this.apiKey==null)throw new c.MissingConfigurationError("Ensure that apiKey is set");return!0},t.prototype.validateNodes=function(){var i=this;return this.nodes.some(function(o){return i.isNodeMissingAnyParameters(o)})},t.prototype.isNodeMissingAnyParameters=function(i){return!["protocol","host","port","path"].every(function(o){return i.hasOwnProperty(o)})&&i.url==null},t.prototype.setDefaultPathInNode=function(i){return i!=null&&!i.hasOwnProperty("path")&&(i.path=""),i},t.prototype.setDefaultPortInNode=function(i){if(i!=null&&!i.hasOwnProperty("port")&&i.hasOwnProperty("protocol"))switch(i.protocol){case"https":i.port=443;break;case"http":i.port=80;break}return i},t.prototype.showDeprecationWarnings=function(i){i.timeoutSeconds&&this.logger.warn("Deprecation warning: timeoutSeconds is now renamed to connectionTimeoutSeconds"),i.masterNode&&this.logger.warn("Deprecation warning: masterNode is now consolidated to nodes, starting with Typesense Server v0.12"),i.readReplicaNodes&&this.logger.warn("Deprecation warning: readReplicaNodes is now consolidated to nodes, starting with Typesense Server v0.12")},t.prototype.shuffleArray=function(i){for(var o,u=i.length-1;u>0;u--){var v=Math.floor(Math.random()*(u+1));o=[i[v],i[u]],i[u]=o[0],i[v]=o[1]}},t}();return Ne.default=r,Ne}var Qe={},Qr;function ca(){if(Qr)return Qe;Qr=1,Object.defineProperty(Qe,"__esModule",{value:!0});var e=j,l=e.__importDefault(Qa()),c=ur,r=ur,t=Ie(),i=e.__importDefault(oe()),o="X-TYPESENSE-API-KEY",u=!0,v=!1,m=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,_=function(){function p(n){this.configuration=n,this.apiKey=this.configuration.apiKey,this.nodes=this.configuration.nodes==null?this.configuration.nodes:JSON.parse(JSON.stringify(this.configuration.nodes)),this.nearestNode=this.configuration.nearestNode==null?this.configuration.nearestNode:JSON.parse(JSON.stringify(this.configuration.nearestNode)),this.connectionTimeoutSeconds=this.configuration.connectionTimeoutSeconds,this.healthcheckIntervalSeconds=this.configuration.healthcheckIntervalSeconds,this.numRetriesPerRequest=this.configuration.numRetries,this.retryIntervalSeconds=this.configuration.retryIntervalSeconds,this.sendApiKeyAsQueryParam=this.configuration.sendApiKeyAsQueryParam,this.additionalUserHeaders=this.configuration.additionalHeaders,this.logger=this.configuration.logger,this.initializeMetadataForNodes(),this.currentNodeIndex=-1}return p.prototype.get=function(n,a,s){a===void 0&&(a={});var d=s===void 0?{}:s,f=d.abortSignal,h=f===void 0?null:f,y=d.responseType,S=y===void 0?void 0:y;return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return[2,this.performRequest("get",n,{queryParameters:a,abortSignal:h,responseType:S})]})})},p.prototype.delete=function(n,a){return a===void 0&&(a={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(s){return[2,this.performRequest("delete",n,{queryParameters:a})]})})},p.prototype.post=function(n,a,s,d){return a===void 0&&(a={}),s===void 0&&(s={}),d===void 0&&(d={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(f){return[2,this.performRequest("post",n,{queryParameters:s,bodyParameters:a,additionalHeaders:d})]})})},p.prototype.put=function(n,a,s){return a===void 0&&(a={}),s===void 0&&(s={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){return[2,this.performRequest("put",n,{queryParameters:s,bodyParameters:a})]})})},p.prototype.patch=function(n,a,s){return a===void 0&&(a={}),s===void 0&&(s={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){return[2,this.performRequest("patch",n,{queryParameters:s,bodyParameters:a})]})})},p.prototype.getAdapter=function(){if(this.configuration.axiosAdapter){if(typeof this.configuration.axiosAdapter=="function")return this.configuration.axiosAdapter;var n=typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers";return n?l.default.getAdapter(this.configuration.axiosAdapter).bind(globalThis):l.default.getAdapter(this.configuration.axiosAdapter)}},p.prototype.performRequest=function(n,a,s){var d,f,h,y,S=s.queryParameters,b=S===void 0?null:S,A=s.bodyParameters,E=A===void 0?null:A,q=s.additionalHeaders,k=q===void 0?{}:q,C=s.abortSignal,F=C===void 0?null:C,B=s.responseType,T=B===void 0?void 0:B,H=s.skipConnectionTimeout,O=H===void 0?!1:H,x=s.enableKeepAlive,U=x===void 0?void 0:x;return e.__awaiter(this,void 0,void 0,function(){var D,$,P,g,w,R,N,M;return e.__generator(this,function(G){switch(G.label){case 0:this.configuration.validate(),D=b?.conversation_stream===!0&&n.toLowerCase()==="get",D&&(this.logger.debug("Request: Performing streaming request to ".concat(a)),!m&&typeof fetch<"u"&&(this.logger.debug("Using fetch adapter for browser streaming"),T="stream")),$=Date.now(),g=!1,this.logger.debug("Request #".concat($,": Performing ").concat(n.toUpperCase()," request: ").concat(a)),w=function(Z){var X,ee,W,se,kt,te,ce;return e.__generator(this,function(_e){switch(_e.label){case 0:if(X=R.getNextNode($),R.logger.debug("Request #".concat($,": Attempting ").concat(n.toUpperCase()," request Try #").concat(Z," to Node ").concat(X.index)),F&&F.aborted)return[2,{value:Promise.reject(new Error("Request aborted by caller."))}];ee=void 0,_e.label=1;case 1:return _e.trys.push([1,3,5,6]),W={method:n,url:R.uriFor(a,X),headers:Object.assign({},R.defaultHeaders(),k,R.additionalUserHeaders),maxContentLength:1/0,maxBodyLength:1/0,validateStatus:function(ye){return ye>0},transformResponse:[function(ye,It){var dr=ye;return It!==void 0&&typeof ye=="string"&&It["content-type"]&&It["content-type"].startsWith("application/json")&&(dr=JSON.parse(ye)),dr}]},W.adapter=D&&!m?"fetch":R.getAdapter(),O!==!0&&(W.timeout=R.connectionTimeoutSeconds*1e3),b&&Object.keys(b).length!==0&&(W.params=b),R.sendApiKeyAsQueryParam&&(W.params=W.params||{},W.params["x-typesense-api-key"]=R.apiKey),R.configuration.httpAgent?(R.logger.debug("Request #".concat($,": Using custom httpAgent")),W.httpAgent=R.configuration.httpAgent):U===!0&&(m?(R.logger.debug("Request #".concat($,": Enabling KeepAlive")),W.httpAgent=new c.Agent({keepAlive:!0})):R.logger.warn("Request #".concat($,": Cannot use custom httpAgent in a browser environment to enable keepAlive"))),R.configuration.httpsAgent?(R.logger.debug("Request #".concat($,": Using custom httpsAgent")),W.httpsAgent=R.configuration.httpsAgent):U===!0&&(m?(R.logger.debug("Request #".concat($,": Enabling keepAlive")),W.httpsAgent=new r.Agent({keepAlive:!0})):R.logger.warn("Request #".concat($,": Cannot use custom httpAgent in a browser environment to enable keepAlive"))),R.configuration.paramsSerializer&&(R.logger.debug("Request #".concat($,": Using custom paramsSerializer")),W.paramsSerializer=R.configuration.paramsSerializer),E&&(typeof E=="string"&&E.length!==0||typeof E=="object"&&Object.keys(E).length!==0)&&(W.data=E),F&&(se=l.default.CancelToken,kt=se.source(),ee=function(){g=!0,kt.cancel()},F.addEventListener("abort",ee),W.cancelToken=kt.token),D?(W.responseType="stream",m||(W.headers=e.__assign(e.__assign({},W.headers),{Accept:"text/event-stream"}))):T&&(W.responseType=T),[4,(0,l.default)(W)];case 2:if(te=_e.sent(),te.status>=1&&te.status<=499&&R.setNodeHealthcheck(X,u),R.logger.debug("Request #".concat($,": Request to Node ").concat(X.index," was made. Response Code was ").concat(te.status,".")),te.status>=200&&te.status<300)return D?[2,{value:R.handleStreamingResponse(te)}]:[2,{value:Promise.resolve(te.data)}];if(te.status<500)return[2,{value:Promise.reject(R.customErrorForResponse(te,(d=te.data)===null||d===void 0?void 0:d.message,W.data))}];throw R.customErrorForResponse(te,(f=te.data)===null||f===void 0?void 0:f.message,W.data);case 3:if(ce=_e.sent(),g||R.setNodeHealthcheck(X,v),P=ce,R.logger.warn("Request #".concat($,": Request to Node ").concat(X.index,' failed due to "').concat((h=ce?.code)!==null&&h!==void 0?h:""," ").concat(ce.message).concat(ce.response==null?"":" - "+JSON.stringify((y=ce.response)===null||y===void 0?void 0:y.data),'"')),g)return[2,{value:Promise.reject(new Error("Request aborted by caller."))}];if(D&&R.invokeOnErrorCallback(ce),Z<R.numRetriesPerRequest+1)R.logger.warn("Request #".concat($,": Sleeping for ").concat(R.retryIntervalSeconds,"s and then retrying request..."));else return R.logger.debug("Request #".concat($,": No retries left. Raising last error")),[2,{value:Promise.reject(P)}];return[4,R.timer(R.retryIntervalSeconds)];case 4:return _e.sent(),[3,6];case 5:return F&&ee&&F.removeEventListener("abort",ee),[7];case 6:return[2]}})},R=this,N=1,G.label=1;case 1:return N<=this.numRetriesPerRequest+1?[5,w(N)]:[3,4];case 2:if(M=G.sent(),typeof M=="object")return[2,M.value];G.label=3;case 3:return N++,[3,1];case 4:return this.logger.debug("Request #".concat($,": No retries left. Raising last error")),[2,Promise.reject(P)]}})})},p.prototype.processStreamingLine=function(n){if(!n.trim()||n==="data: [DONE]")return null;if(n.startsWith("data: "))return this.processDataLine(n.slice(6).trim());if(n.trim().startsWith("{"))try{var a=JSON.parse(n.trim());return a&&typeof a=="object"?(a.conversation_id||(a.conversation_id="unknown"),!a.message&&a.message!==""&&(a.message=""),a):{conversation_id:"unknown",message:JSON.stringify(a)}}catch{return{conversation_id:"unknown",message:n.trim()}}return{conversation_id:"unknown",message:n.trim()}},p.prototype.processDataLine=function(n){if(!n)return null;if(n.startsWith("{"))try{var a=JSON.parse(n);return a&&typeof a=="object"?(a.conversation_id||(a.conversation_id="unknown"),!a.message&&a.message!==""&&(a.message=""),a):{conversation_id:"unknown",message:JSON.stringify(a)}}catch{return{conversation_id:"unknown",message:n}}return{conversation_id:"unknown",message:n}},p.prototype.handleStreamingResponse=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return this.logger.debug("Handling streaming response. Environment: ".concat(m?"Node.js":"Browser")),m&&n.data?[2,this.handleNodeStreaming(n)]:m?(this.logger.debug("Processing non-streaming response"),this.invokeOnCompleteCallback(n.data),[2,Promise.resolve(n.data)]):[2,this.handleBrowserStreaming(n)]})})},p.prototype.handleNodeStreaming=function(n){var a=this;return this.logger.debug("Processing Node.js stream"),new Promise(function(s,d){var f=n.data,h=[],y="";f.on("data",function(S){var b;try{var A=S.toString();y+=A;var E=y.split(`
`);y=(b=E.pop())!==null&&b!==void 0?b:"",a.processStreamLines(E,h)}catch(q){d(q)}}),f.on("end",function(){if(y.trim().length>0){var S=y.split(`
`);a.processStreamLines(S,h)}a.finalizeStreamResult(h,s,n)}),f.on("error",function(S){a.logger.error("Stream error: ".concat(S)),a.invokeOnErrorCallback(S),d(S)})})},p.prototype.handleBrowserStreaming=function(n){var a=this;return this.logger.debug("Processing browser stream"),new Promise(function(s,d){return e.__awaiter(a,void 0,void 0,function(){return e.__generator(this,function(f){try{return n.data&&typeof n.data.getReader=="function"?[2,this.handleBrowserReadableStream(n.data,s,d,n)]:typeof n.data=="string"?[2,this.handleBrowserStringResponse(n.data,s,n)]:typeof n.data=="object"&&n.data!==null?(this.logger.debug("No stream found, but data object is available"),this.invokeOnCompleteCallback(n.data),[2,s(n.data)]):(this.logger.error("No usable data found in response"),[2,d(new Error("No usable data found in response"))])}catch(h){this.logger.error("Error processing streaming response: ".concat(h)),this.invokeOnErrorCallback(h),d(h)}return[2]})})})},p.prototype.handleBrowserReadableStream=function(n,a,s,d){return e.__awaiter(this,void 0,void 0,function(){var f,h,y,S,b,A,E,q,k,C;return e.__generator(this,function(F){switch(F.label){case 0:this.logger.debug("Found ReadableStream in response.data"),f=n.getReader(),h=[],y="",F.label=1;case 1:F.trys.push([1,5,,6]),F.label=2;case 2:return[4,f.read()];case 3:return S=F.sent(),b=S.done,A=S.value,b?(this.logger.debug("Stream reading complete"),y.trim()&&(E=y.split(`
`),this.processStreamLines(E,h)),[3,4]):(q=new TextDecoder().decode(A),this.logger.debug("Received chunk: ".concat(q.length," bytes")),y+=q,k=y.split(`
`),y=k.pop()||"",this.processStreamLines(k,h),[3,2]);case 4:return this.finalizeStreamResult(h,a,d),[3,6];case 5:return C=F.sent(),s(C),[3,6];case 6:return[2]}})})},p.prototype.handleBrowserStringResponse=function(n,a,s){this.logger.debug("Processing text response as stream data");var d=[],f=n.split(`
`);if(this.processStreamLines(f,d),d.length>0){var h=this.combineStreamingChunks(d);this.invokeOnCompleteCallback(h),a(h)}else this.logger.debug("No chunks processed, returning original API response"),this.invokeOnCompleteCallback(s.data),a(s.data)},p.prototype.processStreamLines=function(n,a){for(var s=0,d=n;s<d.length;s++){var f=d[s];if(f.trim()&&f!=="data: [DONE]"){var h=this.processStreamingLine(f);h!==null&&(this.invokeOnChunkCallback(h),a.push(h))}}},p.prototype.finalizeStreamResult=function(n,a,s){if(n.length>0){var d=this.combineStreamingChunks(n);this.logger.debug("Stream processing complete"),this.invokeOnCompleteCallback(d),a(d)}else this.logger.debug("No chunks processed, returning original API response"),this.invokeOnCompleteCallback(s.data),a(s.data)},p.prototype.combineStreamingChunks=function(n){if(n.length===0)return{};if(n.length===1)return n[0];var a=this.getMessageChunks(n);if(a.length>0)return this.combineMessageChunks(n,a);var s=n[n.length-1];return this.isCompleteSearchResponse(s)?s:this.attemptChunksMerge(n,s)},p.prototype.getMessageChunks=function(n){return n.filter(function(a){return typeof a=="object"&&a!==null&&"message"in a})},p.prototype.combineMessageChunks=function(n,a){this.logger.debug("Found ".concat(a.length," message chunks to combine"));var s=n[n.length-1];if(typeof s=="object"&&s!==null&&("hits"in s||"found"in s))return this.logger.debug("Last chunk appears to be a complete search response"),s;var d=a.map(function(h){return h.message}).join(""),f=n.find(function(h){return typeof h=="object"&&h!==null&&("hits"in h||"found"in h||"request_params"in h)});return f?e.__assign(e.__assign({},f),{message:d}):{message:d}},p.prototype.isCompleteSearchResponse=function(n){return typeof n=="object"&&n!==null&&Object.keys(n).length>0?"found"in n||"hits"in n||"page"in n||"search_time_ms"in n:!1},p.prototype.attemptChunksMerge=function(n,a){try{for(var s={},d=0,f=n;d<f.length;d++){var h=f[d];typeof h=="object"&&h!==null&&(s=e.__assign(e.__assign({},s),h))}if(Object.keys(s).length>0)return s}catch(y){this.logger.warn("Failed to merge chunks: ".concat(y))}return a},p.prototype.getNextNode=function(n){if(n===void 0&&(n=0),this.nearestNode!=null){if(this.logger.debug("Request #".concat(n,": Nodes Health: Node ").concat(this.nearestNode.index," is ").concat(this.nearestNode.isHealthy===!0?"Healthy":"Unhealthy")),this.nearestNode.isHealthy===!0||this.nodeDueForHealthcheck(this.nearestNode,n))return this.logger.debug("Request #".concat(n,": Updated current node to Node ").concat(this.nearestNode.index)),this.nearestNode;this.logger.debug("Request #".concat(n,": Falling back to individual nodes"))}this.logger.debug("Request #".concat(n,": Nodes Health: ").concat(this.nodes.map(function(d){return"Node ".concat(d.index," is ").concat(d.isHealthy===!0?"Healthy":"Unhealthy")}).join(" || ")));for(var a=this.nodes[0],s=0;s<=this.nodes.length;s++)if(this.currentNodeIndex=(this.currentNodeIndex+1)%this.nodes.length,a=this.nodes[this.currentNodeIndex],a.isHealthy===!0||this.nodeDueForHealthcheck(a,n))return this.logger.debug("Request #".concat(n,": Updated current node to Node ").concat(a.index)),a;return this.logger.debug("Request #".concat(n,": No healthy nodes were found. Returning the next node, Node ").concat(a.index)),a},p.prototype.nodeDueForHealthcheck=function(n,a){a===void 0&&(a=0);var s=Date.now()-n.lastAccessTimestamp>this.healthcheckIntervalSeconds*1e3;return s&&this.logger.debug("Request #".concat(a,": Node ").concat(n.index," has exceeded healtcheckIntervalSeconds of ").concat(this.healthcheckIntervalSeconds,". Adding it back into rotation.")),s},p.prototype.initializeMetadataForNodes=function(){var n=this;this.nearestNode!=null&&(this.nearestNode.index="nearestNode",this.setNodeHealthcheck(this.nearestNode,u)),this.nodes.forEach(function(a,s){a.index=s,n.setNodeHealthcheck(a,u)})},p.prototype.setNodeHealthcheck=function(n,a){n.isHealthy=a,n.lastAccessTimestamp=Date.now()},p.prototype.uriFor=function(n,a){return a.url!=null?"".concat(a.url).concat(n):"".concat(a.protocol,"://").concat(a.host,":").concat(a.port).concat(a.path).concat(n)},p.prototype.defaultHeaders=function(){var n={};return this.sendApiKeyAsQueryParam||(n[o]=this.apiKey),n["Content-Type"]="application/json",n},p.prototype.timer=function(n){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2,new Promise(function(s){return setTimeout(s,n*1e3)})]})})},p.prototype.customErrorForResponse=function(n,a,s){var d="Request failed with HTTP code ".concat(n.status);typeof a=="string"&&a.trim()!==""&&(d+=" | Server said: ".concat(a));var f=new i.default(d,s,n.status);return n.status===400?f=new t.RequestMalformed(d):n.status===401?f=new t.RequestUnauthorized(d):n.status===404?f=new t.ObjectNotFound(d):n.status===409?f=new t.ObjectAlreadyExists(d):n.status===422?f=new t.ObjectUnprocessable(d):n.status>=500&&n.status<=599?f=new t.ServerError(d):f=new t.HTTPError(d),f},p.prototype.invokeOnChunkCallback=function(n){var a;if(!((a=this.configuration.streamConfig)===null||a===void 0)&&a.onChunk)try{this.configuration.streamConfig.onChunk(n)}catch(s){this.logger.warn("Error in onChunk callback: ".concat(s))}},p.prototype.invokeOnCompleteCallback=function(n){var a;if(!((a=this.configuration.streamConfig)===null||a===void 0)&&a.onComplete)try{this.configuration.streamConfig.onComplete(n)}catch(s){this.logger.warn("Error in onComplete callback: ".concat(s))}},p.prototype.invokeOnErrorCallback=function(n){var a;if(!((a=this.configuration.streamConfig)===null||a===void 0)&&a.onError){var s=n instanceof Error?n:new Error(String(n));try{this.configuration.streamConfig.onError(s)}catch(d){this.logger.warn("Error in onError callback: ".concat(d))}}},p}();return Qe.default=_,Qe}var Ge={},Gr;function he(){if(Gr)return Ge;Gr=1,Object.defineProperty(Ge,"__esModule",{value:!0});var e=j,l="/collections",c=function(){function r(t){this.apiCall=t}return r.prototype.create=function(t,i){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.post(l,t,i)]})})},r.prototype.retrieve=function(t){return t===void 0&&(t={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(l,t)]})})},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return Ge.default=c,Ge}var Je={},Ve={},Se={},Xe={},Jr;function da(){if(Jr)return Xe;Jr=1,Object.defineProperty(Xe,"__esModule",{value:!0});var e=j,l=2*60,c=100,r=function(){function t(){this.responseCache=new Map,this.responsePromiseCache=new Map}return t.prototype.clearCache=function(){this.responseCache=new Map,this.responsePromiseCache=new Map},t.prototype.perform=function(i,o,u,v){return e.__awaiter(this,void 0,void 0,function(){var m,_,p,n,a,s,d,f,y,h,y,S,b,A,q,E,q;return e.__generator(this,function(k){switch(k.label){case 0:if(m=v.cacheResponseForSeconds,_=m===void 0?l:m,p=v.maxSize,n=p===void 0?c:p,a=_<=0||n<=0,a)return[2,o.call.apply(o,e.__spreadArray([i],u,!1))];if(s=JSON.stringify(u),d=this.responseCache.get(s),f=Date.now(),d){if(y=f-d.requestTimestamp<_*1e3,y)return this.responseCache.delete(s),this.responseCache.set(s,d),[2,Promise.resolve(d.response)];this.responseCache.delete(s)}if(h=this.responsePromiseCache.get(s),h){if(y=f-h.requestTimestamp<_*1e3,y)return this.responsePromiseCache.delete(s),this.responsePromiseCache.set(s,h),[2,h.responsePromise];this.responsePromiseCache.delete(s)}return S=o.call.apply(o,e.__spreadArray([i],u,!1)),this.responsePromiseCache.set(s,{requestTimestamp:f,responsePromise:S}),[4,S];case 1:return b=k.sent(),this.responseCache.set(s,{requestTimestamp:f,response:b}),A=this.responseCache.size>n,A&&(q=this.responseCache.keys().next().value,q&&this.responseCache.delete(q)),E=this.responsePromiseCache.size>n,E&&(q=this.responsePromiseCache.keys().next().value,q&&this.responsePromiseCache.delete(q)),[2,b]}})})},t}();return Xe.default=r,Xe}var Ce={},Re={},Vr;function $i(){return Vr||(Vr=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.arrayableParams=void 0,Re.arrayableParams={query_by:"query_by",query_by_weights:"query_by_weights",facet_by:"facet_by",group_by:"group_by",include_fields:"include_fields",exclude_fields:"exclude_fields",highlight_fields:"highlight_fields",highlight_full_fields:"highlight_full_fields",pinned_hits:"pinned_hits",hidden_hits:"hidden_hits",infix:"infix",override_tags:"override_tags",num_typos:"num_typos",prefix:"prefix",sort_by:"sort_by"}),Re}var Xr;function jt(){if(Xr)return Ce;Xr=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.normalizeArrayableParams=void 0;var e=j,l=$i();function c(i){return Object.keys(l.arrayableParams).filter(function(o){return i[o]!==void 0}).every(function(o){return t(i[o])})}function r(i){var o=e.__assign({},i),u=Object.keys(l.arrayableParams).filter(function(v){return Array.isArray(o[v])}).map(function(v){return o[v]=o[v].join(","),v});if(!u.length&&c(o))return o;if(!c(o))throw new Error("Failed to normalize arrayable params: ".concat(JSON.stringify(o)));return o}Ce.normalizeArrayableParams=r;function t(i){return!Array.isArray(i)}return Ce}var Yr;function fa(){if(Yr)return Se;Yr=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.SearchOnlyDocuments=void 0;var e=j,l=e.__importDefault(da()),c=e.__importDefault(he()),r=jt(),t="/documents",i=function(){function o(u,v,m){this.collectionName=u,this.apiCall=v,this.configuration=m,this.requestWithCache=new l.default}return o.prototype.clearCache=function(){this.requestWithCache.clearCache()},o.prototype.search=function(u,v){var m=v===void 0?{}:v,_=m.cacheSearchResultsForSeconds,p=_===void 0?this.configuration.cacheSearchResultsForSeconds:_,n=m.abortSignal,a=n===void 0?null:n;return e.__awaiter(this,void 0,void 0,function(){var s,d,f;return e.__generator(this,function(h){return s={},this.configuration.useServerSideSearchCache===!0&&(s.use_cache=!0),d=(0,r.normalizeArrayableParams)(u),f=Object.assign({},s,d),[2,this.requestWithCache.perform(this.apiCall,this.apiCall.get,[this.endpointPath("search"),f,{abortSignal:a}],{cacheResponseForSeconds:p})]})})},o.prototype.endpointPath=function(u){return"".concat(c.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.collectionName)).concat(t).concat(u===void 0?"":"/"+u)},Object.defineProperty(o,"RESOURCEPATH",{get:function(){return t},enumerable:!1,configurable:!0}),o}();return Se.SearchOnlyDocuments=i,Se}var Zr;function ha(){if(Zr)return Ve;Zr=1,Object.defineProperty(Ve,"__esModule",{value:!0});var e=j,l=Ie(),c=fa(),r=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,t=function(o){e.__extends(u,o);function u(v,m,_){return o.call(this,v,m,_)||this}return u.prototype.create=function(v,m){return m===void 0&&(m={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(_){if(!v)throw new Error("No document provided");return[2,this.apiCall.post(this.endpointPath(),v,m)]})})},u.prototype.upsert=function(v,m){return m===void 0&&(m={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(_){if(!v)throw new Error("No document provided");return[2,this.apiCall.post(this.endpointPath(),v,Object.assign({},m,{action:"upsert"}))]})})},u.prototype.update=function(v,m){return m===void 0&&(m={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(_){if(!v)throw new Error("No document provided");return m.filter_by!=null?[2,this.apiCall.patch(this.endpointPath(),v,Object.assign({},m))]:[2,this.apiCall.post(this.endpointPath(),v,Object.assign({},m,{action:"update"}))]})})},u.prototype.delete=function(v){return v===void 0&&(v={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(m){return[2,this.apiCall.delete(this.endpointPath(),v)]})})},u.prototype.createMany=function(v,m){return m===void 0&&(m={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(_){return this.configuration.logger.warn("createMany is deprecated and will be removed in a future version. Use import instead, which now takes both an array of documents or a JSONL string of documents"),[2,this.import(v,m)]})})},u.prototype.import=function(v,m){return m===void 0&&(m={}),e.__awaiter(this,void 0,void 0,function(){var _,p,n,a;return e.__generator(this,function(s){switch(s.label){case 0:if(Array.isArray(v)){if(v.length===0)throw new l.RequestMalformed("No documents provided");try{_=v.map(function(d){return JSON.stringify(d)}).join(`
`)}catch(d){throw d instanceof RangeError&&d.message.includes("Too many properties to enumerate")?new Error("".concat(d,`
          It looks like you have reached a Node.js limit that restricts the number of keys in an Object: https://stackoverflow.com/questions/9282869/are-there-limits-to-the-number-of-properties-in-a-javascript-object

         Please try reducing the number of keys in your document, or using CURL to import your data.
          `)):new Error(d)}}else if(_=v,i(_))throw new l.RequestMalformed("No documents provided");return[4,this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:m,bodyParameters:_,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0,enableKeepAlive:!!r})];case 1:if(p=s.sent(),Array.isArray(v)){if(n=p.split(`
`).map(function(d){return JSON.parse(d)}),a=n.filter(function(d){return d.success===!1}),a.length>0)throw new l.ImportError("".concat(n.length-a.length," documents imported successfully, ").concat(a.length," documents failed during import. Use `error.importResults` from the raised exception to get a detailed error reason for each document."),n,{documentsInJSONLFormat:_,options:m,failedItems:a,successCount:n.length-a.length});return[2,n]}else return[2,p]}})})},u.prototype.importStream=function(v,m){return m===void 0&&(m={}),e.__awaiter(this,void 0,void 0,function(){var _,p,n;return e.__generator(this,function(a){switch(a.label){case 0:return[4,this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:m,bodyParameters:v,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0,enableKeepAlive:!!r})];case 1:if(_=a.sent(),p=_.split(`
`).map(function(s){return JSON.parse(s)}),n=p.filter(function(s){return s.success===!1}),n.length>0)throw new l.ImportError("".concat(p.length-n.length," documents imported successfully, ").concat(n.length," documents failed during import. Use `error.importResults` from the raised exception to get a detailed error reason for each document."),p,{documentsInJSONLFormat:v,options:m,failedItems:n,successCount:p.length-n.length});return[2,p]}})})},u.prototype.export=function(v){return v===void 0&&(v={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(m){return[2,this.apiCall.get(this.endpointPath("export"),v)]})})},u.prototype.exportStream=function(v){return v===void 0&&(v={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(m){return[2,this.apiCall.get(this.endpointPath("export"),v,{responseType:"stream"})]})})},u}(c.SearchOnlyDocuments);Ve.default=t;function i(o){return o==null||o===""||o.length===0}return Ve}var Ye={},en;function pa(){if(en)return Ye;en=1,Object.defineProperty(Ye,"__esModule",{value:!0});var e=j,l=e.__importDefault(he()),c="/overrides",r=function(){function t(i,o){this.collectionName=i,this.apiCall=o}return t.prototype.upsert=function(i,o){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(u){return[2,this.apiCall.put(this.endpointPath(i),o)]})})},t.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(this.endpointPath())]})})},t.prototype.endpointPath=function(i){return"".concat(l.default.RESOURCEPATH,"/").concat(this.collectionName).concat(t.RESOURCEPATH).concat(i===void 0?"":"/"+encodeURIComponent(i))},Object.defineProperty(t,"RESOURCEPATH",{get:function(){return c},enumerable:!1,configurable:!0}),t}();return Ye.default=r,Ye}var Ze={},tn;function Li(){if(tn)return Ze;tn=1,Object.defineProperty(Ze,"__esModule",{value:!0});var e=j,l=e.__importDefault(he()),c=e.__importDefault(pa()),r=function(){function t(i,o,u){this.collectionName=i,this.overrideId=o,this.apiCall=u}return t.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(this.endpointPath())]})})},t.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.delete(this.endpointPath())]})})},t.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.collectionName)).concat(c.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.overrideId))},t}();return Ze.default=r,Ze}var et={},rn;function va(){if(rn)return et;rn=1,Object.defineProperty(et,"__esModule",{value:!0});var e=j,l=e.__importDefault(he()),c="/synonyms",r=function(){function t(i,o){this.collectionName=i,this.apiCall=o}return t.prototype.upsert=function(i,o){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(u){return[2,this.apiCall.put(this.endpointPath(i),o)]})})},t.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(this.endpointPath())]})})},t.prototype.endpointPath=function(i){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.collectionName)).concat(t.RESOURCEPATH).concat(i===void 0?"":"/"+encodeURIComponent(i))},Object.defineProperty(t,"RESOURCEPATH",{get:function(){return c},enumerable:!1,configurable:!0}),t}();return et.default=r,et}var tt={},nn;function Bi(){if(nn)return tt;nn=1,Object.defineProperty(tt,"__esModule",{value:!0});var e=j,l=e.__importDefault(he()),c=e.__importDefault(va()),r=function(){function t(i,o,u){this.collectionName=i,this.synonymId=o,this.apiCall=u}return t.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(this.endpointPath())]})})},t.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.delete(this.endpointPath())]})})},t.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.collectionName)).concat(c.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.synonymId))},t}();return tt.default=r,tt}var Pe={},an;function Wi(){if(an)return Pe;an=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.Document=void 0;var e=j,l=e.__importDefault(he()),c=e.__importDefault(ha()),r=function(){function t(i,o,u){this.collectionName=i,this.documentId=o,this.apiCall=u}return t.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(this.endpointPath())]})})},t.prototype.delete=function(i){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.delete(this.endpointPath(),i)]})})},t.prototype.update=function(i,o){return o===void 0&&(o={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(u){return[2,this.apiCall.patch(this.endpointPath(),i,o)]})})},t.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.collectionName)).concat(c.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.documentId))},t}();return Pe.Document=r,Pe}var on;function Ki(){if(on)return Je;on=1,Object.defineProperty(Je,"__esModule",{value:!0});var e=j,l=e.__importDefault(he()),c=e.__importDefault(ha()),r=Ie(),t=e.__importDefault(pa()),i=e.__importDefault(Li()),o=e.__importDefault(va()),u=e.__importDefault(Bi()),v=Wi(),m=function(){function _(p,n,a){this.name=p,this.apiCall=n,this.configuration=a,this.individualDocuments={},this.individualOverrides={},this.individualSynonyms={},this.name=p,this.apiCall=n,this.configuration=a,this._documents=new c.default(this.name,this.apiCall,this.configuration),this._overrides=new t.default(this.name,this.apiCall),this._synonyms=new o.default(this.name,this.apiCall)}return _.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(p){return[2,this.apiCall.get(this.endpointPath())]})})},_.prototype.update=function(p){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(n){return[2,this.apiCall.patch(this.endpointPath(),p)]})})},_.prototype.delete=function(p){return p===void 0&&(p={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(n){return[2,this.apiCall.delete(this.endpointPath(),p)]})})},_.prototype.exists=function(){return e.__awaiter(this,void 0,void 0,function(){var p;return e.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.retrieve()];case 1:return n.sent(),[2,!0];case 2:if(p=n.sent(),p instanceof r.ObjectNotFound)return[2,!1];throw p;case 3:return[2]}})})},_.prototype.documents=function(p){return p?(this.individualDocuments[p]===void 0&&(this.individualDocuments[p]=new v.Document(this.name,p,this.apiCall)),this.individualDocuments[p]):this._documents},_.prototype.overrides=function(p){return p===void 0?this._overrides:(this.individualOverrides[p]===void 0&&(this.individualOverrides[p]=new i.default(this.name,p,this.apiCall)),this.individualOverrides[p])},_.prototype.synonyms=function(p){return p===void 0?this._synonyms:(this.individualSynonyms[p]===void 0&&(this.individualSynonyms[p]=new u.default(this.name,p,this.apiCall)),this.individualSynonyms[p])},_.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.name))},_}();return Je.default=m,Je}var rt={},sn;function _a(){if(sn)return rt;sn=1,Object.defineProperty(rt,"__esModule",{value:!0});var e=j,l="/aliases",c=function(){function r(t){this.apiCall=t}return r.prototype.upsert=function(t,i){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.put(this.endpointPath(t),i)]})})},r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(l)]})})},r.prototype.endpointPath=function(t){return"".concat(r.RESOURCEPATH,"/").concat(encodeURIComponent(t))},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return rt.default=c,rt}var nt={},un;function Qi(){if(un)return nt;un=1,Object.defineProperty(nt,"__esModule",{value:!0});var e=j,l=e.__importDefault(_a()),c=function(){function r(t,i){this.name=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.name))},r}();return nt.default=c,nt}var at={},ln;function ma(){if(ln)return at;ln=1,Object.defineProperty(at,"__esModule",{value:!0});var e=j,l=ur,c=jt(),r="/keys",t=function(){function i(o){this.apiCall=o,this.apiCall=o}return i.prototype.create=function(o){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(u){return[2,this.apiCall.post(i.RESOURCEPATH,o)]})})},i.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.get(r)]})})},i.prototype.generateScopedSearchKey=function(o,u){var v=(0,c.normalizeArrayableParams)(u),m=JSON.stringify(v),_=Buffer.from((0,l.createHmac)("sha256",o).update(m).digest("base64")),p=o.substr(0,4),n="".concat(_).concat(p).concat(m);return Buffer.from(n).toString("base64")},Object.defineProperty(i,"RESOURCEPATH",{get:function(){return r},enumerable:!1,configurable:!0}),i}();return at.default=t,at}var it={},cn;function Gi(){if(cn)return it;cn=1,Object.defineProperty(it,"__esModule",{value:!0});var e=j,l=e.__importDefault(ma()),c=function(){function r(t,i){this.id=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.id))},r}();return it.default=c,it}var ot={},dn;function Ji(){if(dn)return ot;dn=1,Object.defineProperty(ot,"__esModule",{value:!0});var e=j,l="/debug",c=function(){function r(t){this.apiCall=t}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(l)]})})},r}();return ot.default=c,ot}var st={},fn;function Vi(){if(fn)return st;fn=1,Object.defineProperty(st,"__esModule",{value:!0});var e=j,l="/metrics.json",c=function(){function r(t){this.apiCall=t}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(l)]})})},r}();return st.default=c,st}var ut={},hn;function Xi(){if(hn)return ut;hn=1,Object.defineProperty(ut,"__esModule",{value:!0});var e=j,l="/stats.json",c=function(){function r(t){this.apiCall=t}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(l)]})})},r}();return ut.default=c,ut}var lt={},pn;function Yi(){if(pn)return lt;pn=1,Object.defineProperty(lt,"__esModule",{value:!0});var e=j,l="/health",c=function(){function r(t){this.apiCall=t}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(l)]})})},r}();return lt.default=c,lt}var ct={},vn;function Zi(){if(vn)return ct;vn=1,Object.defineProperty(ct,"__esModule",{value:!0});var e=j,l="/operations",c=function(){function r(t){this.apiCall=t}return r.prototype.perform=function(t,i){return i===void 0&&(i={}),e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.post("".concat(l,"/").concat(t),{},i)]})})},r}();return ct.default=c,ct}var dt={},_n;function ya(){if(_n)return dt;_n=1,Object.defineProperty(dt,"__esModule",{value:!0});var e=j,l=e.__importDefault(da()),c=jt(),r="/multi_search",t=function(){function i(o,u,v){v===void 0&&(v=!1),this.apiCall=o,this.configuration=u,this.useTextContentType=v,this.requestWithCache=new l.default}return i.prototype.clearCache=function(){this.requestWithCache.clearCache()},i.prototype.perform=function(o,u,v){u===void 0&&(u={});var m=v===void 0?{}:v,_=m.cacheSearchResultsForSeconds,p=_===void 0?this.configuration.cacheSearchResultsForSeconds:_;return e.__awaiter(this,void 0,void 0,function(){var n,a,s,d,f;return e.__generator(this,function(h){return n={},this.useTextContentType&&(n["content-type"]="text/plain"),a={},this.configuration.useServerSideSearchCache===!0&&(a.use_cache=!0),s=e.__assign(e.__assign({},u),a),d=e.__assign(e.__assign({},o),{searches:o.searches.map(c.normalizeArrayableParams)}),f=(0,c.normalizeArrayableParams)(s),[2,this.requestWithCache.perform(this.apiCall,this.apiCall.post,[r,d,f,n],{cacheResponseForSeconds:p})]})})},i}();return dt.default=t,dt}var ft={},mn;function ga(){if(mn)return ft;mn=1,Object.defineProperty(ft,"__esModule",{value:!0});var e=j,l=jt(),c="/presets",r=function(){function t(i){this.apiCall=i}return t.prototype.upsert=function(i,o){return e.__awaiter(this,void 0,void 0,function(){var u,v;return e.__generator(this,function(m){return typeof o.value=="object"&&"searches"in o.value?(u=o.value.searches.map(function(_){return(0,l.normalizeArrayableParams)(_)}),[2,this.apiCall.put(this.endpointPath(i),{value:{searches:u}})]):(v=(0,l.normalizeArrayableParams)(o.value),[2,this.apiCall.put(this.endpointPath(i),{value:v})])})})},t.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.get(this.endpointPath())]})})},t.prototype.endpointPath=function(i){return"".concat(t.RESOURCEPATH).concat(i===void 0?"":"/"+encodeURIComponent(i))},Object.defineProperty(t,"RESOURCEPATH",{get:function(){return c},enumerable:!1,configurable:!0}),t}();return ft.default=r,ft}var ht={},yn;function eo(){if(yn)return ht;yn=1,Object.defineProperty(ht,"__esModule",{value:!0});var e=j,l=e.__importDefault(ga()),c=function(){function r(t,i){this.presetId=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.presetId))},r}();return ht.default=c,ht}var pt={},vt={},gn;function ba(){if(gn)return vt;gn=1,Object.defineProperty(vt,"__esModule",{value:!0});var e=j,l="/analytics/rules",c=function(){function r(t){this.apiCall=t,this.apiCall=t}return r.prototype.upsert=function(t,i){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.put(this.endpointPath(t),i)]})})},r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.endpointPath=function(t){return"".concat(r.RESOURCEPATH).concat(t===void 0?"":"/"+encodeURIComponent(t))},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return vt.default=c,vt}var _t={},bn;function to(){if(bn)return _t;bn=1,Object.defineProperty(_t,"__esModule",{value:!0});var e=j,l=e.__importDefault(ba()),c=function(){function r(t,i){this.name=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.name))},r}();return _t.default=c,_t}var mt={},Sn;function ro(){if(Sn)return mt;Sn=1,Object.defineProperty(mt,"__esModule",{value:!0});var e=j,l="/analytics/events",c=function(){function r(t){this.apiCall=t,this.apiCall=t}return r.prototype.create=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.post(this.endpointPath(),t)]})})},r.prototype.endpointPath=function(t){return"".concat(r.RESOURCEPATH).concat(t===void 0?"":"/"+encodeURIComponent(t))},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return mt.default=c,mt}var Cn;function no(){if(Cn)return pt;Cn=1,Object.defineProperty(pt,"__esModule",{value:!0});var e=j,l=e.__importDefault(ba()),c=e.__importDefault(to()),r=e.__importDefault(ro()),t="/analytics",i=function(){function o(u){this.apiCall=u,this.individualAnalyticsRules={},this.apiCall=u,this._analyticsRules=new l.default(this.apiCall),this._analyticsEvents=new r.default(this.apiCall)}return o.prototype.rules=function(u){return u===void 0?this._analyticsRules:(this.individualAnalyticsRules[u]===void 0&&(this.individualAnalyticsRules[u]=new c.default(u,this.apiCall)),this.individualAnalyticsRules[u])},o.prototype.events=function(){return this._analyticsEvents},Object.defineProperty(o,"RESOURCEPATH",{get:function(){return t},enumerable:!1,configurable:!0}),o}();return pt.default=i,pt}var yt={},Rn;function Sa(){if(Rn)return yt;Rn=1,Object.defineProperty(yt,"__esModule",{value:!0});var e=j,l="/stopwords",c=function(){function r(t){this.apiCall=t}return r.prototype.upsert=function(t,i){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.put(this.endpointPath(t),i)]})})},r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.endpointPath=function(t){return"".concat(r.RESOURCEPATH).concat(t===void 0?"":"/"+encodeURIComponent(t))},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return yt.default=c,yt}var gt={},Pn;function ao(){if(Pn)return gt;Pn=1,Object.defineProperty(gt,"__esModule",{value:!0});var e=j,l=e.__importDefault(Sa()),c=function(){function r(t,i){this.stopwordId=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.stopwordId))},r}();return gt.default=c,gt}var bt={},St={},wn;function Ca(){if(wn)return St;wn=1,Object.defineProperty(St,"__esModule",{value:!0});var e=j,l="/conversations/models",c=function(){function r(t){this.apiCall=t,this.apiCall=t}return r.prototype.create=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.post(this.endpointPath(),t)]})})},r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.endpointPath=function(t){return"".concat(r.RESOURCEPATH).concat(t===void 0?"":"/"+encodeURIComponent(t))},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return St.default=c,St}var Ct={},On;function io(){if(On)return Ct;On=1,Object.defineProperty(Ct,"__esModule",{value:!0});var e=j,l=e.__importDefault(Ca()),c=function(){function r(t,i){this.id=t,this.apiCall=i}return r.prototype.update=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.put(this.endpointPath(),t)]})})},r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.id))},r}();return Ct.default=c,Ct}var An;function Ra(){if(An)return bt;An=1,Object.defineProperty(bt,"__esModule",{value:!0});var e=j,l=e.__importDefault(Ca()),c=e.__importDefault(io()),r="/conversations",t=function(){function i(o){this.apiCall=o,this.individualConversationModels={},this.apiCall=o,this._conversationsModels=new l.default(this.apiCall)}return i.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(o){return[2,this.apiCall.get(r)]})})},i.prototype.models=function(o){return o===void 0?this._conversationsModels:(this.individualConversationModels[o]===void 0&&(this.individualConversationModels[o]=new c.default(o,this.apiCall)),this.individualConversationModels[o])},Object.defineProperty(i,"RESOURCEPATH",{get:function(){return r},enumerable:!1,configurable:!0}),i}();return bt.default=t,bt}var Rt={},En;function oo(){if(En)return Rt;En=1,Object.defineProperty(Rt,"__esModule",{value:!0});var e=j,l=e.__importDefault(Ra()),c=function(){function r(t,i){this.id=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.update=function(t){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(i){return[2,this.apiCall.put(this.endpointPath(),t)]})})},r.prototype.delete=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.delete(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.id))},r}();return Rt.default=c,Rt}var Pt={},wt={},qn;function Pa(){if(qn)return wt;qn=1,Object.defineProperty(wt,"__esModule",{value:!0});var e=j,l="/stemming/dictionaries",c=function(){function r(t){this.apiCall=t,this.apiCall=t}return r.prototype.upsert=function(t,i){return e.__awaiter(this,void 0,void 0,function(){var o,u;return e.__generator(this,function(v){switch(v.label){case 0:return o=Array.isArray(i)?i.map(function(m){return JSON.stringify(m)}).join(`
`):i,[4,this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:{id:t},bodyParameters:o,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0})];case 1:return u=v.sent(),[2,Array.isArray(i)?u.split(`
`).map(function(m){return JSON.parse(m)}):u]}})})},r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.endpointPath=function(t){return t===void 0?"".concat(r.RESOURCEPATH):"".concat(r.RESOURCEPATH,"/").concat(encodeURIComponent(t))},Object.defineProperty(r,"RESOURCEPATH",{get:function(){return l},enumerable:!1,configurable:!0}),r}();return wt.default=c,wt}var Ot={},Tn;function so(){if(Tn)return Ot;Tn=1,Object.defineProperty(Ot,"__esModule",{value:!0});var e=j,l=e.__importDefault(Pa()),c=function(){function r(t,i){this.id=t,this.apiCall=i}return r.prototype.retrieve=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(t){return[2,this.apiCall.get(this.endpointPath())]})})},r.prototype.endpointPath=function(){return"".concat(l.default.RESOURCEPATH,"/").concat(encodeURIComponent(this.id))},r}();return Ot.default=c,Ot}var xn;function uo(){if(xn)return Pt;xn=1,Object.defineProperty(Pt,"__esModule",{value:!0});var e=j,l=e.__importDefault(Pa()),c=e.__importDefault(so()),r="/stemming",t=function(){function i(o){this.apiCall=o,this.individualStemmingDictionaries={},this.apiCall=o,this._stemmingDictionaries=new l.default(this.apiCall)}return i.prototype.dictionaries=function(o){return o===void 0?this._stemmingDictionaries:(this.individualStemmingDictionaries[o]===void 0&&(this.individualStemmingDictionaries[o]=new c.default(o,this.apiCall)),this.individualStemmingDictionaries[o])},Object.defineProperty(i,"RESOURCEPATH",{get:function(){return r},enumerable:!1,configurable:!0}),i}();return Pt.default=t,Pt}var jn;function lo(){if(jn)return Me;jn=1,Object.defineProperty(Me,"__esModule",{value:!0});var e=j,l=e.__importDefault(la()),c=e.__importDefault(ca()),r=e.__importDefault(he()),t=e.__importDefault(Ki()),i=e.__importDefault(_a()),o=e.__importDefault(Qi()),u=e.__importDefault(ma()),v=e.__importDefault(Gi()),m=e.__importDefault(Ji()),_=e.__importDefault(Vi()),p=e.__importDefault(Xi()),n=e.__importDefault(Yi()),a=e.__importDefault(Zi()),s=e.__importDefault(ya()),d=e.__importDefault(ga()),f=e.__importDefault(eo()),h=e.__importDefault(no()),y=e.__importDefault(Sa()),S=e.__importDefault(ao()),b=e.__importDefault(Ra()),A=e.__importDefault(oo()),E=e.__importDefault(uo()),q=function(){function k(C){var F;C.sendApiKeyAsQueryParam=(F=C.sendApiKeyAsQueryParam)!==null&&F!==void 0?F:!1,this.configuration=new l.default(C),this.apiCall=new c.default(this.configuration),this.debug=new m.default(this.apiCall),this.metrics=new _.default(this.apiCall),this.stats=new p.default(this.apiCall),this.health=new n.default(this.apiCall),this.operations=new a.default(this.apiCall),this.multiSearch=new s.default(this.apiCall,this.configuration),this._collections=new r.default(this.apiCall),this.individualCollections={},this._aliases=new i.default(this.apiCall),this.individualAliases={},this._keys=new u.default(this.apiCall),this.individualKeys={},this._presets=new d.default(this.apiCall),this.individualPresets={},this._stopwords=new y.default(this.apiCall),this.individualStopwords={},this.analytics=new h.default(this.apiCall),this.stemming=new E.default(this.apiCall),this._conversations=new b.default(this.apiCall),this.individualConversations={}}return k.prototype.collections=function(C){return C===void 0?this._collections:(this.individualCollections[C]===void 0&&(this.individualCollections[C]=new t.default(C,this.apiCall,this.configuration)),this.individualCollections[C])},k.prototype.aliases=function(C){return C===void 0?this._aliases:(this.individualAliases[C]===void 0&&(this.individualAliases[C]=new o.default(C,this.apiCall)),this.individualAliases[C])},k.prototype.keys=function(C){return C===void 0?this._keys:(this.individualKeys[C]===void 0&&(this.individualKeys[C]=new v.default(C,this.apiCall)),this.individualKeys[C])},k.prototype.presets=function(C){return C===void 0?this._presets:(this.individualPresets[C]===void 0&&(this.individualPresets[C]=new f.default(C,this.apiCall)),this.individualPresets[C])},k.prototype.stopwords=function(C){return C===void 0?this._stopwords:(this.individualStopwords[C]===void 0&&(this.individualStopwords[C]=new S.default(C,this.apiCall)),this.individualStopwords[C])},k.prototype.conversations=function(C){return C===void 0?this._conversations:(this.individualConversations[C]===void 0&&(this.individualConversations[C]=new A.default(C,this.apiCall)),this.individualConversations[C])},k}();return Me.default=q,Me}var At={},we={},kn;function co(){if(kn)return we;kn=1,Object.defineProperty(we,"__esModule",{value:!0}),we.SearchOnlyCollection=void 0;var e=fa(),l=function(){function c(r,t,i){this.name=r,this.apiCall=t,this.configuration=i,this._documents=new e.SearchOnlyDocuments(this.name,this.apiCall,this.configuration)}return c.prototype.documents=function(){return this._documents},c}();return we.SearchOnlyCollection=l,we}var In;function fo(){if(In)return At;In=1,Object.defineProperty(At,"__esModule",{value:!0});var e=j,l=e.__importDefault(la()),c=e.__importDefault(ca()),r=e.__importDefault(ya()),t=co(),i=function(){function o(u){var v;u.sendApiKeyAsQueryParam=(v=u.sendApiKeyAsQueryParam)!==null&&v!==void 0?v:!0,u.sendApiKeyAsQueryParam===!0&&(u.apiKey||"").length>2e3&&(console.warn("[typesense] API Key is longer than 2000 characters which is over the allowed limit, so disabling sending it as a query parameter."),u.sendApiKeyAsQueryParam=!1),this.configuration=new l.default(u),this.apiCall=new c.default(this.configuration),this.multiSearch=new r.default(this.apiCall,this.configuration,!0),this.individualCollections={}}return o.prototype.clearCache=function(){this.multiSearch.clearCache(),Object.entries(this.individualCollections).forEach(function(u){u[0];var v=u[1];v.documents().clearCache()})},o.prototype.collections=function(u){if(u)return this.individualCollections[u]===void 0&&(this.individualCollections[u]=new t.SearchOnlyCollection(u,this.apiCall,this.configuration)),this.individualCollections[u];throw new Error("Typesense.SearchClient only supports search operations, so the collectionName that needs to be searched must be specified. Use Typesense.Client if you need to access the collection object.")},o}();return At.default=i,At}var Mn;function ho(){if(Mn)return ue;Mn=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.Errors=ue.SearchClient=ue.Client=void 0;var e=j,l=e.__importDefault(lo());ue.Client=l.default;var c=e.__importDefault(fo());ue.SearchClient=c.default;var r=e.__importStar(Ie());return ue.Errors=r,ue.default={Client:l.default,SearchClient:c.default,Errors:r},ue}var Oe={},Gt={exports:{}},Jt={exports:{}},Nn;function po(){return Nn||(Nn=1,function(e){function l(c,r){if(c==null)return{};var t={};for(var i in c)if({}.hasOwnProperty.call(c,i)){if(r.indexOf(i)!==-1)continue;t[i]=c[i]}return t}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(Jt)),Jt.exports}var Hn;function vo(){return Hn||(Hn=1,function(e){var l=po();function c(r,t){if(r==null)return{};var i,o,u=l(r,t);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(o=0;o<v.length;o++)i=v[o],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(r,i)&&(u[i]=r[i])}return u}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Gt)),Gt.exports}var Vt={exports:{}},Xt={exports:{}},Dn;function _o(){return Dn||(Dn=1,function(e){function l(c){if(Array.isArray(c))return c}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(Xt)),Xt.exports}var Yt={exports:{}},Fn;function mo(){return Fn||(Fn=1,function(e){function l(c,r){var t=c==null?null:typeof Symbol<"u"&&c[Symbol.iterator]||c["@@iterator"];if(t!=null){var i,o,u,v,m=[],_=!0,p=!1;try{if(u=(t=t.call(c)).next,r===0){if(Object(t)!==t)return;_=!1}else for(;!(_=(i=u.call(t)).done)&&(m.push(i.value),m.length!==r);_=!0);}catch(n){p=!0,o=n}finally{try{if(!_&&t.return!=null&&(v=t.return(),Object(v)!==v))return}finally{if(p)throw o}}return m}}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(Yt)),Yt.exports}var Zt={exports:{}},er={exports:{}},Un;function wa(){return Un||(Un=1,function(e){function l(c,r){(r==null||r>c.length)&&(r=c.length);for(var t=0,i=Array(r);t<r;t++)i[t]=c[t];return i}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(er)),er.exports}var zn;function Oa(){return zn||(zn=1,function(e){var l=wa();function c(r,t){if(r){if(typeof r=="string")return l(r,t);var i={}.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(r,t):void 0}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Zt)),Zt.exports}var tr={exports:{}},$n;function yo(){return $n||($n=1,function(e){function l(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(tr)),tr.exports}var Ln;function Aa(){return Ln||(Ln=1,function(e){var l=_o(),c=mo(),r=Oa(),t=yo();function i(o,u){return l(o)||c(o,u)||r(o,u)||t()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(Vt)),Vt.exports}var Bn;function go(){if(Bn)return Oe;Bn=1;var e=xe();Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.SearchRequestAdapter=void 0;var l=e(oa()),c=e(vo()),r=e(sa()),t=e(Aa()),i=e(je()),o=e(ke()),u=["q","conversation","conversation_id","conversation_model_id"];return Oe.SearchRequestAdapter=function(){function v(m,_,p){(0,i.default)(this,v),this.instantsearchRequests=m,this.typesenseClient=_,this.configuration=p,this.additionalSearchParameters=p.additionalSearchParameters,this.collectionSpecificSearchParameters=p.collectionSpecificSearchParameters}return(0,o.default)(v,[{key:"_shouldUseExactMatchForField",value:function(_,p){var n,a;return!(((n=this.configuration.collectionSpecificFilterByOptions)===null||n===void 0||(n=n[p])===null||n===void 0||(n=n[_])===null||n===void 0?void 0:n.exactMatch)===!1||((a=this.configuration.filterByOptions)===null||a===void 0||(a=a[_])===null||a===void 0?void 0:a.exactMatch)===!1)}},{key:"_adaptFacetFilters",value:function(_,p){var n=this,a="";if(!_)return a;var s=_.map(function(d){if(Array.isArray(d)){var f={};d.forEach(function(D){var $=n._parseFacetFilter(D),P=$.fieldName,g=$.fieldValue;f[P]=f[P]||[],f[P].push(g)}),Object.keys(f).length>1&&console.error("[Typesense-Instantsearch-Adapter] Typesense does not support cross-field ORs at the moment. The adapter could not OR values between these fields: ".concat(Object.keys(f).join(",")));var h=Object.keys(f)[0],y=f[h],S=y.reduce(function(D,$){return $.startsWith("-")&&!n._isNumber($)?D[0].push($.substring(1)):D[1].push($),D},[[],[]]),b=(0,t.default)(S,2),A=b[0],E=b[1],q=[];if(E.length>0){var k=n._shouldUseExactMatchForField(h,p)?":=":":";q.push("".concat(h).concat(k,"[").concat(E.map(function(D){return n._escapeFacetValue(D)}).join(","),"]"))}if(A.length>0){var C=n._shouldUseExactMatchForField(h,p)?":!=":":!";q.push("".concat(h).concat(C,"[").concat(A.map(function(D){return n._escapeFacetValue(D)}).join(","),"]"))}var F=q.filter(function(D){return D}).join(" && ");return F}else{var B=n._parseFacetFilter(d),T=B.fieldName,H=B.fieldValue,O;if(H.startsWith("-")&&!n._isNumber(H)){var x=n._shouldUseExactMatchForField(T,p)?":!=":":!";O="".concat(T).concat(x,"[").concat(n._escapeFacetValue(H.substring(1)),"]")}else{var U=n._shouldUseExactMatchForField(T,p)?":=":":";O="".concat(T).concat(U,"[").concat(n._escapeFacetValue(H),"]")}return O}});return a=s.join(" && "),a}},{key:"_parseFacetFilter",value:function(_){var p,n,a,s,d;if(((p=this.configuration.facetableFieldsWithSpecialCharacters)===null||p===void 0?void 0:p.length)>0){var f=this.configuration.facetableFieldsWithSpecialCharacters.flat().map(function(h){return h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(n=new RegExp("^(".concat(f.join("|"),"):(.*)$")),a=_.match(n),a!=null)return s="".concat(a[1]),d="".concat(a[2]),{fieldName:s,fieldValue:d}}return n=this.constructor.DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX,a=_.match(n),a==null?console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a facet filter `".concat(_,"` with the Regex `").concat(n,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter.")):(s="".concat(a[1]).concat(a[2]),d="".concat(a[3])),{fieldName:s,fieldValue:d}}},{key:"_escapeFacetValue",value:function(_){return typeof _=="boolean"||_==="true"||_==="false"||this._isNumber(_)?_:"`".concat(_,"`")}},{key:"_isNumber",value:function(_){return Number.isInteger(_%1)||!!(_%1)}},{key:"_adaptNumericFilters",value:function(_){var p=this,n="";if(!_)return n;var a={};_.forEach(function(d){var f=p._parseNumericFilter(d),h=f.fieldName,y=f.operator,S=f.fieldValue;a[h]=a[h]||{},a[h][y]=S});var s=[];return Object.keys(a).forEach(function(d){a[d]["<="]!=null&&a[d][">="]!=null?s.push("".concat(d,":=[").concat(a[d][">="],"..").concat(a[d]["<="],"]")):a[d]["<="]!=null?s.push("".concat(d,":<=").concat(a[d]["<="])):a[d][">="]!=null?s.push("".concat(d,":>=").concat(a[d][">="])):a[d]["="]!=null?s.push("".concat(d,":=").concat(a[d]["="])):console.warn("[Typesense-Instantsearch-Adapter] Unsupported operator found ".concat(JSON.stringify(a[d])))}),n=s.join(" && "),n}},{key:"_parseNumericFilter",value:function(_){var p,n,a,s,d,f;if(((p=this.configuration.facetableFieldsWithSpecialCharacters)===null||p===void 0?void 0:p.length)>0){var h=this.configuration.facetableFieldsWithSpecialCharacters.map(function(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(n=new RegExp("^(".concat(h.join("|"),")(<=|>=|>|<|=)(.*)$")),a=_.match(n),a!=null){var y=a,S=(0,t.default)(y,4);return s=S[1],d=S[2],f=S[3],{fieldName:s,operator:d,fieldValue:f}}}if(n=this.constructor.DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX,a=_.match(n),a==null)console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a numeric filter `".concat(_,"` with the Regex `").concat(n,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter."));else{var b=a,A=(0,t.default)(b,4);s=A[1],d=A[2],f=A[3]}return{fieldName:s,operator:d,fieldValue:f}}},{key:"_adaptGeoFilter",value:function(_){var p=_.insideBoundingBox,n=_.aroundRadius,a=_.aroundLatLng,s=_.insidePolygon;if(p){var d,f,h,y;if(Array.isArray(p)){var S=p.flat(),b=(0,t.default)(S,4);d=b[0],f=b[1],h=b[2],y=b[3]}else{var A=p.split(","),E=(0,t.default)(A,4);d=E[0],f=E[1],h=E[2],y=E[3]}return"".concat(this.configuration.geoLocationField,":(").concat(d,", ").concat(f,", ").concat(d,", ").concat(y,", ").concat(h,", ").concat(y,", ").concat(h,", ").concat(f,")")}if(a||n){if(!n||n==="all")throw new Error("[Typesense-Instantsearch-Adapter] In Typesense, geo-filtering around a lat/lng also requires a numerical radius. So the `aroundRadius` parameter is required when `aroundLatLng` is used. If you intend to just geo-sort around a lat/long, you want to use the sortBy InstantSearch widget (or a virtual sortBy custom widget).");var q="".concat(parseFloat(n)/1e3," km");return"".concat(this.configuration.geoLocationField,":(").concat(a,", ").concat(q,")")}if(s){var k=s;return Array.isArray(s)&&(k=s.flat().join(",")),"".concat(this.configuration.geoLocationField,":(").concat(k,")")}}},{key:"_adaptFilters",value:function(_,p){var n=[];return _.filters&&n.push(_.filters),n.push(this._adaptFacetFilters(_.facetFilters,p)),n.push(this._adaptNumericFilters(_.numericFilters)),n.push(this._adaptGeoFilter(_)),n.filter(function(a){return a&&a!==""}).join(" && ")}},{key:"_adaptIndexName",value:function(_){return _.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[1]}},{key:"_adaptSortBy",value:function(_){return _.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[3]}},{key:"_adaptFacetBy",value:function(_,p){var n=this;return[_].flat().map(function(a){var s;return(s=n.configuration.collectionSpecificFacetByOptions)!==null&&s!==void 0&&(s=s[p])!==null&&s!==void 0&&s[a]?"".concat(a).concat(n.configuration.collectionSpecificFacetByOptions[p][a]):n.configuration.facetByOptions[a]?"".concat(a).concat(n.configuration.facetByOptions[a]):a}).join(",")}},{key:"_adaptRulesContextsToOverrideTags",value:function(_){return _.join(",")}},{key:"_buildSearchParameters",value:function(_){for(var p,n,a=_.params,s=_.indexName,d=this._adaptIndexName(s),f={},h=0,y=Object.entries(this.additionalSearchParameters);h<y.length;h++){var S=(0,t.default)(y[h],2),b=S[0],A=S[1];f[this._camelToSnakeCase(b)]=A}if(this.collectionSpecificSearchParameters[d])for(var E=0,q=Object.entries(this.collectionSpecificSearchParameters[d]);E<q.length;E++){var k=(0,t.default)(q[E],2),C=k[0],F=k[1];f[this._camelToSnakeCase(C)]=F}var B=Object.assign({},f),T=this._adaptSortBy(s);Object.assign(B,{collection:d,q:a.query===""||a.query===void 0?"*":a.query,facet_by:f.facet_by||this._adaptFacetBy(a.facets,d),filter_by:this._adaptFilters(a,d)||f.filter_by,sort_by:T||f.sort_by,max_facet_values:a.maxValuesPerFacet,page:(a.page||0)+1}),a.hitsPerPage!=null&&(B.per_page=a.hitsPerPage),a.facetQuery&&(B.facet_query="".concat(a.facetName,":").concat(a.facetQuery),B.per_page=0),a.ruleContexts&&a.ruleContexts.length>0&&(B.override_tags=this._adaptRulesContextsToOverrideTags(a.ruleContexts)),a.typesenseVectorQuery&&(B.vector_query=a.typesenseVectorQuery);var H=((p=this.configuration.collectionSpecificSortByOptions)===null||p===void 0||(p=p[d])===null||p===void 0?void 0:p[B.sort_by])||((n=this.configuration.sortByOptions)===null||n===void 0?void 0:n[B.sort_by]);return H?.enable_overrides!=null&&(B.enable_overrides=H.enable_overrides),Object.fromEntries(Object.entries(B).filter(function(O){var x=(0,t.default)(O,2);x[0];var U=x[1];return U!=null&&U!==""}))}},{key:"_camelToSnakeCase",value:function(_){return _.split(/(?=[A-Z])/).join("_").toLowerCase()}},{key:"request",value:function(){var m=(0,r.default)(l.default.mark(function p(){var n=this,a,s,d,f,h,y,S,b,A;return l.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return d=this.instantsearchRequests.map(function(k){return n._buildSearchParameters(k)}),f={},(((a=d[0])===null||a===void 0?void 0:a.conversation)===!0||((s=d[0])===null||s===void 0?void 0:s.conversation)==="true")&&(h=d[0],y=h.q,S=h.conversation,b=h.conversation_id,A=h.conversation_model_id,f={q:y,conversation:S,conversation_id:b,conversation_model_id:A},d=d.map(function(k){k.q,k.conversation,k.conversation_id,k.conversation_model_id;var C=(0,c.default)(k,u);return C})),q.abrupt("return",this.typesenseClient.multiSearch.perform({searches:d},f));case 4:case"end":return q.stop()}},p,this)}));function _(){return m.apply(this,arguments)}return _}()}],[{key:"INDEX_NAME_MATCHING_REGEX",get:function(){return new RegExp("^(.+?)(?=(/sort/(.*))|$)")}},{key:"DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*)((?!:).):(?!:)(.*)")}},{key:"DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*?)(<=|>=|>|<|=)(.*)")}}])}(),Oe}var Ae={},rr={exports:{}},nr={exports:{}},Wn;function bo(){return Wn||(Wn=1,function(e){var l=wa();function c(r){if(Array.isArray(r))return l(r)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(nr)),nr.exports}var ar={exports:{}},Kn;function So(){return Kn||(Kn=1,function(e){function l(c){if(typeof Symbol<"u"&&c[Symbol.iterator]!=null||c["@@iterator"]!=null)return Array.from(c)}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(ar)),ar.exports}var ir={exports:{}},Qn;function Co(){return Qn||(Qn=1,function(e){function l(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports}(ir)),ir.exports}var Gn;function Ro(){return Gn||(Gn=1,function(e){var l=bo(),c=So(),r=Oa(),t=Co();function i(o){return l(o)||c(o)||r(o)||t()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(rr)),rr.exports}var or={exports:{}},Jn;function Po(){return Jn||(Jn=1,function(e){var l=ua();function c(r,t,i){return(t=l(t))in r?Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[t]=i,r}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(or)),or.exports}var Ee={},Vn;function Ea(){return Vn||(Vn=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.utils=void 0,Ee.utils={_adaptHighlightTag:function(l,c,r){return l.replace(new RegExp("<mark>","g"),c||"<mark>").replace(new RegExp("</mark>","g"),r||"</mark>")},_adaptNumberOfPages:function(){var l=this.typesenseResponse.found/this.typesenseResponse.request_params.per_page;return Number.isFinite(l)?Math.ceil(l):1}}),Ee}var Xn;function wo(){if(Xn)return Ae;Xn=1;var e=xe();Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.SearchResponseAdapter=void 0;var l=e(xt()),c=e(Aa()),r=e(Ro()),t=e(Po()),i=e(je()),o=e(ke()),u=Ea();function v(p,n){var a=Object.keys(p);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(p);n&&(s=s.filter(function(d){return Object.getOwnPropertyDescriptor(p,d).enumerable})),a.push.apply(a,s)}return a}function m(p){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?v(Object(a),!0).forEach(function(s){(0,t.default)(p,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach(function(s){Object.defineProperty(p,s,Object.getOwnPropertyDescriptor(a,s))})}return p}var _=Ae.SearchResponseAdapter=function(){function p(n,a,s){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};(0,i.default)(this,p),this.typesenseResponse=n,this.instantsearchRequest=a,this.configuration=s,this.allTypesenseResults=d,this.fullTypesenseResponse=f}return(0,o.default)(p,[{key:"_adaptGroupedHits",value:function(a){var s=this,d=[];return d=a.map(function(f){var h=s._adaptHits(f.hits);return h.forEach(function(y){y.group_key=y._group_key=f.group_key,f.found&&(y._group_found=f.found)}),h}),this.configuration.flattenGroupedHits?d=d.flat():d=d.map(function(f){return m(m({},f[0]),{},{_grouped_hits:f})}),d}},{key:"_adaptHits",value:function(a){var s=this,d=[];return d=a.map(function(f){var h=m({},f.document);h.objectID=f.document.id,h._snippetResult=s._adaptHighlightResult(f,"snippet"),h._highlightResult=s._adaptHighlightResult(f,"value"),h._rawTypesenseHit=f,s.fullTypesenseResponse.conversation&&(h._rawTypesenseConversation=s.fullTypesenseResponse.conversation),["text_match","geo_distance_meters","curated","text_match_info","hybrid_search_info","vector_distance"].forEach(function(S){Object.keys(f).includes(S)&&!Object.keys(h).includes(S)&&(h[S]=f[S])});var y=h[s.configuration.geoLocationField];return y&&(h._geoloc={lat:y[0],lng:y[1]}),h}),d}},{key:"_adaptHighlightResult",value:function(a,s){var d={};return a.highlight!=null&&this.isHighlightPost0240RCN32Format(a.highlight)?this.adaptHighlightObject(a,d,s):this.adaptHighlightsArray(a,d,s),d}},{key:"isHighlightPost0240RCN32Format",value:function(a){return a.full==null&&a.snippet==null}},{key:"adaptHighlightsArray",value:function(a,s,d){var f=this;Object.assign.apply(Object,[s].concat((0,r.default)(Object.entries(a.document).map(function(h){var y=(0,c.default)(h,2),S=y[0],b=y[1];return(0,t.default)({},S,{value:b,matchLevel:"none",matchedWords:[]})})))),a.highlights.forEach(function(h){s[h.field]={value:h[d]||h["".concat(d,"s")],matchLevel:"full",matchedWords:h.matched_tokens},h.indices&&(s[h.field].matchedIndices=h.indices)}),Object.entries(s).forEach(function(h){var y=(0,c.default)(h,2),S=y[0],b=y[1],A=S,E=b.value,q=b.matchLevel,k=b.matchedWords,C=b.matchedIndices;E==null?s[A]=f._adaptHighlightNullValue():Array.isArray(E)?(s[A]=[],a.document[A].forEach(function(F,B){C&&C.includes(B)?s[A].push({value:f._adaptHighlightTag("".concat(E[C.indexOf(B)]),f.instantsearchRequest.params.highlightPreTag,f.instantsearchRequest.params.highlightPostTag),matchLevel:q,matchedWords:k[B]}):(0,l.default)(F)==="object"?s[A].push(f._adaptHighlightInObjectValue(F,{},d)):s[A].push({value:"".concat(F),matchLevel:"none",matchedWords:[]})})):(0,l.default)(E)==="object"?s[A]=f._adaptHighlightInObjectValue(E,{},d):s[A].value=f._adaptHighlightTag("".concat(E),f.instantsearchRequest.params.highlightPreTag,f.instantsearchRequest.params.highlightPostTag)})}},{key:"adaptHighlightObject",value:function(a,s,d){Object.assign(s,this._adaptHighlightInObjectValue(a.document,a.highlight,d))}},{key:"_adaptHighlightInObjectValue",value:function(a,s,d){var f=this;return Object.assign.apply(Object,[{}].concat((0,r.default)(Object.entries(a).map(function(h){var y=(0,c.default)(h,2),S=y[0],b=y[1],A;if(b==null)A=f._adaptHighlightNullValue();else if(Array.isArray(b)){var E;A=f._adaptHighlightInArrayValue(b,(E=s?.[S])!==null&&E!==void 0?E:[],d)}else if((0,l.default)(b)==="object"){var q;A=f._adaptHighlightInObjectValue(b,(q=s?.[S])!==null&&q!==void 0?q:{},d)}else A=f._adaptHighlightInPrimitiveValue(b,s?.[S],d);return(0,t.default)({},S,A)}))))}},{key:"_adaptHighlightInArrayValue",value:function(a,s,d){var f=this;return a.map(function(h,y){var S;if(h==null)S=f._adaptHighlightNullValue();else if(Array.isArray(h)){var b;S=f._adaptHighlightInArrayValue(h,(b=s?.[y])!==null&&b!==void 0?b:[],d)}else if((0,l.default)(h)==="object"){var A;S=f._adaptHighlightInObjectValue(h,(A=s?.[y])!==null&&A!==void 0?A:{},d)}else S=f._adaptHighlightInPrimitiveValue(h,s?.[y],d);return S})}},{key:"_adaptHighlightInPrimitiveValue",value:function(a,s,d){if(s!=null){var f,h;return{value:this._adaptHighlightTag("".concat((f=(h=s[d])!==null&&h!==void 0?h:s.highlight)!==null&&f!==void 0?f:s.snippet),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:(s.matched_tokens||[]).length>0?"full":"none",matchedWords:s.matched_tokens||[]}}else return{value:this._adaptHighlightTag("".concat(a),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:"none",matchedWords:[]}}},{key:"_adaptHighlightNullValue",value:function(){return{value:"",matchLevel:"none",matchedWords:[]}}},{key:"_adaptFacets",value:function(a){var s={};return a.forEach(function(d){Object.assign(s,(0,t.default)({},d.field_name,Object.assign.apply(Object,[{}].concat((0,r.default)(d.counts.map(function(f){return(0,t.default)({},f.value,f.count)}))))))}),s}},{key:"_adaptFacetStats",value:function(a){var s={};return a.forEach(function(d){Object.keys(d.stats).length>0&&Object.assign(s,(0,t.default)({},d.field_name,d.stats))}),s}},{key:"_adaptRenderingContent",value:function(a){var s,d=Object.assign({},this.configuration.renderingContent);return((s=d.facetOrdering)===null||s===void 0||(s=s.facets)===null||s===void 0?void 0:s.order)==null&&(d.facetOrdering=d.facetOrdering||{},d.facetOrdering.facets=d.facetOrdering.facets||{},d.facetOrdering.facets.order=(0,r.default)(new Set(a.map(function(f){return f.field_name}).concat(this.allTypesenseResults.map(function(f){return f.facet_counts||[]}).flat().map(function(f){return f.field_name}).filter(function(f){return f}))))),d}},{key:"_adaptUserData",value:function(a){return a?Array.isArray(a)?a:[a]:[]}},{key:"adapt",value:function(){var a=this._adaptRenderingContent(this.typesenseResponse.facet_counts||[]),s=m({hits:this.typesenseResponse.grouped_hits?this._adaptGroupedHits(this.typesenseResponse.grouped_hits):this._adaptHits(this.typesenseResponse.hits),nbHits:this.typesenseResponse.found,page:this.typesenseResponse.page-1,nbPages:this._adaptNumberOfPages(),hitsPerPage:this.typesenseResponse.request_params.per_page,facets:this._adaptFacets(this.typesenseResponse.facet_counts||[]),facets_stats:this._adaptFacetStats(this.typesenseResponse.facet_counts||{}),query:this.typesenseResponse.request_params.q,processingTimeMS:this.typesenseResponse.search_time_ms},Object.keys(a).length>0?{renderingContent:a}:null);return this.typesenseResponse.metadata&&(s.appliedRules=["typesense-override"],s.userData=this._adaptUserData(this.typesenseResponse.metadata)),this.fullTypesenseResponse.conversation&&s.hits.length===0&&(s.hits=[{_rawTypesenseConversation:this.fullTypesenseResponse.conversation}]),s}}])}();return Object.assign(_.prototype,u.utils),Ae}var qe={},Yn;function Oo(){if(Yn)return qe;Yn=1;var e=xe();Object.defineProperty(qe,"__esModule",{value:!0}),qe.FacetSearchResponseAdapter=void 0;var l=e(je()),c=e(ke()),r=Ea(),t=qe.FacetSearchResponseAdapter=function(){function i(o,u){(0,l.default)(this,i),this.typesenseResponse=o,this.instantsearchRequest=u}return(0,c.default)(i,[{key:"_adaptFacetHits",value:function(u){var v=this,m={},_=u.find(function(p){return p.field_name===v.instantsearchRequest.params.facetName});return m=_.counts.map(function(p){return{value:p.value,highlighted:v._adaptHighlightTag(p.highlighted,v.instantsearchRequest.params.highlightPreTag,v.instantsearchRequest.params.highlightPostTag),count:p.count}}),m}},{key:"adapt",value:function(){var u={facetHits:this._adaptFacetHits(this.typesenseResponse.facet_counts),exhaustiveFacetsCount:!0,processingTimeMS:this.typesenseResponse.search_time_ms};return u}}])}();return Object.assign(t.prototype,r.utils),qe}var Zn;function Ao(){return Zn||(Zn=1,function(e){var l=xe();Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=l(oa()),r=l(sa()),t=l(je()),i=l(ke()),o=ji(),u=ho(),v=go(),m=wo(),_=Oo();e.default=function(){function p(n){var a=this;(0,t.default)(this,p),this.updateConfiguration(n),this.searchClient={clearCache:function(){return a.clearCache()},search:function(d){return a.searchTypesenseAndAdapt(d)},searchForFacetValues:function(d){return a.searchTypesenseForFacetValuesAndAdapt(d)}}}return(0,i.default)(p,[{key:"searchTypesenseAndAdapt",value:function(){var n=(0,r.default)(c.default.mark(function s(d){var f=this,h,y;return c.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return h=b.sent,y=h.results.map(function(A,E){f._validateTypesenseResult(A);var q=new m.SearchResponseAdapter(A,d[E],f.configuration,h.results,h),k=q.adapt();return k}),b.abrupt("return",{results:y});case 8:throw b.prev=8,b.t0=b.catch(0),console.error(b.t0),b.t0;case 12:case"end":return b.stop()}},s,this,[[0,8]])}));function a(s){return n.apply(this,arguments)}return a}()},{key:"searchTypesenseForFacetValuesAndAdapt",value:function(){var n=(0,r.default)(c.default.mark(function s(d){var f=this,h,y;return c.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return h=b.sent,y=h.results.map(function(A,E){f._validateTypesenseResult(A);var q=new _.FacetSearchResponseAdapter(A,d[E],f.configuration);return q.adapt()}),b.abrupt("return",y);case 8:throw b.prev=8,b.t0=b.catch(0),console.error(b.t0),b.t0;case 12:case"end":return b.stop()}},s,this,[[0,8]])}));function a(s){return n.apply(this,arguments)}return a}()},{key:"_adaptAndPerformTypesenseRequest",value:function(){var n=(0,r.default)(c.default.mark(function s(d){var f,h;return c.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return f=new v.SearchRequestAdapter(d,this.typesenseClient,this.configuration),S.next=3,f.request();case 3:return h=S.sent,S.abrupt("return",h);case 5:case"end":return S.stop()}},s,this)}));function a(s){return n.apply(this,arguments)}return a}()},{key:"clearCache",value:function(){return this.typesenseClient=new u.SearchClient(this.configuration.server),this.searchClient}},{key:"updateConfiguration",value:function(a){return this.configuration=new o.Configuration(a),this.configuration.validate(),this.typesenseClient=new u.SearchClient(this.configuration.server),!0}},{key:"_validateTypesenseResult",value:function(a){if(a.error)throw new Error("".concat(a.code," - ").concat(a.error));if(!a.hits&&!a.grouped_hits)throw new Error("Did not find any hits. ".concat(a.code," - ").concat(a.error))}}])}()}(Dt)),Dt}var Eo=Ao();const qo=Ga(Eo),To={class:"row q-mt-md"},xo={class:"col-3 q-pr-sm"},jo={class:"text-subtitle2 q-pt-md"},ko={class:"text-subtitle2 q-pt-md"},Io={class:"text-subtitle2 q-pt-md"},Mo={class:"col-9"},No={key:1},Ho=me({__name:"SearchInstantSearch",setup(e){const l=lr(),c=Q(null),r=Q(),t=Q(),i=Q(null),o=Q(null),u=[({instantSearchInstance:f})=>({subscribe(){t.value=f},unsubscribe(){t.value=null}})],v=z(()=>l.currentCollection),m=z(()=>!v.value||!v.value.fields?[]:v.value.fields.filter(f=>f.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(f.type)&&!f.name.includes(".*")).map(f=>f.name)),_=z(()=>!v.value||!v.value.fields?[]:v.value.fields.filter(f=>f.facet&&["string","string[]"].includes(f.type)&&!f.name.includes(".*")).map(f=>f.name)),p=z(()=>!v.value||!v.value.fields?[]:v.value.fields.filter(f=>f.facet&&["bool","bool[]"].includes(f.type)&&!f.name.includes(".*")).map(f=>f.name)),n=z(()=>{if(!v.value||!v.value.fields)return[];const f=[{value:v.value.name,label:"Default"}];return v.value.fields.filter(h=>["int32","float"].includes(h.type)||h.type==="string"&&h.sort).forEach(h=>{v.value&&(f.push({value:`${v.value.name}/sort/${h.name}:asc`,label:`${h.name} asc`}),f.push({value:`${v.value.name}/sort/${h.name}:desc`,label:`${h.name} desc`}))}),f}),a=z(()=>l.data.stopwords.map(f=>f.id)),s=()=>{t.value&&v.value&&l.exportToJson(t.value.renderState[v.value.name].hits.results.hits)},d=()=>{r.value&&v.value&&r.value.updateConfiguration({...r.value.configuration,additionalSearchParameters:{...r.value.configuration.additionalSearchParameters,stopwords:o.value}})};return Tt(()=>v.value,()=>{c.value=null,i.value=null,window.setTimeout(()=>{if(!l.loginData||!v.value)return;const f=(v.value?.fields||[]).filter(h=>h.index&&["string","string[]"].includes(h.type)&&!h.name.includes(".*")).map(h=>h.name).join(",");try{const h=new qo({server:{nodes:[{...l.loginData.node}],apiKey:l.loginData.apiKey},additionalSearchParameters:{exhaustive_search:!0,query_by:f}});r.value=h,c.value=h.searchClient}catch(h){i.value=h.message+"Using query_by: "+f,console.error(h)}})},{immediate:!0}),(f,h)=>{const y=re("ais-configure"),S=re("ais-search-box"),b=re("ais-stats"),A=re("ais-current-refinements"),E=re("ais-hits-per-page"),q=re("ais-sort-by"),k=re("ais-range-input"),C=re("ais-refinement-list"),F=re("ais-pagination"),B=re("ais-hits"),T=re("ais-instant-search");return c.value&&v.value?(L(),ie(T,{key:0,"search-client":c.value,"index-name":v.value.name,middlewares:u},{default:K(()=>[I(y,{hitsPerPage:12}),I(S,{"index-name":"instant_search","search-client":c.value},{default:K(()=>[I(qi)]),_:1},8,["search-client"]),I(b),I(A),ne("div",To,[ne("div",xo,[I(E,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"250 hits per page",value:250}]}),I(pe,{flat:"",onClick:h[0]||(h[0]=H=>s())},{default:K(()=>h[4]||(h[4]=[de("export current page")])),_:1,__:[4]}),h[5]||(h[5]=ne("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1)),I(q,{items:n.value},null,8,["items"]),h[6]||(h[6]=ne("div",{class:"text-subtitle2 q-pt-md"},"Stopwords",-1)),I(Ya,{modelValue:o.value,"onUpdate:modelValue":[h[1]||(h[1]=H=>o.value=H),h[2]||(h[2]=H=>d())],disable:!Ja(l).data.features.stopwords,outlined:"",clearable:"",dense:"","options-dense":"",options:a.value},null,8,["modelValue","disable","options"]),(L(!0),J(le,null,ve(m.value,H=>(L(),J("div",{key:H,class:"q-mb-sm"},[ne("div",jo,fe(H),1),I(k,{searchable:!0,attribute:H},null,8,["attribute"])]))),128)),(L(!0),J(le,null,ve(_.value,H=>(L(),J("div",{key:H,class:"q-mb-sm"},[ne("div",ko,fe(H),1),I(C,{class:"q-mb-sm",searchable:!0,attribute:H},null,8,["attribute"])]))),128)),(L(!0),J(le,null,ve(p.value,H=>(L(),J("div",{key:H,class:"q-mb-sm"},[ne("div",Io,fe(H),1),I(C,{class:"q-mb-sm",attribute:H},null,8,["attribute"])]))),128))]),ne("div",Mo,[I(F,{class:"q-mb-md"}),I(B,null,Va({_:2},[v.value?{name:"item",fn:K(({item:H})=>[I(ia,{item:H,onDeleted:h[3]||(h[3]=O=>t.value.refresh())},null,8,["item"])]),key:"0"}:void 0]),1024),I(F,{class:"q-my-md"})])])]),_:1},8,["search-client","index-name"])):i.value?(L(),J("div",No,[I(aa,{"inline-actions":"",class:"text-white bg-red"},{default:K(()=>[de(fe(i.value),1)]),_:1})])):ae("",!0)}}}),Xo=me({__name:"Search",setup(e){const l=Q("form");return(c,r)=>(L(),ie(Xa,{padding:""},{default:K(()=>[I(qa,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=t=>l.value=t),dense:"",class:"bg-primary text-white",align:"justify","narrow-indicator":""},{default:K(()=>[I(fr,{name:"form",label:"InstantSearch Mode"}),I(fr,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),I(ra),I(Ta,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=t=>l.value=t),animated:"","keep-alive":""},{default:K(()=>[I(hr,{name:"form"},{default:K(()=>[I(Ho)]),_:1}),I(hr,{name:"json",class:"q-pa-none"},{default:K(()=>[I(Oi)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Xo as default};
