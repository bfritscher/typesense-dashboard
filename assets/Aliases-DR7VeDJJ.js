import{K as x,u as y,H as v,f as r,A as V,U as Q,M as C,O as s,N as a,a3 as N,a4 as k,a7 as c,a9 as w,S as i,X as u,$ as S,T as U,W as p,R as $}from"./index-CWCfc1R0.js";import{a as B}from"./QSelect-B2bCo1Ml.js";import{Q as T,a as O,b as D}from"./QTable-DYi6JvBk.js";import{Q as I}from"./QPage-B_Kz1etr.js";import{u as M}from"./use-quasar-npx6AL4x.js";import"./QChip-DBKn72ks.js";import"./QItem-BBPRi80o.js";import"./QList-DIVxnbm_.js";import"./QLinearProgress-Dhc8340v.js";const P={class:"text-h6"},j=x({__name:"Aliases",setup(h){const f=M(),n=y(),e=v({alias:{name:"",collection_name:""},expanded:n.data.aliases.length===0,filter:"",columns:[{label:"Alias Name",name:"name",field:"name",align:"left",sortable:!0},{label:"Collection Name",name:"collection_name",field:"collection_name",align:"left",sortable:!0},{label:"Actions",name:"actions",align:"right"}]}),d=r(()=>n.data.collections.map(o=>o.name).sort()),m=r(()=>n.data.aliases.map(o=>o.name).includes(e.alias.name));async function _(){await n.createAlias({name:e.alias.name,collection_name:e.alias.collection_name}),e.alias={name:"",collection_name:""},e.expanded=!1}function g(o){e.alias=JSON.parse(JSON.stringify(o)),e.expanded=!0}function b(o){f.dialog({title:"Confirm",message:`Delete alias ${o}?`,cancel:!0,persistent:!0}).onOk(()=>{n.deleteAlias(o)})}return V(()=>{n.getAliases()}),(o,t)=>(C(),Q(I,{padding:""},{default:s(()=>[a(T,{modelValue:e.expanded,"onUpdate:modelValue":t[3]||(t[3]=l=>e.expanded=l),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:`${m.value?"Update":"Add"} Alias`,"header-class":"bg-primary text-white"},{default:s(()=>[a(N,{class:"bg-surface column"},{default:s(()=>[a(k,null,{default:s(()=>[a(c,{modelValue:e.alias.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.alias.name=l),label:"Alias name",filled:"",rules:[l=>!d.value.includes(l)||"Must not be a collection name"]},null,8,["modelValue","rules"]),a(B,{modelValue:e.alias.collection_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.alias.collection_name=l),label:"Target Collection",filled:"",options:d.value},null,8,["modelValue","options"])]),_:1}),a(w,{align:"right",class:"bg-primary"},{default:s(()=>[a(i,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:t[2]||(t[2]=l=>_())},{default:s(()=>[u(S(m.value?"Update":"Add")+" Alias",1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),a(O,{class:"q-mt-md",title:"Aliases",flat:"",bordered:"",filter:e.filter,rows:U(n).data.aliases,columns:e.columns,"row-key":"name","visible-columns":["name","collection_name","actions"],pagination:{rowsPerPage:50,sortBy:"name"}},{"top-left":s(()=>[$("div",P,[a(p,{size:"md",name:"sym_s_call_split"}),t[5]||(t[5]=u(" Aliases",-1))])]),"top-right":s(()=>[a(c,{modelValue:e.filter,"onUpdate:modelValue":t[4]||(t[4]=l=>e.filter=l),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:s(()=>[a(p,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions":s(l=>[a(D,{class:"text-right"},{default:s(()=>[a(i,{flat:"",icon:"sym_s_edit",title:"Edit",onClick:A=>g(l.row)},null,8,["onClick"]),a(i,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:A=>b(l.row.name)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{j as default};
