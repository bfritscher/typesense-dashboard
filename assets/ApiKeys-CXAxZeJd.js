import{K,u as S,H as v,f as A,A as N,U as u,M as f,O as s,N as o,a3 as h,V as C,a4 as Q,S as r,X as n,T as d,$ as V,a9 as O,a7 as E,W as y,R as J}from"./index--0lAtNsd.js";import{Q as I}from"./QBanner-CwLly00w.js";import{Q as w,a as D,b as P}from"./QTable-CKVj8KGb.js";import{Q as j}from"./QPage-COg4uAGZ.js";import{u as $}from"./use-quasar-BNtlXdl5.js";import{M as B}from"./MonacoEditor-CywBzVhJ.js";import"./QItem-BLH56R8f.js";import"./QSelect-BzrgwpKf.js";import"./QChip-CZ22uClo.js";import"./QList-B3DUIL4Z.js";import"./QLinearProgress-DDEo-qGO.js";import"./QResizeObserver-6FLPz3or.js";const T={class:"text-h6"},te=K({__name:"ApiKeys",setup(M){const p=$(),i=S(),c={description:"Admin key.",actions:["*"],collections:["*"]},g={description:"Search-only companies key.",actions:["documents:search"],collections:["companies"]},t=v({jsonError:null,key:JSON.parse(JSON.stringify(c)),expanded:i.data.apiKeys.length===0,filter:"",columns:[{label:"ID",name:"id",field:"id",sortable:!0},{label:"Key prefix",name:"value_prefix",field:"value_prefix"},{label:"Description",name:"description",field:"description",sortable:!0,align:"left"},{label:"Key Actions",name:"actions",field:a=>JSON.stringify(a.actions),sortable:!0,align:"left"},{label:"Collections",name:"collections",field:a=>JSON.stringify(a.collections),sortable:!0,align:"left"},{label:"Expires at",name:"expires_at",field:a=>a.expires_at?a.expires_at===64723363199?"never":new Date(a.expires_at*1e3).toLocaleString():""},{label:"Actions",name:"actions_op",align:"right"}]}),m=A({get:()=>JSON.stringify(t.key,null,2),set:a=>{try{t.key=JSON.parse(a),t.jsonError=null}catch(e){t.jsonError=e.message}}});function _(){t.key=JSON.parse(JSON.stringify(c))}function x(){t.key=JSON.parse(JSON.stringify(g))}async function b(){const a=await i.createApiKey(JSON.parse(JSON.stringify(t.key)));p.dialog({title:"Your API key",message:`This is your API key copy it! It will not be displayed again!

${a.value||""}`,cancel:!1,persistent:!0})}function k(a){p.dialog({title:"Confirm",message:`Delete key with id: ${a}?`,cancel:!0,persistent:!0}).onOk(()=>{i.deleteApiKey(a)})}return N(()=>{i.getApiKeys()}),(a,e)=>(f(),u(j,{padding:""},{default:s(()=>[o(w,{modelValue:t.expanded,"onUpdate:modelValue":e[1]||(e[1]=l=>t.expanded=l),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:"Create API Key","header-class":"bg-primary text-white"},{default:s(()=>[o(h,{style:{height:"60vh"},class:"bg-surface column"},{default:s(()=>[o(Q,{class:"q-gutter-md"},{default:s(()=>[o(r,{flat:"",onClick:_},{default:s(()=>[...e[3]||(e[3]=[n("Admin Key Example",-1)])]),_:1}),o(r,{flat:"",onClick:x},{default:s(()=>[...e[4]||(e[4]=[n("Search Key Example",-1)])]),_:1}),o(r,{type:"a",icon:"sym_s_help","no-caps":"",color:"info",flat:"",dense:"",href:`https://typesense.org/docs/${d(i).data.debug.version||d(i).data.defaultDocVersion}/api/api-keys.html#create-an-api-key`,target:"_blank"},{default:s(()=>[...e[5]||(e[5]=[n("Documentation",-1)])]),_:1},8,["href"])]),_:1}),o(B,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l)},null,8,["modelValue"]),t.jsonError?(f(),u(I,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:s(()=>[n(" Invalid Format: "+V(t.jsonError),1)]),_:1})):C("",!0),o(O,{align:"right",class:"bg-primary"},{default:s(()=>[o(r,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!t.jsonError,onClick:b},{default:s(()=>[...e[6]||(e[6]=[n("Create API Key",-1)])]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(D,{class:"q-mt-md",title:"API Keys",flat:"",bordered:"",filter:t.filter,rows:d(i).data.apiKeys,columns:t.columns,"row-key":"id","visible-columns":["id","value_prefix","description","actions","collections","expires_at","actions_op"]},{"top-left":s(()=>[J("div",T,[o(y,{size:"md",name:"sym_s_key"}),e[7]||(e[7]=n(" API Keys",-1))])]),"top-right":s(()=>[o(E,{modelValue:t.filter,"onUpdate:modelValue":e[2]||(e[2]=l=>t.filter=l),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:s(()=>[o(y,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions_op":s(l=>[o(P,{class:"text-right"},{default:s(()=>[o(r,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:U=>k(l.row.id)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{te as default};
