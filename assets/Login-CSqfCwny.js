import{e as D,r as U,af as I,ag as K,A as $,i as R,h as T,g as L,ak as M,aF as B,z as O,b8 as z,D as j,b9 as G,K as H,u as J,L as V,M as y,R as p,N as a,O as m,U as F,V as A,a4 as E,a7 as C,T as l,ba as W,$ as X,a9 as Y,S as P,a3 as Z}from"./index-CWCfc1R0.js";import{a as ee,b as te}from"./QSelect-B2bCo1Ml.js";import{_ as oe}from"./ServerHistory.vue_vue_type_script_setup_true_lang-Bz7i0b4F.js";import"./QChip-DBKn72ks.js";import"./QItem-BBPRi80o.js";import"./QList-DIVxnbm_.js";const ne=D({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(d,{slots:o,emit:v}){const g=R(),c=U(null);let i=0;const e=[];function r(t){const f=typeof t=="boolean"?t:d.noErrorFocus!==!0,h=++i,_=(n,s)=>{v(`validation${n===!0?"Success":"Error"}`,s)},k=n=>{const s=n.validate();return typeof s.then=="function"?s.then(u=>({valid:u,comp:n}),u=>({valid:!1,comp:n,err:u})):Promise.resolve({valid:s,comp:n})};return(d.greedy===!0?Promise.all(e.map(k)).then(n=>n.filter(s=>s.valid!==!0)):e.reduce((n,s)=>n.then(()=>k(s).then(u=>{if(u.valid===!1)return Promise.reject(u)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return h===i&&_(!0),!0;if(h===i){const{comp:s,err:u}=n[0];if(u!==void 0&&console.error(u),_(!1,s),f===!0){const w=n.find(({comp:Q})=>typeof Q.focus=="function"&&M(Q.$)===!1);w!==void 0&&w.comp.focus()}}return!1})}function x(){i++,e.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function N(t){t!==void 0&&B(t);const f=i+1;r().then(h=>{f===i&&h===!0&&(d.onSubmit!==void 0?v("submit",t):t?.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function S(t){t!==void 0&&B(t),v("reset"),O(()=>{x(),d.autofocus===!0&&d.noResetFocus!==!0&&b()})}function b(){z(()=>{if(c.value===null)return;(c.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||c.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||c.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(c.value.querySelectorAll("[tabindex]"),f=>f.tabIndex!==-1))?.focus({preventScroll:!0})})}j(G,{bindComponent(t){e.push(t)},unbindComponent(t){const f=e.indexOf(t);f!==-1&&e.splice(f,1)}});let q=!1;return I(()=>{q=!0}),K(()=>{q===!0&&d.autofocus===!0&&b()}),$(()=>{d.autofocus===!0&&b()}),Object.assign(g.proxy,{validate:r,resetValidation:x,submit:N,reset:S,focus:b,getValidationComponents:()=>e}),()=>T("form",{class:"q-form",ref:c,onSubmit:N,onReset:S},L(o.default))}}),re={class:"fullscreen row bg-primary text-center q-pa-md flex flex-center"},ae={class:"col col-md-4"},le={key:0},se={key:1},ie={class:"text-left"},ue={class:"text-red"},ye=H({__name:"Login",setup(d){const o=J(),v=["http","https"],g=U("");$(()=>{o.connectionCheck()});function c(){o.login({apiKey:g.value,node:o.currentNodeConfig})}return(i,e)=>(y(),V("div",re,[p("div",ae,[e[7]||(e[7]=p("div",null,[p("h5",{class:"text-h5 text-white q-my-md"},"Typesense Dashboard")],-1)),p("div",null,[a(Z,{bordered:"",class:"q-pa-lg shadow-1"},{default:m(()=>[a(E,null,{default:m(()=>[a(ne,{class:"q-gutter-md"},{default:m(()=>[a(C,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=r=>g.value=r),filled:"",type:"password",label:"Api Key"},null,8,["modelValue"]),i.$q.platform.is.electron?(y(),V("p",le," requires server with cors enabled only for search function. ")):(y(),V("p",se,"requires server with cors enabled.")),a(ee,{modelValue:l(o).currentNodeConfig.protocol,"onUpdate:modelValue":e[1]||(e[1]=r=>l(o).currentNodeConfig.protocol=r),filled:"",options:v,label:"Protocol"},null,8,["modelValue"]),a(C,{modelValue:l(o).currentNodeConfig.host,"onUpdate:modelValue":e[2]||(e[2]=r=>l(o).currentNodeConfig.host=r),filled:"",type:"text",label:"host"},null,8,["modelValue"]),a(C,{modelValue:l(o).currentNodeConfig.port,"onUpdate:modelValue":e[3]||(e[3]=r=>l(o).currentNodeConfig.port=r),modelModifiers:{number:!0},filled:"",type:"number",label:"port"},null,8,["modelValue"]),a(C,{modelValue:l(o).currentNodeConfig.path,"onUpdate:modelValue":e[4]||(e[4]=r=>l(o).currentNodeConfig.path=r),filled:"",type:"text",label:"path",hint:"optional: leave blank or start with / and end without /"},null,8,["modelValue"]),p("div",ie,[i.$q.platform.is.electron&&l(o).currentNodeConfig.protocol==="https"?(y(),F(W,{key:0,modelValue:l(o).currentNodeConfig.tls,"onUpdate:modelValue":e[5]||(e[5]=r=>l(o).currentNodeConfig.tls=r),label:"Check TLS"},null,8,["modelValue"])):A("",!0)])]),_:1})]),_:1}),l(o).error?(y(),F(E,{key:0},{default:m(()=>[p("p",ue,X(l(o).error),1)]),_:1})):A("",!0),a(Y,{class:"q-px-md row"},{default:m(()=>[a(P,{unelevated:"",color:"primary",size:"lg",style:{flex:"1"},label:"Login",onClick:e[6]||(e[6]=r=>c())}),a(P,{color:"primary",size:"lg",icon:"sym_s_history"},{default:m(()=>[a(te,null,{default:m(()=>[a(oe)]),_:1})]),_:1})]),_:1})]),_:1})])])]))}});export{ye as default};
