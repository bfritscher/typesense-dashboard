import{Q as pr,a as Ze,b as vr,c as et}from"./QTabPanels-BCXdC1kS.js";import{e as Je,h as D,B as Ke,p as hr,r as M,i as Ut,s as yr,f as I,ad as mr,w as pe,ae as he,af as _r,ag as gr,o as br,J as Sr,ah as tt,t as rt,G as xr,A as Rr,ai as qr,g as Tr,aj as Ar,ak as ye,K as Z,Z as W,L as H,M as F,N as A,V,U as Q,S as X,a5 as K,_ as Kt,O as E,a6 as Y,ac as at,X as J,$ as U,u as Xe,Q as Jt,R as G,P as nt,Y as Or,W as wr,a7 as Xt,al as Pr,am as Cr,T as Ir,an as kr}from"./index-CNyTRbVy.js";import{Q as Fr}from"./QPage-DCzU5bFx.js";import{Q as se,a as jr}from"./QSelect-BGbh1rX-.js";import{b as te,a as Ye,Q as fe}from"./QItem-TxCjIglU.js";import{Q as Yt}from"./QList-BLy8dhP3.js";import{Q as it}from"./QResizeObserver-BK4pAhgZ.js";import{Q as zr,T as ot}from"./QScrollObserver-DCke7vTT.js";import{Q as Zt}from"./QBanner-C1LVGdzU.js";import{M as $r}from"./MonacoEditor-C7FuLZgQ.js";import{Q as Er}from"./QSpace-DF9gYMgh.js";import{u as Mr}from"./use-quasar-06UuKIZk.js";import{G as Nr,J as Hr}from"./ExperimentalDynamicWidgets-BZGXa4Zv.js";import"./touch-BjYP5sR0.js";import"./QChip-BMD_gwyW.js";const Lr=Je({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(e){return()=>[D("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),D("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),Ke(D("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),Ke(D("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]}}),st=["vertical","horizontal"],me={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},lt={prevent:!0,mouse:!0,mouseAllDir:!0},ut=e=>e>=250?50:Math.ceil(e/5),Br=Je({name:"QScrollArea",props:{...hr,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:u,emit:v}){const s=M(!1),l=M(!1),p=M(!1),h={vertical:M(0),horizontal:M(0)},i={vertical:{ref:M(null),position:M(0),size:M(0)},horizontal:{ref:M(null),position:M(0),size:M(0)}},{proxy:_}=Ut(),m=yr(e,_.$q);let y=null,d;const a=M(null),t=I(()=>"q-scrollarea"+(m.value===!0?" q-scrollarea--dark":""));Object.assign(h,{verticalInner:I(()=>h.vertical.value-e.verticalOffset[0]-e.verticalOffset[1]),horizontalInner:I(()=>h.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1])}),i.vertical.percentage=I(()=>{const g=i.vertical.size.value-h.vertical.value;if(g<=0)return 0;const R=te(i.vertical.position.value/g,0,1);return Math.round(R*1e4)/1e4}),i.vertical.thumbHidden=I(()=>(e.visible===null?p.value:e.visible)!==!0&&s.value===!1&&l.value===!1||i.vertical.size.value<=h.vertical.value+1),i.vertical.thumbStart=I(()=>e.verticalOffset[0]+i.vertical.percentage.value*(h.verticalInner.value-i.vertical.thumbSize.value)),i.vertical.thumbSize=I(()=>Math.round(te(h.verticalInner.value*h.verticalInner.value/i.vertical.size.value,ut(h.verticalInner.value),h.verticalInner.value))),i.vertical.style=I(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${i.vertical.thumbStart.value}px`,height:`${i.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`})),i.vertical.thumbClass=I(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(i.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),i.vertical.barClass=I(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(i.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),i.horizontal.percentage=I(()=>{const g=i.horizontal.size.value-h.horizontal.value;if(g<=0)return 0;const R=te(Math.abs(i.horizontal.position.value)/g,0,1);return Math.round(R*1e4)/1e4}),i.horizontal.thumbHidden=I(()=>(e.visible===null?p.value:e.visible)!==!0&&s.value===!1&&l.value===!1||i.horizontal.size.value<=h.horizontal.value+1),i.horizontal.thumbStart=I(()=>e.horizontalOffset[0]+i.horizontal.percentage.value*(h.horizontalInner.value-i.horizontal.thumbSize.value)),i.horizontal.thumbSize=I(()=>Math.round(te(h.horizontalInner.value*h.horizontalInner.value/i.horizontal.size.value,ut(h.horizontalInner.value),h.horizontalInner.value))),i.horizontal.style=I(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[_.$q.lang.rtl===!0?"right":"left"]:`${i.horizontal.thumbStart.value}px`,width:`${i.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`})),i.horizontal.thumbClass=I(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(i.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),i.horizontal.barClass=I(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(i.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const r=I(()=>i.vertical.thumbHidden.value===!0&&i.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle);function c(){const g={};return st.forEach(R=>{const k=i[R];Object.assign(g,{[R+"Position"]:k.position.value,[R+"Percentage"]:k.percentage.value,[R+"Size"]:k.size.value,[R+"ContainerSize"]:h[R].value,[R+"ContainerInnerSize"]:h[R+"Inner"].value})}),g}const o=mr(()=>{const g=c();g.ref=_,v("scroll",g)},0);function n(g,R,k){if(st.includes(g)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(g==="vertical"?tt:he)(a.value,R,k)}function f({height:g,width:R}){let k=!1;h.vertical.value!==g&&(h.vertical.value=g,k=!0),h.horizontal.value!==R&&(h.horizontal.value=R,k=!0),k===!0&&O()}function S({position:g}){let R=!1;i.vertical.position.value!==g.top&&(i.vertical.position.value=g.top,R=!0),i.horizontal.position.value!==g.left&&(i.horizontal.position.value=g.left,R=!0),R===!0&&O()}function b({height:g,width:R}){i.horizontal.size.value!==R&&(i.horizontal.size.value=R,O()),i.vertical.size.value!==g&&(i.vertical.size.value=g,O())}function x(g,R){const k=i[R];if(g.isFirst===!0){if(k.thumbHidden.value===!0)return;d=k.position.value,l.value=!0}else if(l.value!==!0)return;g.isFinal===!0&&(l.value=!1);const w=me[R],$=(k.size.value-h[R].value)/(h[R+"Inner"].value-k.thumbSize.value),L=g.distance[w.dist],B=d+(g.direction===w.dir?1:-1)*L*$;z(B,R)}function q(g,R){const k=i[R];if(k.thumbHidden.value!==!0){const w=R==="vertical"?e.verticalOffset[0]:e.horizontalOffset[0],$=g[me[R].offset]-w,L=k.thumbStart.value-w;if($<L||$>L+k.thumbSize.value){const B=$-k.thumbSize.value/2,ee=te(B/(h[R+"Inner"].value-k.thumbSize.value),0,1);z(ee*Math.max(0,k.size.value-h[R].value),R)}k.ref.value!==null&&k.ref.value.dispatchEvent(new MouseEvent(g.type,g))}}function O(){s.value=!0,y!==null&&clearTimeout(y),y=setTimeout(()=>{y=null,s.value=!1},e.delay),e.onScroll!==void 0&&o()}function z(g,R){a.value[me[R].scroll]=g}let P=null;function j(){P!==null&&clearTimeout(P),P=setTimeout(()=>{P=null,p.value=!0},_.$q.platform.is.ios?50:0)}function C(){P!==null&&(clearTimeout(P),P=null),p.value=!1}let T=null;pe(()=>_.$q.lang.rtl,g=>{a.value!==null&&he(a.value,Math.abs(i.horizontal.position.value)*(g===!0?-1:1))}),_r(()=>{T={top:i.vertical.position.value,left:i.horizontal.position.value}}),gr(()=>{if(T===null)return;const g=a.value;g!==null&&(he(g,T.left),tt(g,T.top))}),br(o.cancel),Object.assign(_,{getScrollTarget:()=>a.value,getScroll:c,getScrollPosition:()=>({top:i.vertical.position.value,left:i.horizontal.position.value}),getScrollPercentage:()=>({top:i.vertical.percentage.value,left:i.horizontal.percentage.value}),setScrollPosition:n,setScrollPercentage(g,R,k){n(g,R*(i[g].size.value-h[g].value)*(g==="horizontal"&&_.$q.lang.rtl===!0?-1:1),k)}});const N={scroll:i,thumbVertDir:[[ot,g=>{x(g,"vertical")},void 0,{vertical:!0,...lt}]],thumbHorizDir:[[ot,g=>{x(g,"horizontal")},void 0,{horizontal:!0,...lt}]],onVerticalMousedown(g){q(g,"vertical")},onHorizontalMousedown(g){q(g,"horizontal")}};return()=>D("div",{class:t.value,onMouseenter:j,onMouseleave:C},[D("div",{ref:a,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[D("div",{class:"q-scrollarea__content absolute",style:r.value},Sr(u.default,[D(it,{debounce:0,onResize:b})])),D(zr,{axis:"both",onScroll:S})]),D(it,{debounce:0,onResize:f}),D(Lr,{store:N,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}}),Dr={ratio:[String,Number]};function Gr(e,u){return I(()=>{const v=Number(e.ratio||(u!==void 0?u.value:void 0));return isNaN(v)!==!0&&v>0?{paddingBottom:`${100/v}%`}:null})}const Wr=1.7778,Qr=Je({name:"QImg",props:{...Dr,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Wr},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:u,emit:v}){const s=M(e.initialRatio),l=Gr(e,s),p=Ut(),{registerTimeout:h,removeTimeout:i}=rt(),{registerTimeout:_,removeTimeout:m}=rt(),y=I(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),d=I(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),a=[M(null),M(y.value)],t=M(0),r=M(!1),c=M(!1),o=I(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),n=I(()=>({width:e.width,height:e.height})),f=I(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),S=I(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function b(){if(m(),e.loadingShowDelay===0){r.value=!0;return}_(()=>{r.value=!0},e.loadingShowDelay)}function x(){m(),r.value=!1}function q({target:T}){ye(p)===!1&&(i(),s.value=T.naturalHeight===0?.5:T.naturalWidth/T.naturalHeight,O(T,1))}function O(T,N){N===1e3||ye(p)===!0||(T.complete===!0?z(T):h(()=>{O(T,N+1)},50))}function z(T){ye(p)!==!0&&(t.value=t.value^1,a[t.value].value=null,x(),T.getAttribute("__qerror")!=="true"&&(c.value=!1),v("load",T.currentSrc||T.src))}function P(T){i(),x(),c.value=!0,a[t.value].value=d.value,a[t.value^1].value=y.value,v("error",T)}function j(T){const N=a[T].value,g={key:"img_"+T,class:f.value,style:S.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...N};return t.value===T?Object.assign(g,{class:g.class+"current",onLoad:q,onError:P}):g.class+="loaded",D("div",{class:"q-img__container absolute-full",key:"img"+T},D("img",g))}function C(){return r.value===!1?D("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Tr(u[c.value===!0?"error":"default"])):D("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},u.loading!==void 0?u.loading():e.noSpinner===!0?void 0:[D(Ar,{color:e.spinnerColor,size:e.spinnerSize})])}{let T=function(){pe(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,N=>{i(),c.value=!1,N===null?(x(),a[t.value^1].value=y.value):b(),a[t.value].value=N},{immediate:!0})};xr.value===!0?Rr(T):T()}return()=>{const T=[];return l.value!==null&&T.push(D("div",{key:"filler",style:l.value})),a[0].value!==null&&T.push(j(0)),a[1].value!==null&&T.push(j(1)),T.push(D(qr,{name:"q-transition--fade"},C)),D("div",{key:"main",class:o.value,style:n.value,role:"img","aria-label":e.alt},T)}}}),Vr={key:0,class:"img-preview"},Ur=Z({__name:"SearchResultItemAttribute",props:{hit:{}},setup(e){const u=e;function v(i){if(i==null)return"";if(typeof i=="string")return i;if(typeof i=="number"||typeof i=="boolean"||typeof i=="bigint")return String(i);if(i instanceof Date)return i.toISOString();if(typeof i=="object")try{return JSON.stringify(i)}catch{return""}return""}const s=I(()=>v(u.hit?.value)),l=I(()=>{const i=v(u.hit?.matchLevel);return{value:s.value,matchLevel:i}}),p=i=>i?(i=String(i),i.startsWith("http://")||i.startsWith("https://")):!1,h=i=>{if(!i)return!1;i=String(i);const _=["jpg","jpeg","png","gif","bmp","svg","webp"],m=i.split(".").pop()?.toLowerCase()||"";return _.includes(m)};return(i,_)=>{const m=W("ais-highlight");return F(),H(K,null,[A(m,{attribute:"a",hit:{_highlightResult:{a:l.value}}},null,8,["hit"]),h(s.value)?(F(),H("div",Vr,[A(Qr,{src:s.value,fit:"contain",class:"img-preview"},null,8,["src"])])):V("",!0),p(s.value)?(F(),Q(X,{key:1,class:"absolute-top-right",flat:"",href:s.value,target:"_blank",size:"sm",padding:"sm",icon:"sym_s_open_in_new",title:"open"},null,8,["href"])):V("",!0)],64)}}}),ct=Kt(Ur,[["__scopeId","data-v-95ee60fc"]]),Kr={key:0},Jr={key:0},Xr={key:1},Yr={key:2},Zr=Z({__name:"SearchResultItemNestedDisplay",props:{item:{},includeFields:{default:()=>[]},embedFields:{default:()=>[]}},setup(e){const u=e;function v(_){return _==null||typeof _!="object"?!1:Object.prototype.hasOwnProperty.call(_,"value")&&Object.prototype.hasOwnProperty.call(_,"matchLevel")}function s(_){return _!=null&&typeof _=="object"&&!Array.isArray(_)}function l(_){return _.some(m=>v(m))}function p(_,m){return _.filter(y=>y.startsWith(m)&&y!==m).map(y=>y.replace(`${m}.`,""))}const h=I(()=>{const _=Object.keys(u.item);return u.includeFields.filter(m=>_.includes(m)).concat(_.filter(m=>!u.includeFields.includes(m)))});function i(_){if(_==null||typeof _!="object")return _;if(Array.isArray(_))return _.map(y=>i(y));if(v(_))return _.value;const m={};for(const y in _)Object.prototype.hasOwnProperty.call(_,y)&&(m[y]=i(_[y]));return m}return(_,m)=>{const y=W("search-result-item-nested-display",!0);return F(),Q(Yt,{dense:""},{default:E(()=>[(F(!0),H(K,null,Y(h.value,d=>(F(),Q(Ye,{key:d},{default:E(()=>[A(fe,{side:"",class:"q-mt-sm text-body2"},{default:E(()=>[A(se,{caption:"",class:at(u.includeFields.includes(d)?"schema-field":"text-warning unknown-field")},{default:E(()=>[J(U(d)+" ",1),Array.isArray(e.item[d])&&e.item[d].length>1?(F(),H("span",Kr,"["+U(e.item[d].length)+"]",1)):V("",!0)]),_:2},1032,["class"]),u.embedFields.includes(d)?V("",!0):(F(),Q(se,{key:0,class:"overflow-hidden text-no-wrap text-ellipsis",title:JSON.stringify(i(e.item[d]),null,2)},{default:E(()=>[Array.isArray(e.item[d])?(F(),H("div",{key:0,class:at(l(e.item[d])?"array-field":"nested-field")},[(F(!0),H(K,null,Y(e.item[d],(a,t)=>(F(),H(K,{key:t},[v(a)?(F(),H("div",Jr,[A(ct,{hit:a},null,8,["hit"])])):(F(),Q(y,{key:1,item:a,"include-fields":p(u.includeFields,d),"embed-fields":p(u.embedFields,d)},null,8,["item","include-fields","embed-fields"]))],64))),128))],2)):(F(),H("div",Xr,[v(e.item[d])?(F(),Q(ct,{key:0,hit:e.item[d]},null,8,["hit"])):s(e.item[d])?(F(),Q(y,{key:1,item:e.item[d],"include-fields":p(u.includeFields,d),"embed-fields":p(u.embedFields,d)},null,8,["item","include-fields","embed-fields"])):(F(),H("span",Yr,U(String(e.item[d])),1))]))]),_:2},1032,["title"]))]),_:2},1024)]),_:2},1024))),128))]),_:1})}}}),ea={key:0,class:"column no-wrap search-result-item"},er=Z({__name:"SearchResultItem",props:{item:{}},emits:["deleted"],setup(e,{emit:u}){const v=e,s=u,l=Xe(),p=Mr(),h=I(()=>l.currentCollection),i=I(()=>!v.item||!h.value||!h.value.fields?[]:h.value.fields.map(d=>d.name)),_=I(()=>!v.item||!h.value||!h.value.fields?[]:h.value.fields.filter(d=>d.embed).map(d=>d.name)),m=()=>{const d={};v.item&&(Object.keys(v.item).forEach(a=>{!a.startsWith("_")&&!["objectID","text_match"].includes(a)&&(d[a]=v.item?.[a])}),l.editDocuments([JSON.parse(JSON.stringify(d))]))},y=d=>{p.dialog({title:"Confirm",message:`Delete document with id: ${d}?`,cancel:!0,persistent:!0}).onOk(()=>{l.deleteDocumentById(d)?.then(()=>{s("deleted",d)}).catch(a=>{p.notify({type:"negative",message:`Error deleting document: ${a.message}`})})})};return(d,a)=>h.value?(F(),H("div",ea,[e.item?(F(),Q(Zr,{key:0,item:e.item._highlightResult,"include-fields":i.value,"embed-fields":_.value},null,8,["item","include-fields","embed-fields"])):V("",!0),A(Er),A(Jt),A(Ye,null,{default:E(()=>[A(fe,null,{default:E(()=>[A(se,null,{default:E(()=>[A(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_edit",title:"Edit",onClick:a[0]||(a[0]=t=>m())})]),_:1})]),_:1}),A(fe,{side:""},{default:E(()=>[A(se,null,{default:E(()=>[A(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_delete_forever",title:"Delete",onClick:a[1]||(a[1]=t=>y(e.item?.id))})]),_:1})]),_:1})]),_:1})])):V("",!0)}}),ta={class:"row"},ra={class:"col-9"},aa={class:"col-3"},na={class:"q-mt-md"},ia={key:1,class:"ais-Hits q-mt-md"},oa={class:"ais-Hits-list"},sa={key:2,class:"text-h5 q-mt-md"},la={key:3},dt="typesense-search-history",ua=Z({__name:"SearchJson",setup(e){const u=Xe(),v=M([]),s=M({q:"stark",query_by:"company_name",filter_by:"num_employees:>100",sort_by:"num_employees:desc",page:1,per_page:10,exhaustive_search:!0}),l=M(null),p=M(null),h=I(()=>u.currentCollection),i=I({get:()=>JSON.stringify(s.value,null,2),set:o=>{try{s.value=JSON.parse(o),l.value=null}catch(n){l.value=n.message}}}),_=I(()=>p.value?.hits?p.value.hits.map(o=>{const n=Object.assign({},o.document),f=S=>{if(S==null)return{value:String(S),matchLevel:"none"};if(Array.isArray(S))return S.map(b=>f(b));if(typeof S=="object"){const b={};for(const x in S)Object.prototype.hasOwnProperty.call(S,x)&&(b[x]=f(S[x]));return b}return{value:String(S),matchLevel:"none"}};return n._highlightResult=f(o.document),o.highlights.forEach(S=>{const b=S.field.split(".");let x=n._highlightResult;for(let O=0;O<b.length-1;O++){const z=b[O];x[z]!==void 0&&(x=x[z])}const q=b[b.length-1];x[q]!==void 0&&(Array.isArray(x[q])?x[q]=x[q].map(O=>typeof O=="object"&&O.value!==void 0?{...O,value:S.snippet,matchLevel:"full"}:{value:S.snippet,matchLevel:"full"}):typeof x[q]=="object"&&x[q].value!==void 0?x[q]={value:S.snippet,matchLevel:"full"}:x[q]={value:S.snippet,matchLevel:"full"})}),n}):[]),m=I(()=>JSON.stringify(p.value,null,2)),y=()=>{p.value&&u.exportToJson(p.value)},d=()=>{if(p.value?.hits){const o=p.value.hits.map(n=>n.document);u.exportToJson(o)}},a=()=>{nt.set(`${dt}-${h.value?.name||""}`,v.value.slice(0,20))},t=()=>{const o=i.value,n=v.value.indexOf(o);n!==0&&(n>0&&v.value.splice(n,1),v.value.unshift(o),a())},r=async()=>{p.value=null,l.value=null,t();try{p.value=await u.search(s.value)}catch(o){l.value=o.message}};return pe(h,()=>{v.value=nt.getItem(`${dt}-${h.value?.name||""}`)||[]},{immediate:!0}),(o,n)=>(F(),H(K,null,[G("div",ta,[G("div",ra,[A($r,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=f=>i.value=f),style:{height:"30vh","min-height":"200px"}},null,8,["modelValue"])]),G("div",aa,[A(Br,{style:{height:"100%"}},{default:E(()=>[A(Yt,{bordered:"",separator:"",dense:""},{default:E(()=>[A(se,{header:""},{default:E(()=>[...n[4]||(n[4]=[J("History",-1)])]),_:1}),(F(!0),H(K,null,Y(v.value,f=>Ke((F(),Q(Ye,{key:f,clickable:"",title:f,onClick:S=>i.value=f},{default:E(()=>[A(fe,null,{default:E(()=>[J(U(f.slice(0,60)),1)]),_:2},1024)]),_:2},1032,["title","onClick"])),[[Or]])),128))]),_:1})]),_:1})])]),l.value?(F(),Q(Zt,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:E(()=>[J(" Invalid Format: "+U(l.value),1)]),_:1})):V("",!0),G("div",na,[A(X,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!l.value,onClick:n[1]||(n[1]=f=>r())},{default:E(()=>[...n[5]||(n[5]=[J("Run Query",-1)])]),_:1},8,["disable"]),A(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!p.value||!p.value.hits,onClick:n[2]||(n[2]=f=>d())},{default:E(()=>[...n[6]||(n[6]=[J("Export Hits",-1)])]),_:1},8,["disable"]),A(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!p.value,onClick:n[3]||(n[3]=f=>y())},{default:E(()=>[...n[7]||(n[7]=[J("Export Raw Results",-1)])]),_:1},8,["disable"])]),_.value?(F(),H("div",ia,[G("ol",oa,[(F(!0),H(K,null,Y(_.value,f=>(F(),H("li",{key:f.id,class:"ais-Hits-item"},[A(er,{item:f},null,8,["item"])]))),128))])])):V("",!0),p.value&&p.value.hits&&p.value.hits.length===0?(F(),H("div",sa," No match found ")):V("",!0),p.value&&!p.value.hits?(F(),H("pre",la,"          "+U(m.value)+`
        `,1)):V("",!0)],64))}}),ca={mixins:[Nr({connector:Hr})],props:{delay:{type:Number,default:200,required:!1}},data(){return{timerId:null,localQuery:""}},computed:{query:{get(){return this.localQuery},set(e){this.localQuery=e,this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.state.refine(this.localQuery)},this.delay)}}},unmounted(){this.timerId&&clearTimeout(this.timerId)},methods:{clear(){this.query=""}}};function da(e,u,v,s,l,p){return F(),Q(Xt,{modelValue:p.query,"onUpdate:modelValue":u[0]||(u[0]=h=>p.query=h),dense:"",autofocus:"",outlined:"",type:"search",clearable:"","clear-icon":"close",placeholder:"Search...",onClear:p.clear},{prepend:E(()=>[A(wr,{name:"search"})]),_:1},8,["modelValue","onClear"])}const fa=Kt(ca,[["render",da]]);var _e={},ge={exports:{}},ft;function le(){return ft||(ft=1,(function(e){function u(v){return v&&v.__esModule?v:{default:v}}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(ge)),ge.exports}var be={exports:{}},Se={exports:{}},pt;function tr(){return pt||(pt=1,(function(e){function u(v,s){this.v=v,this.k=s}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Se)),Se.exports}var xe={exports:{}},Re={exports:{}},vt;function rr(){return vt||(vt=1,(function(e){function u(v,s,l,p){var h=Object.defineProperty;try{h({},"",{})}catch{h=0}e.exports=u=function(_,m,y,d){function a(t,r){u(_,t,function(c){return this._invoke(t,r,c)})}m?h?h(_,m,{value:y,enumerable:!d,configurable:!d,writable:!d}):_[m]=y:(a("next",0),a("throw",1),a("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,u(v,s,l,p)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Re)),Re.exports}var ht;function ar(){return ht||(ht=1,(function(e){var u=rr();function v(){var s,l,p=typeof Symbol=="function"?Symbol:{},h=p.iterator||"@@iterator",i=p.toStringTag||"@@toStringTag";function _(o,n,f,S){var b=n&&n.prototype instanceof y?n:y,x=Object.create(b.prototype);return u(x,"_invoke",(function(q,O,z){var P,j,C,T=0,N=z||[],g=!1,R={p:0,n:0,v:s,a:k,f:k.bind(s,4),d:function($,L){return P=$,j=0,C=s,R.n=L,m}};function k(w,$){for(j=w,C=$,l=0;!g&&T&&!L&&l<N.length;l++){var L,B=N[l],ee=R.p,de=B[2];w>3?(L=de===$)&&(C=B[(j=B[4])?5:(j=3,3)],B[4]=B[5]=s):B[0]<=ee&&((L=w<2&&ee<B[1])?(j=0,R.v=$,R.n=B[1]):ee<de&&(L=w<3||B[0]>$||$>de)&&(B[4]=w,B[5]=$,R.n=de,j=0))}if(L||w>1)return m;throw g=!0,$}return function(w,$,L){if(T>1)throw TypeError("Generator is already running");for(g&&$===1&&k($,L),j=$,C=L;(l=j<2?s:C)||!g;){P||(j?j<3?(j>1&&(R.n=-1),k(j,C)):R.n=C:R.v=C);try{if(T=2,P){if(j||(w="next"),l=P[w]){if(!(l=l.call(P,C)))throw TypeError("iterator result is not an object");if(!l.done)return l;C=l.value,j<2&&(j=0)}else j===1&&(l=P.return)&&l.call(P),j<2&&(C=TypeError("The iterator does not provide a '"+w+"' method"),j=1);P=s}else if((l=(g=R.n<0)?C:q.call(O,R))!==m)break}catch(B){P=s,j=1,C=B}finally{T=1}}return{value:l,done:g}}})(o,f,S),!0),x}var m={};function y(){}function d(){}function a(){}l=Object.getPrototypeOf;var t=[][h]?l(l([][h]())):(u(l={},h,function(){return this}),l),r=a.prototype=y.prototype=Object.create(t);function c(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,a):(o.__proto__=a,u(o,i,"GeneratorFunction")),o.prototype=Object.create(r),o}return d.prototype=a,u(r,"constructor",a),u(a,"constructor",d),d.displayName="GeneratorFunction",u(a,i,"GeneratorFunction"),u(r),u(r,i,"Generator"),u(r,h,function(){return this}),u(r,"toString",function(){return"[object Generator]"}),(e.exports=v=function(){return{w:_,m:c}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(xe)),xe.exports}var qe={exports:{}},Te={exports:{}},Ae={exports:{}},yt;function nr(){return yt||(yt=1,(function(e){var u=tr(),v=rr();function s(l,p){function h(_,m,y,d){try{var a=l[_](m),t=a.value;return t instanceof u?p.resolve(t.v).then(function(r){h("next",r,y,d)},function(r){h("throw",r,y,d)}):p.resolve(t).then(function(r){a.value=r,y(a)},function(r){return h("throw",r,y,d)})}catch(r){d(r)}}var i;this.next||(v(s.prototype),v(s.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),v(this,"_invoke",function(_,m,y){function d(){return new p(function(a,t){h(_,y,a,t)})}return i=i?i.then(d,d):d()},!0)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Ae)),Ae.exports}var mt;function ir(){return mt||(mt=1,(function(e){var u=ar(),v=nr();function s(l,p,h,i,_){return new v(u().w(l,p,h,i),_||Promise)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Te)),Te.exports}var _t;function pa(){return _t||(_t=1,(function(e){var u=ir();function v(s,l,p,h,i){var _=u(s,l,p,h,i);return _.next().then(function(m){return m.done?m.value:_.next()})}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(qe)),qe.exports}var Oe={exports:{}},gt;function va(){return gt||(gt=1,(function(e){function u(v){var s=Object(v),l=[];for(var p in s)l.unshift(p);return function h(){for(;l.length;)if((p=l.pop())in s)return h.value=p,h.done=!1,h;return h.done=!0,h}}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Oe)),Oe.exports}var we={exports:{}},Pe={exports:{}},bt;function ve(){return bt||(bt=1,(function(e){function u(v){"@babel/helpers - typeof";return e.exports=u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},e.exports.__esModule=!0,e.exports.default=e.exports,u(v)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Pe)),Pe.exports}var St;function ha(){return St||(St=1,(function(e){var u=ve().default;function v(s){if(s!=null){var l=s[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],p=0;if(l)return l.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length))return{next:function(){return s&&p>=s.length&&(s=void 0),{value:s&&s[p++],done:!s}}}}throw new TypeError(u(s)+" is not iterable")}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(we)),we.exports}var xt;function ya(){return xt||(xt=1,(function(e){var u=tr(),v=ar(),s=pa(),l=ir(),p=nr(),h=va(),i=ha();function _(){var m=v(),y=m.m(_),d=(Object.getPrototypeOf?Object.getPrototypeOf(y):y.__proto__).constructor;function a(c){var o=typeof c=="function"&&c.constructor;return!!o&&(o===d||(o.displayName||o.name)==="GeneratorFunction")}var t={throw:1,return:2,break:3,continue:3};function r(c){var o,n;return function(f){o||(o={stop:function(){return n(f.a,2)},catch:function(){return f.v},abrupt:function(b,x){return n(f.a,t[b],x)},delegateYield:function(b,x,q){return o.resultName=x,n(f.d,i(b),q)},finish:function(b){return n(f.f,b)}},n=function(b,x,q){f.p=o.prev,f.n=o.next;try{return b(x,q)}finally{o.next=f.n}}),o.resultName&&(o[o.resultName]=f.v,o.resultName=void 0),o.sent=f.v,o.next=f.n;try{return c.call(this,o)}finally{f.p=o.prev,f.n=o.next}}}return(e.exports=_=function(){return{wrap:function(n,f,S,b){return m.w(r(n),f,S,b&&b.reverse())},isGeneratorFunction:a,mark:m.m,awrap:function(n,f){return new u(n,f)},AsyncIterator:p,async:function(n,f,S,b,x){return(a(f)?l:s)(r(n),f,S,b,x)},keys:h,values:i}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=_,e.exports.__esModule=!0,e.exports.default=e.exports})(be)),be.exports}var Ce,Rt;function or(){if(Rt)return Ce;Rt=1;var e=ya()();Ce=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return Ce}var Ie={exports:{}},qt;function sr(){return qt||(qt=1,(function(e){function u(s,l,p,h,i,_,m){try{var y=s[_](m),d=y.value}catch(a){return void p(a)}y.done?l(d):Promise.resolve(d).then(h,i)}function v(s){return function(){var l=this,p=arguments;return new Promise(function(h,i){var _=s.apply(l,p);function m(d){u(_,h,i,m,y,"next",d)}function y(d){u(_,h,i,m,y,"throw",d)}m(void 0)})}}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(Ie)),Ie.exports}var ke={exports:{}},Tt;function ue(){return Tt||(Tt=1,(function(e){function u(v,s){if(!(v instanceof s))throw new TypeError("Cannot call a class as a function")}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(ke)),ke.exports}var Fe={exports:{}},je={exports:{}},ze={exports:{}},At;function ma(){return At||(At=1,(function(e){var u=ve().default;function v(s,l){if(u(s)!="object"||!s)return s;var p=s[Symbol.toPrimitive];if(p!==void 0){var h=p.call(s,l||"default");if(u(h)!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(ze)),ze.exports}var Ot;function lr(){return Ot||(Ot=1,(function(e){var u=ve().default,v=ma();function s(l){var p=v(l,"string");return u(p)=="symbol"?p:p+""}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(je)),je.exports}var wt;function ce(){return wt||(wt=1,(function(e){var u=lr();function v(l,p){for(var h=0;h<p.length;h++){var i=p[h];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(l,u(i.key),i)}}function s(l,p,h){return p&&v(l.prototype,p),h&&v(l,h),Object.defineProperty(l,"prototype",{writable:!1}),l}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports})(Fe)),Fe.exports}var re={},Pt;function _a(){if(Pt)return re;Pt=1;var e=le();Object.defineProperty(re,"__esModule",{value:!0}),re.Configuration=void 0;var u=e(ue()),v=e(ce());return re.Configuration=(function(){function s(){var l,p,h,i,_,m,y,d,a,t,r,c,o,n=this,f,S,b,x,q,O,z,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,u.default)(this,s),this.server=P.server||{nodes:[{host:"localhost",port:"8108",path:"",protocol:"http"}]},this.server.cacheSearchResultsForSeconds=(l=this.server.cacheSearchResultsForSeconds)!==null&&l!==void 0?l:120,this.additionalSearchParameters=(p=P.additionalSearchParameters)!==null&&p!==void 0?p:{},this.additionalSearchParameters.query_by=(h=(i=this.additionalSearchParameters.queryBy)!==null&&i!==void 0?i:this.additionalSearchParameters.query_by)!==null&&h!==void 0?h:"",this.additionalSearchParameters.preset=(_=(m=this.additionalSearchParameters.preset)!==null&&m!==void 0?m:this.additionalSearchParameters.preset)!==null&&_!==void 0?_:"",this.additionalSearchParameters.sort_by=(y=(d=this.additionalSearchParameters.sortBy)!==null&&d!==void 0?d:this.additionalSearchParameters.sort_by)!==null&&y!==void 0?y:"",this.additionalSearchParameters.highlight_full_fields=(a=(t=this.additionalSearchParameters.highlightFullFields)!==null&&t!==void 0?t:this.additionalSearchParameters.highlight_full_fields)!==null&&a!==void 0?a:this.additionalSearchParameters.query_by,this.geoLocationField=(r=P.geoLocationField)!==null&&r!==void 0?r:"_geoloc",this.facetableFieldsWithSpecialCharacters=(c=P.facetableFieldsWithSpecialCharacters)!==null&&c!==void 0?c:[],this.collectionSpecificSearchParameters=(o=P.collectionSpecificSearchParameters)!==null&&o!==void 0?o:{},Object.keys(this.collectionSpecificSearchParameters).forEach(function(j){var C,T,N,g,R,k,w=n.collectionSpecificSearchParameters[j];w.query_by=(C=w.queryBy)!==null&&C!==void 0?C:w.query_by,w.preset=(T=w.preset)!==null&&T!==void 0?T:w.preset,w.sort_by=(N=w.sortBy)!==null&&N!==void 0?N:w.sort_by,w.highlight_full_fields=(g=(R=(k=w.highlightFullFields)!==null&&k!==void 0?k:w.highlight_full_fields)!==null&&R!==void 0?R:n.additionalSearchParameters.highlight_full_fields)!==null&&g!==void 0?g:w.query_by,Object.keys(w).forEach(function($){return w[$]===void 0?delete w[$]:{}})}),this.renderingContent=P.renderingContent,this.flattenGroupedHits=(f=P.flattenGroupedHits)!==null&&f!==void 0?f:!0,this.facetByOptions=(S=P.facetByOptions)!==null&&S!==void 0?S:{},this.filterByOptions=(b=P.filterByOptions)!==null&&b!==void 0?b:{},this.sortByOptions=(x=P.sortByOptions)!==null&&x!==void 0?x:{},this.collectionSpecificFacetByOptions=(q=P.collectionSpecificFacetByOptions)!==null&&q!==void 0?q:{},this.collectionSpecificFilterByOptions=(O=P.collectionSpecificFilterByOptions)!==null&&O!==void 0?O:{},this.collectionSpecificSortByOptions=(z=P.collectionSpecificSortByOptions)!==null&&z!==void 0?z:{}}return(0,v.default)(s,[{key:"validate",value:function(){if((this.additionalSearchParameters.queryBy||Object.values(this.collectionSpecificSearchParameters).some(function(p){return p.queryBy}))&&console.warn("[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version. We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js."),this.additionalSearchParameters.query_by.length===0&&this.additionalSearchParameters.preset.length===0&&(Object.keys(this.collectionSpecificSearchParameters).length===0||Object.values(this.collectionSpecificSearchParameters).some(function(p){return(p.query_by||"").length===0&&(p.preset||"").length===0})))throw new Error("[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.")}}])})(),re}var ae={},$e={exports:{}},Ee={exports:{}},Ct;function ga(){return Ct||(Ct=1,(function(e){function u(v,s){if(v==null)return{};var l={};for(var p in v)if({}.hasOwnProperty.call(v,p)){if(s.indexOf(p)!==-1)continue;l[p]=v[p]}return l}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Ee)),Ee.exports}var It;function ba(){return It||(It=1,(function(e){var u=ga();function v(s,l){if(s==null)return{};var p,h,i=u(s,l);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(s);for(h=0;h<_.length;h++)p=_[h],l.indexOf(p)===-1&&{}.propertyIsEnumerable.call(s,p)&&(i[p]=s[p])}return i}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})($e)),$e.exports}var Me={exports:{}},Ne={exports:{}},kt;function Sa(){return kt||(kt=1,(function(e){function u(v){if(Array.isArray(v))return v}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Ne)),Ne.exports}var He={exports:{}},Ft;function xa(){return Ft||(Ft=1,(function(e){function u(v,s){var l=v==null?null:typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(l!=null){var p,h,i,_,m=[],y=!0,d=!1;try{if(i=(l=l.call(v)).next,s===0){if(Object(l)!==l)return;y=!1}else for(;!(y=(p=i.call(l)).done)&&(m.push(p.value),m.length!==s);y=!0);}catch(a){d=!0,h=a}finally{try{if(!y&&l.return!=null&&(_=l.return(),Object(_)!==_))return}finally{if(d)throw h}}return m}}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(He)),He.exports}var Le={exports:{}},Be={exports:{}},jt;function ur(){return jt||(jt=1,(function(e){function u(v,s){(s==null||s>v.length)&&(s=v.length);for(var l=0,p=Array(s);l<s;l++)p[l]=v[l];return p}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Be)),Be.exports}var zt;function cr(){return zt||(zt=1,(function(e){var u=ur();function v(s,l){if(s){if(typeof s=="string")return u(s,l);var p={}.toString.call(s).slice(8,-1);return p==="Object"&&s.constructor&&(p=s.constructor.name),p==="Map"||p==="Set"?Array.from(s):p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?u(s,l):void 0}}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(Le)),Le.exports}var De={exports:{}},$t;function Ra(){return $t||($t=1,(function(e){function u(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(De)),De.exports}var Et;function dr(){return Et||(Et=1,(function(e){var u=Sa(),v=xa(),s=cr(),l=Ra();function p(h,i){return u(h)||v(h,i)||s(h,i)||l()}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports})(Me)),Me.exports}var Mt;function qa(){if(Mt)return ae;Mt=1;var e=le();Object.defineProperty(ae,"__esModule",{value:!0}),ae.SearchRequestAdapter=void 0;var u=e(or()),v=e(ba()),s=e(sr()),l=e(dr()),p=e(ue()),h=e(ce()),i=["q","conversation","conversation_id","conversation_model_id"];return ae.SearchRequestAdapter=(function(){function _(m,y,d){(0,p.default)(this,_),this.instantsearchRequests=m,this.typesenseClient=y,this.configuration=d,this.additionalSearchParameters=d.additionalSearchParameters,this.collectionSpecificSearchParameters=d.collectionSpecificSearchParameters}return(0,h.default)(_,[{key:"_shouldUseExactMatchForField",value:function(y,d){var a,t;return!(((a=this.configuration.collectionSpecificFilterByOptions)===null||a===void 0||(a=a[d])===null||a===void 0||(a=a[y])===null||a===void 0?void 0:a.exactMatch)===!1||((t=this.configuration.filterByOptions)===null||t===void 0||(t=t[y])===null||t===void 0?void 0:t.exactMatch)===!1)}},{key:"_adaptFacetFilters",value:function(y,d){var a=this,t="";if(!y)return t;var r=y.map(function(c){if(Array.isArray(c)){var o={};c.forEach(function(w){var $=a._parseFacetFilter(w),L=$.fieldName,B=$.fieldValue;o[L]=o[L]||[],o[L].push(B)}),Object.keys(o).length>1&&console.error("[Typesense-Instantsearch-Adapter] Typesense does not support cross-field ORs at the moment. The adapter could not OR values between these fields: ".concat(Object.keys(o).join(",")));var n=Object.keys(o)[0],f=o[n],S=f.reduce(function(w,$){return $.startsWith("-")&&!a._isNumber($)?w[0].push($.substring(1)):w[1].push($),w},[[],[]]),b=(0,l.default)(S,2),x=b[0],q=b[1],O=[];if(q.length>0){var z=a._shouldUseExactMatchForField(n,d)?":=":":";O.push("".concat(n).concat(z,"[").concat(q.map(function(w){return a._escapeFacetValue(w)}).join(","),"]"))}if(x.length>0){var P=a._shouldUseExactMatchForField(n,d)?":!=":":!";O.push("".concat(n).concat(P,"[").concat(x.map(function(w){return a._escapeFacetValue(w)}).join(","),"]"))}var j=O.filter(function(w){return w}).join(" && ");return j}else{var C=a._parseFacetFilter(c),T=C.fieldName,N=C.fieldValue,g;if(N.startsWith("-")&&!a._isNumber(N)){var R=a._shouldUseExactMatchForField(T,d)?":!=":":!";g="".concat(T).concat(R,"[").concat(a._escapeFacetValue(N.substring(1)),"]")}else{var k=a._shouldUseExactMatchForField(T,d)?":=":":";g="".concat(T).concat(k,"[").concat(a._escapeFacetValue(N),"]")}return g}});return t=r.join(" && "),t}},{key:"_parseFacetFilter",value:function(y){var d,a,t,r,c;if(((d=this.configuration.facetableFieldsWithSpecialCharacters)===null||d===void 0?void 0:d.length)>0){var o=this.configuration.facetableFieldsWithSpecialCharacters.flat().map(function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(a=new RegExp("^(".concat(o.join("|"),"):(.*)$")),t=y.match(a),t!=null)return r="".concat(t[1]),c="".concat(t[2]),{fieldName:r,fieldValue:c}}return a=this.constructor.DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX,t=y.match(a),t==null?console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a facet filter `".concat(y,"` with the Regex `").concat(a,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter.")):(r="".concat(t[1]).concat(t[2]),c="".concat(t[3])),{fieldName:r,fieldValue:c}}},{key:"_escapeFacetValue",value:function(y){return typeof y=="boolean"||y==="true"||y==="false"||this._isNumber(y)?y:"`".concat(y,"`")}},{key:"_isNumber",value:function(y){return Number.isInteger(y%1)||!!(y%1)}},{key:"_adaptNumericFilters",value:function(y){var d=this,a="";if(!y)return a;var t={};y.forEach(function(c){var o=d._parseNumericFilter(c),n=o.fieldName,f=o.operator,S=o.fieldValue;t[n]=t[n]||{},t[n][f]=S});var r=[];return Object.keys(t).forEach(function(c){t[c]["<="]!=null&&t[c][">="]!=null?r.push("".concat(c,":=[").concat(t[c][">="],"..").concat(t[c]["<="],"]")):t[c]["<="]!=null?r.push("".concat(c,":<=").concat(t[c]["<="])):t[c][">="]!=null?r.push("".concat(c,":>=").concat(t[c][">="])):t[c]["="]!=null?r.push("".concat(c,":=").concat(t[c]["="])):console.warn("[Typesense-Instantsearch-Adapter] Unsupported operator found ".concat(JSON.stringify(t[c])))}),a=r.join(" && "),a}},{key:"_parseNumericFilter",value:function(y){var d,a,t,r,c,o;if(((d=this.configuration.facetableFieldsWithSpecialCharacters)===null||d===void 0?void 0:d.length)>0){var n=this.configuration.facetableFieldsWithSpecialCharacters.map(function(q){return q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(a=new RegExp("^(".concat(n.join("|"),")(<=|>=|>|<|=)(.*)$")),t=y.match(a),t!=null){var f=t,S=(0,l.default)(f,4);return r=S[1],c=S[2],o=S[3],{fieldName:r,operator:c,fieldValue:o}}}if(a=this.constructor.DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX,t=y.match(a),t==null)console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a numeric filter `".concat(y,"` with the Regex `").concat(a,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter."));else{var b=t,x=(0,l.default)(b,4);r=x[1],c=x[2],o=x[3]}return{fieldName:r,operator:c,fieldValue:o}}},{key:"_adaptGeoFilter",value:function(y){var d=y.insideBoundingBox,a=y.aroundRadius,t=y.aroundLatLng,r=y.insidePolygon;if(d){var c,o,n,f;if(Array.isArray(d)){var S=d.flat(),b=(0,l.default)(S,4);c=b[0],o=b[1],n=b[2],f=b[3]}else{var x=d.split(","),q=(0,l.default)(x,4);c=q[0],o=q[1],n=q[2],f=q[3]}return"".concat(this.configuration.geoLocationField,":(").concat(c,", ").concat(o,", ").concat(c,", ").concat(f,", ").concat(n,", ").concat(f,", ").concat(n,", ").concat(o,")")}if(t||a){if(!a||a==="all")throw new Error("[Typesense-Instantsearch-Adapter] In Typesense, geo-filtering around a lat/lng also requires a numerical radius. So the `aroundRadius` parameter is required when `aroundLatLng` is used. If you intend to just geo-sort around a lat/long, you want to use the sortBy InstantSearch widget (or a virtual sortBy custom widget).");var O="".concat(parseFloat(a)/1e3," km");return"".concat(this.configuration.geoLocationField,":(").concat(t,", ").concat(O,")")}if(r){var z=r;return Array.isArray(r)&&(z=r.flat().join(",")),"".concat(this.configuration.geoLocationField,":(").concat(z,")")}}},{key:"_adaptFilters",value:function(y,d){var a=[];return y.filters&&a.push(y.filters),a.push(this._adaptFacetFilters(y.facetFilters,d)),a.push(this._adaptNumericFilters(y.numericFilters)),a.push(this._adaptGeoFilter(y)),a.filter(function(t){return t&&t!==""}).join(" && ")}},{key:"_adaptIndexName",value:function(y){return y.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[1]}},{key:"_adaptSortBy",value:function(y){return y.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[3]}},{key:"_adaptFacetBy",value:function(y,d){var a=this;return[y].flat().map(function(t){var r;return(r=a.configuration.collectionSpecificFacetByOptions)!==null&&r!==void 0&&(r=r[d])!==null&&r!==void 0&&r[t]?"".concat(t).concat(a.configuration.collectionSpecificFacetByOptions[d][t]):a.configuration.facetByOptions[t]?"".concat(t).concat(a.configuration.facetByOptions[t]):t}).join(",")}},{key:"_adaptRulesContextsToOverrideTags",value:function(y){return y.join(",")}},{key:"_buildSearchParameters",value:function(y){for(var d,a,t=y.params,r=y.indexName,c=this._adaptIndexName(r),o={},n=0,f=Object.entries(this.additionalSearchParameters);n<f.length;n++){var S=(0,l.default)(f[n],2),b=S[0],x=S[1];o[this._camelToSnakeCase(b)]=x}if(this.collectionSpecificSearchParameters[c])for(var q=0,O=Object.entries(this.collectionSpecificSearchParameters[c]);q<O.length;q++){var z=(0,l.default)(O[q],2),P=z[0],j=z[1];o[this._camelToSnakeCase(P)]=j}var C=Object.assign({},o),T=this._adaptSortBy(r);Object.assign(C,{collection:c,q:t.query===""||t.query===void 0?"*":t.query,facet_by:o.facet_by||this._adaptFacetBy(t.facets,c),filter_by:this._adaptFilters(t,c)||o.filter_by,sort_by:T||o.sort_by,max_facet_values:t.maxValuesPerFacet,page:(t.page||0)+1}),t.hitsPerPage!=null&&(C.per_page=t.hitsPerPage),t.facetQuery&&(C.facet_query="".concat(t.facetName,":").concat(t.facetQuery),C.per_page=0),t.ruleContexts&&t.ruleContexts.length>0&&(C.override_tags=this._adaptRulesContextsToOverrideTags(t.ruleContexts)),t.typesenseVectorQuery&&(C.vector_query=t.typesenseVectorQuery);var N=((d=this.configuration.collectionSpecificSortByOptions)===null||d===void 0||(d=d[c])===null||d===void 0?void 0:d[C.sort_by])||((a=this.configuration.sortByOptions)===null||a===void 0?void 0:a[C.sort_by]);return N?.enable_overrides!=null&&(C.enable_overrides=N.enable_overrides),Object.fromEntries(Object.entries(C).filter(function(g){var R=(0,l.default)(g,2);R[0];var k=R[1];return k!=null&&k!==""}))}},{key:"_camelToSnakeCase",value:function(y){return y.split(/(?=[A-Z])/).join("_").toLowerCase()}},{key:"request",value:(function(){var m=(0,s.default)(u.default.mark(function d(){var a=this,t,r,c,o,n,f,S,b,x;return u.default.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return c=this.instantsearchRequests.map(function(z){return a._buildSearchParameters(z)}),o={},(((t=c[0])===null||t===void 0?void 0:t.conversation)===!0||((r=c[0])===null||r===void 0?void 0:r.conversation)==="true")&&(n=c[0],f=n.q,S=n.conversation,b=n.conversation_id,x=n.conversation_model_id,o={q:f,conversation:S,conversation_id:b,conversation_model_id:x},c=c.map(function(z){z.q,z.conversation,z.conversation_id,z.conversation_model_id;var P=(0,v.default)(z,i);return P})),O.abrupt("return",this.typesenseClient.multiSearch.perform({searches:c},o));case 4:case"end":return O.stop()}},d,this)}));function y(){return m.apply(this,arguments)}return y})()}],[{key:"INDEX_NAME_MATCHING_REGEX",get:function(){return new RegExp("^(.+?)(?=(/sort/(.*))|$)")}},{key:"DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*)((?!:).):(?!:)(.*)")}},{key:"DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*?)(<=|>=|>|<|=)(.*)")}}])})(),ae}var ne={},Ge={exports:{}},We={exports:{}},Nt;function Ta(){return Nt||(Nt=1,(function(e){var u=ur();function v(s){if(Array.isArray(s))return u(s)}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(We)),We.exports}var Qe={exports:{}},Ht;function Aa(){return Ht||(Ht=1,(function(e){function u(v){if(typeof Symbol<"u"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Qe)),Qe.exports}var Ve={exports:{}},Lt;function Oa(){return Lt||(Lt=1,(function(e){function u(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports})(Ve)),Ve.exports}var Bt;function wa(){return Bt||(Bt=1,(function(e){var u=Ta(),v=Aa(),s=cr(),l=Oa();function p(h){return u(h)||v(h)||s(h)||l()}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports})(Ge)),Ge.exports}var Ue={exports:{}},Dt;function Pa(){return Dt||(Dt=1,(function(e){var u=lr();function v(s,l,p){return(l=u(l))in s?Object.defineProperty(s,l,{value:p,enumerable:!0,configurable:!0,writable:!0}):s[l]=p,s}e.exports=v,e.exports.__esModule=!0,e.exports.default=e.exports})(Ue)),Ue.exports}var ie={},Gt;function fr(){return Gt||(Gt=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.utils=void 0,ie.utils={_adaptHighlightTag:function(u,v,s){return u.replace(new RegExp("<mark>","g"),v||"<mark>").replace(new RegExp("</mark>","g"),s||"</mark>")},_adaptNumberOfPages:function(){var u=this.typesenseResponse.found/this.typesenseResponse.request_params.per_page;return Number.isFinite(u)?Math.ceil(u):1}}),ie}var Wt;function Ca(){if(Wt)return ne;Wt=1;var e=le();Object.defineProperty(ne,"__esModule",{value:!0}),ne.SearchResponseAdapter=void 0;var u=e(ve()),v=e(dr()),s=e(wa()),l=e(Pa()),p=e(ue()),h=e(ce()),i=fr();function _(d,a){var t=Object.keys(d);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(d);a&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(d,c).enumerable})),t.push.apply(t,r)}return t}function m(d){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?_(Object(t),!0).forEach(function(r){(0,l.default)(d,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach(function(r){Object.defineProperty(d,r,Object.getOwnPropertyDescriptor(t,r))})}return d}var y=ne.SearchResponseAdapter=(function(){function d(a,t,r){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};(0,p.default)(this,d),this.typesenseResponse=a,this.instantsearchRequest=t,this.configuration=r,this.allTypesenseResults=c,this.fullTypesenseResponse=o}return(0,h.default)(d,[{key:"_adaptGroupedHits",value:function(t){var r=this,c=[];return c=t.map(function(o){var n=r._adaptHits(o.hits);return n.forEach(function(f){f.group_key=f._group_key=o.group_key,o.found&&(f._group_found=o.found)}),n}),this.configuration.flattenGroupedHits?c=c.flat():c=c.map(function(o){return m(m({},o[0]),{},{_grouped_hits:o})}),c}},{key:"_adaptHits",value:function(t){var r=this,c=[];return c=t.map(function(o){var n=m({},o.document);n.objectID=o.document.id,n._snippetResult=r._adaptHighlightResult(o,"snippet"),n._highlightResult=r._adaptHighlightResult(o,"value"),n._rawTypesenseHit=o,r.fullTypesenseResponse.conversation&&(n._rawTypesenseConversation=r.fullTypesenseResponse.conversation),["text_match","geo_distance_meters","curated","text_match_info","hybrid_search_info","vector_distance"].forEach(function(S){Object.keys(o).includes(S)&&!Object.keys(n).includes(S)&&(n[S]=o[S])});var f=n[r.configuration.geoLocationField];return f&&(n._geoloc={lat:f[0],lng:f[1]}),n}),c}},{key:"_adaptHighlightResult",value:function(t,r){var c={};return t.highlight!=null&&this.isHighlightPost0240RCN32Format(t.highlight)?this.adaptHighlightObject(t,c,r):this.adaptHighlightsArray(t,c,r),c}},{key:"isHighlightPost0240RCN32Format",value:function(t){return t.full==null&&t.snippet==null}},{key:"adaptHighlightsArray",value:function(t,r,c){var o=this;Object.assign.apply(Object,[r].concat((0,s.default)(Object.entries(t.document).map(function(n){var f=(0,v.default)(n,2),S=f[0],b=f[1];return(0,l.default)({},S,{value:b,matchLevel:"none",matchedWords:[]})})))),t.highlights.forEach(function(n){r[n.field]={value:n[c]||n["".concat(c,"s")],matchLevel:"full",matchedWords:n.matched_tokens},n.indices&&(r[n.field].matchedIndices=n.indices)}),Object.entries(r).forEach(function(n){var f=(0,v.default)(n,2),S=f[0],b=f[1],x=S,q=b.value,O=b.matchLevel,z=b.matchedWords,P=b.matchedIndices;q==null?r[x]=o._adaptHighlightNullValue():Array.isArray(q)?(r[x]=[],t.document[x].forEach(function(j,C){P&&P.includes(C)?r[x].push({value:o._adaptHighlightTag("".concat(q[P.indexOf(C)]),o.instantsearchRequest.params.highlightPreTag,o.instantsearchRequest.params.highlightPostTag),matchLevel:O,matchedWords:z[C]}):(0,u.default)(j)==="object"?r[x].push(o._adaptHighlightInObjectValue(j,{},c)):r[x].push({value:"".concat(j),matchLevel:"none",matchedWords:[]})})):(0,u.default)(q)==="object"?r[x]=o._adaptHighlightInObjectValue(q,{},c):r[x].value=o._adaptHighlightTag("".concat(q),o.instantsearchRequest.params.highlightPreTag,o.instantsearchRequest.params.highlightPostTag)})}},{key:"adaptHighlightObject",value:function(t,r,c){Object.assign(r,this._adaptHighlightInObjectValue(t.document,t.highlight,c))}},{key:"_adaptHighlightInObjectValue",value:function(t,r,c){var o=this;return Object.assign.apply(Object,[{}].concat((0,s.default)(Object.entries(t).map(function(n){var f=(0,v.default)(n,2),S=f[0],b=f[1],x;if(b==null)x=o._adaptHighlightNullValue();else if(Array.isArray(b)){var q;x=o._adaptHighlightInArrayValue(b,(q=r?.[S])!==null&&q!==void 0?q:[],c)}else if((0,u.default)(b)==="object"){var O;x=o._adaptHighlightInObjectValue(b,(O=r?.[S])!==null&&O!==void 0?O:{},c)}else x=o._adaptHighlightInPrimitiveValue(b,r?.[S],c);return(0,l.default)({},S,x)}))))}},{key:"_adaptHighlightInArrayValue",value:function(t,r,c){var o=this;return t.map(function(n,f){var S;if(n==null)S=o._adaptHighlightNullValue();else if(Array.isArray(n)){var b;S=o._adaptHighlightInArrayValue(n,(b=r?.[f])!==null&&b!==void 0?b:[],c)}else if((0,u.default)(n)==="object"){var x;S=o._adaptHighlightInObjectValue(n,(x=r?.[f])!==null&&x!==void 0?x:{},c)}else S=o._adaptHighlightInPrimitiveValue(n,r?.[f],c);return S})}},{key:"_adaptHighlightInPrimitiveValue",value:function(t,r,c){if(r!=null){var o,n;return{value:this._adaptHighlightTag("".concat((o=(n=r[c])!==null&&n!==void 0?n:r.highlight)!==null&&o!==void 0?o:r.snippet),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:(r.matched_tokens||[]).length>0?"full":"none",matchedWords:r.matched_tokens||[]}}else return{value:this._adaptHighlightTag("".concat(t),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:"none",matchedWords:[]}}},{key:"_adaptHighlightNullValue",value:function(){return{value:"",matchLevel:"none",matchedWords:[]}}},{key:"_adaptFacets",value:function(t){var r={};return t.forEach(function(c){Object.assign(r,(0,l.default)({},c.field_name,Object.assign.apply(Object,[{}].concat((0,s.default)(c.counts.map(function(o){return(0,l.default)({},o.value,o.count)}))))))}),r}},{key:"_adaptFacetStats",value:function(t){var r={};return t.forEach(function(c){Object.keys(c.stats).length>0&&Object.assign(r,(0,l.default)({},c.field_name,c.stats))}),r}},{key:"_adaptRenderingContent",value:function(t){var r,c=Object.assign({},this.configuration.renderingContent);return((r=c.facetOrdering)===null||r===void 0||(r=r.facets)===null||r===void 0?void 0:r.order)==null&&(c.facetOrdering=c.facetOrdering||{},c.facetOrdering.facets=c.facetOrdering.facets||{},c.facetOrdering.facets.order=(0,s.default)(new Set(t.map(function(o){return o.field_name}).concat(this.allTypesenseResults.map(function(o){return o.facet_counts||[]}).flat().map(function(o){return o.field_name}).filter(function(o){return o}))))),c}},{key:"_adaptUserData",value:function(t){return t?Array.isArray(t)?t:[t]:[]}},{key:"adapt",value:function(){var t=this._adaptRenderingContent(this.typesenseResponse.facet_counts||[]),r=m({hits:this.typesenseResponse.grouped_hits?this._adaptGroupedHits(this.typesenseResponse.grouped_hits):this._adaptHits(this.typesenseResponse.hits),nbHits:this.typesenseResponse.found,page:this.typesenseResponse.page-1,nbPages:this._adaptNumberOfPages(),hitsPerPage:this.typesenseResponse.request_params.per_page,facets:this._adaptFacets(this.typesenseResponse.facet_counts||[]),facets_stats:this._adaptFacetStats(this.typesenseResponse.facet_counts||{}),query:this.typesenseResponse.request_params.q,processingTimeMS:this.typesenseResponse.search_time_ms},Object.keys(t).length>0?{renderingContent:t}:null);return this.typesenseResponse.metadata&&(r.appliedRules=["typesense-override"],r.userData=this._adaptUserData(this.typesenseResponse.metadata)),this.fullTypesenseResponse.conversation&&r.hits.length===0&&(r.hits=[{_rawTypesenseConversation:this.fullTypesenseResponse.conversation}]),r}}])})();return Object.assign(y.prototype,i.utils),ne}var oe={},Qt;function Ia(){if(Qt)return oe;Qt=1;var e=le();Object.defineProperty(oe,"__esModule",{value:!0}),oe.FacetSearchResponseAdapter=void 0;var u=e(ue()),v=e(ce()),s=fr(),l=oe.FacetSearchResponseAdapter=(function(){function p(h,i){(0,u.default)(this,p),this.typesenseResponse=h,this.instantsearchRequest=i}return(0,v.default)(p,[{key:"_adaptFacetHits",value:function(i){var _=this,m={},y=i.find(function(d){return d.field_name===_.instantsearchRequest.params.facetName});return m=y.counts.map(function(d){return{value:d.value,highlighted:_._adaptHighlightTag(d.highlighted,_.instantsearchRequest.params.highlightPreTag,_.instantsearchRequest.params.highlightPostTag),count:d.count}}),m}},{key:"adapt",value:function(){var i={facetHits:this._adaptFacetHits(this.typesenseResponse.facet_counts),exhaustiveFacetsCount:!0,processingTimeMS:this.typesenseResponse.search_time_ms};return i}}])})();return Object.assign(l.prototype,s.utils),oe}var Vt;function ka(){return Vt||(Vt=1,(function(e){var u=le();Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var v=u(or()),s=u(sr()),l=u(ue()),p=u(ce()),h=_a(),i=Pr(),_=qa(),m=Ca(),y=Ia();e.default=(function(){function d(a){var t=this;(0,l.default)(this,d),this.updateConfiguration(a),this.searchClient={clearCache:function(){return t.clearCache()},search:function(c){return t.searchTypesenseAndAdapt(c)},searchForFacetValues:function(c){return t.searchTypesenseForFacetValuesAndAdapt(c)}}}return(0,p.default)(d,[{key:"searchTypesenseAndAdapt",value:(function(){var a=(0,s.default)(v.default.mark(function r(c){var o=this,n,f;return v.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,this._adaptAndPerformTypesenseRequest(c);case 3:return n=b.sent,f=n.results.map(function(x,q){o._validateTypesenseResult(x);var O=new m.SearchResponseAdapter(x,c[q],o.configuration,n.results,n),z=O.adapt();return z}),b.abrupt("return",{results:f});case 8:throw b.prev=8,b.t0=b.catch(0),console.error(b.t0),b.t0;case 12:case"end":return b.stop()}},r,this,[[0,8]])}));function t(r){return a.apply(this,arguments)}return t})()},{key:"searchTypesenseForFacetValuesAndAdapt",value:(function(){var a=(0,s.default)(v.default.mark(function r(c){var o=this,n,f;return v.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,this._adaptAndPerformTypesenseRequest(c);case 3:return n=b.sent,f=n.results.map(function(x,q){o._validateTypesenseResult(x);var O=new y.FacetSearchResponseAdapter(x,c[q],o.configuration);return O.adapt()}),b.abrupt("return",f);case 8:throw b.prev=8,b.t0=b.catch(0),console.error(b.t0),b.t0;case 12:case"end":return b.stop()}},r,this,[[0,8]])}));function t(r){return a.apply(this,arguments)}return t})()},{key:"_adaptAndPerformTypesenseRequest",value:(function(){var a=(0,s.default)(v.default.mark(function r(c){var o,n;return v.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return o=new _.SearchRequestAdapter(c,this.typesenseClient,this.configuration),S.next=3,o.request();case 3:return n=S.sent,S.abrupt("return",n);case 5:case"end":return S.stop()}},r,this)}));function t(r){return a.apply(this,arguments)}return t})()},{key:"clearCache",value:function(){return this.typesenseClient=new i.SearchClient(this.configuration.server),this.searchClient}},{key:"updateConfiguration",value:function(t){return this.configuration=new h.Configuration(t),this.configuration.validate(),this.typesenseClient=new i.SearchClient(this.configuration.server),!0}},{key:"_validateTypesenseResult",value:function(t){if(t.error)throw new Error("".concat(t.code," - ").concat(t.error));if(!t.hits&&!t.grouped_hits)throw new Error("Did not find any hits. ".concat(t.code," - ").concat(t.error))}}])})()})(_e)),_e}var Fa=ka();const ja=Cr(Fa),za={class:"row q-mt-md"},$a={class:"col-3 q-pr-sm"},Ea={class:"text-subtitle2 q-pt-md"},Ma={class:"text-subtitle2 q-pt-md"},Na={class:"text-subtitle2 q-pt-md"},Ha={class:"col-9"},La={key:1},Ba=Z({__name:"SearchInstantSearch",setup(e){const u=Xe(),v=M(null),s=M(),l=M(),p=M(null),h=M(null),i=M(4),_=[({instantSearchInstance:n})=>({subscribe(){l.value=n},unsubscribe(){l.value=null}})],m=I(()=>u.currentCollection),y=I(()=>!m.value||!m.value.fields?[]:m.value.fields.filter(n=>n.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name)),d=I(()=>!m.value||!m.value.fields?[]:m.value.fields.filter(n=>n.facet&&["string","string[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name)),a=I(()=>!m.value||!m.value.fields?[]:m.value.fields.filter(n=>n.facet&&["bool","bool[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name)),t=I(()=>{if(!m.value||!m.value.fields)return[];const n=[{value:m.value.name,label:"Default"}];return m.value.fields.filter(f=>["int32","float"].includes(f.type)||f.type==="string"&&f.sort).forEach(f=>{m.value&&(n.push({value:`${m.value.name}/sort/${f.name}:asc`,label:`${f.name} asc`}),n.push({value:`${m.value.name}/sort/${f.name}:desc`,label:`${f.name} desc`}))}),n}),r=I(()=>u.data.stopwords.map(n=>n.id)),c=()=>{l.value&&m.value&&u.exportToJson(l.value.renderState[m.value.name].hits.results.hits)},o=()=>{s.value&&m.value&&s.value.updateConfiguration({...s.value.configuration,additionalSearchParameters:{...s.value.configuration.additionalSearchParameters,stopwords:h.value,max_candidates:i.value}})};return pe(()=>m.value,()=>{v.value=null,p.value=null,window.setTimeout(()=>{if(!u.loginData||!m.value)return;const n=(m.value?.fields||[]).filter(f=>f.index&&["string","string[]"].includes(f.type)&&!f.name.includes(".*")).map(f=>f.name).join(",");try{const f=new ja({server:{nodes:[{...u.loginData.node}],apiKey:u.loginData.apiKey},additionalSearchParameters:{max_candidates:i.value,query_by:n}});s.value=f,v.value=f.searchClient}catch(f){p.value=f.message+"Using query_by: "+n,console.error(f)}})},{immediate:!0}),(n,f)=>{const S=W("ais-configure"),b=W("ais-search-box"),x=W("ais-stats"),q=W("ais-current-refinements"),O=W("ais-hits-per-page"),z=W("ais-sort-by"),P=W("ais-range-input"),j=W("ais-refinement-list"),C=W("ais-pagination"),T=W("ais-hits"),N=W("ais-instant-search");return v.value&&m.value?(F(),Q(N,{key:0,"search-client":v.value,"index-name":m.value.name,middlewares:_},{default:E(()=>[A(S,{hitsPerPage:12}),A(b,{"index-name":"instant_search","search-client":v.value},{default:E(()=>[A(fa)]),_:1},8,["search-client"]),A(x),A(q),G("div",za,[G("div",$a,[A(O,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"250 hits per page",value:250}]}),A(X,{flat:"",onClick:f[0]||(f[0]=g=>c())},{default:E(()=>[...f[6]||(f[6]=[J("export current page",-1)])]),_:1}),f[7]||(f[7]=G("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1)),A(z,{items:t.value},null,8,["items"]),f[8]||(f[8]=G("div",{class:"text-subtitle2 q-pt-md"},"Stopwords",-1)),A(jr,{modelValue:h.value,"onUpdate:modelValue":[f[1]||(f[1]=g=>h.value=g),f[2]||(f[2]=g=>o())],disable:!Ir(u).data.features.stopwords,outlined:"",clearable:"",dense:"","options-dense":"",options:r.value},null,8,["modelValue","disable","options"]),f[9]||(f[9]=G("div",{class:"text-subtitle2 q-pt-md"},"Max Candidates",-1)),A(Xt,{modelValue:i.value,"onUpdate:modelValue":[f[3]||(f[3]=g=>i.value=g),f[4]||(f[4]=g=>o())],modelModifiers:{number:!0},type:"number",outlined:"",dense:"",min:0,max:1e4,hint:"Number of similar words for prefix and typo searching"},null,8,["modelValue"]),(F(!0),H(K,null,Y(y.value,g=>(F(),H("div",{key:g,class:"q-mb-sm"},[G("div",Ea,U(g),1),A(P,{searchable:!0,attribute:g},null,8,["attribute"])]))),128)),(F(!0),H(K,null,Y(d.value,g=>(F(),H("div",{key:g,class:"q-mb-sm"},[G("div",Ma,U(g),1),A(j,{class:"q-mb-sm",searchable:!0,attribute:g},null,8,["attribute"])]))),128)),(F(!0),H(K,null,Y(a.value,g=>(F(),H("div",{key:g,class:"q-mb-sm"},[G("div",Na,U(g),1),A(j,{class:"q-mb-sm",attribute:g},null,8,["attribute"])]))),128))]),G("div",Ha,[A(C,{class:"q-mb-md"}),A(T,null,kr({_:2},[m.value?{name:"item",fn:E(({item:g})=>[A(er,{item:g,onDeleted:f[5]||(f[5]=R=>l.value.refresh())},null,8,["item"])]),key:"0"}:void 0]),1024),A(C,{class:"q-my-md"})])])]),_:1},8,["search-client","index-name"])):p.value?(F(),H("div",La,[A(Zt,{"inline-actions":"",class:"text-white bg-red"},{default:E(()=>[J(U(p.value),1)]),_:1})])):V("",!0)}}}),nn=Z({__name:"Search",setup(e){const u=M("form");return(v,s)=>(F(),Q(Fr,{padding:""},{default:E(()=>[A(pr,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=l=>u.value=l),dense:"",class:"bg-primary text-white",align:"justify","narrow-indicator":""},{default:E(()=>[A(Ze,{name:"form",label:"InstantSearch Mode"}),A(Ze,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),A(Jt),A(vr,{modelValue:u.value,"onUpdate:modelValue":s[1]||(s[1]=l=>u.value=l),animated:"","keep-alive":""},{default:E(()=>[A(et,{name:"form"},{default:E(()=>[A(Ba)]),_:1}),A(et,{name:"json",class:"q-pa-none"},{default:E(()=>[A(ua)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{nn as default};
