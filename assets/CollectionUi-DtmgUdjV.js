import{Q as k,a as V,b as Q,c as b}from"./QTabPanels-CcHMvx2K.js";import{K as S,_ as N,V as j,L as i,M as n,N as s,O as o,T as u,aM as M,a3 as y,a1 as p,a4 as q,a7 as m,a5 as _,a6 as w,a2 as g,Y as f,a8 as h,aN as d,W as c,R as r,X as U}from"./index-COFOeL2T.js";import{c as v}from"./QSelect-2an0Xdjf.js";import{Q as J}from"./QBanner-7Mldg0mA.js";import{M as O}from"./MonacoEditor-BaqsUY8n.js";const $=S({name:"CollectionUi",components:{MonacoEditor:O},props:{initialSchema:{type:Object,default:()=>({name:"",fields:[{name:"",type:"string",facet:!1,optional:!1,index:!0,sort:!1,infix:!1,stem:!1,locale:"",num_dim:void 0}],default_sorting_field:"",token_separators:[],symbols_to_index:[],enable_nested_fields:!1})},primaryActionLabel:{type:String,required:!0},createMode:{type:Boolean,default:!1}},emits:["submit"],data(){return{tab:"form",schema:{name:"",fields:[],default_sorting_field:"",token_separators:[],symbols_to_index:[],enable_nested_fields:!1},types:["string","string[]","int32","int32[]","int64","int64[]","float","float[]","bool","bool[]","geopoint","geopoint[]","object","object[]","string*","auto"],jsonError:null}},computed:{availableSortFields(){const a=(this.schema.fields||[]).filter(l=>["int32","float"].includes(l.type)||l.type==="string"&&l.sort);return[""].concat(a.map(l=>l.name))},schemaJson:{get(){return JSON.stringify(this.schema,null,2)},set(a){try{this.schema=JSON.parse(a),this.jsonError=null}catch(l){this.jsonError=l.message}}}},watch:{initialSchema:{immediate:!0,handler(a){this.schema=JSON.parse(JSON.stringify(a))}}},methods:{addField(){this.schema.fields&&this.schema.fields.push({name:"",type:"string",facet:!1,optional:!1,index:!0,sort:!1,infix:!1,stem:!1,locale:"",num_dim:void 0})},removeField(a){if(this.schema.fields){const l=this.schema.fields.indexOf(a);l>-1&&this.schema.fields.splice(l,1)}}}}),B={class:"row q-gutter-md"};function E(a,l,T,z,A,L){const C=j("monaco-editor");return n(),i(g,null,{default:s(()=>[o(k,{modelValue:a.tab,"onUpdate:modelValue":l[0]||(l[0]=e=>a.tab=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[o(V,{name:"form",label:"Form Mode"}),o(V,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),o(u),o(Q,{modelValue:a.tab,"onUpdate:modelValue":l[4]||(l[4]=e=>a.tab=e),animated:"",style:M(a.createMode?"height: 60vh":""),class:"bg-surface"},{default:s(()=>[o(b,{name:"form"},{default:s(()=>[o(y,null,{default:s(()=>[p("div",B,[o(m,{modelValue:a.schema.name,"onUpdate:modelValue":l[1]||(l[1]=e=>a.schema.name=e),class:"col",filled:"",dense:"",label:"Collection Name",placeholder:"books",disable:!a.createMode,rules:[e=>!!e||"Field is required"]},null,8,["modelValue","disable","rules"]),o(v,{modelValue:a.schema.default_sorting_field,"onUpdate:modelValue":l[2]||(l[2]=e=>a.schema.default_sorting_field=e),filled:"",class:"col",dense:"",options:a.availableSortFields,label:"Default sort field optional, but must be int32 or float"},null,8,["modelValue","options"])]),l[8]||(l[8]=p("div",{class:"text-subtitle1 q-pt-md"},"Fields",-1)),(n(!0),q(_,null,w(a.schema.fields,(e,F)=>(n(),i(g,{key:F,flat:"",bordered:"",class:"q-mb-md"},{default:s(()=>[o(y,{class:"row q-col-gutter-md"},{default:s(()=>[o(m,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,class:"col-12 col-sm-6",dense:"",outlined:"",label:"Field Name",placeholder:"title",rules:[t=>!!t||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),o(v,{modelValue:e.type,"onUpdate:modelValue":t=>e.type=t,class:"col-12 col-sm-4",dense:"",outlined:"",label:"type",options:a.types,rules:[t=>!!t||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","options","rules"]),e.type==="float[]"?(n(),i(m,{key:0,modelValue:e.num_dim,"onUpdate:modelValue":t=>e.num_dim=t,modelModifiers:{number:!0},class:"col-12 col-sm-2",dense:"",outlined:"",type:"number",label:"num_dim",placeholder:""},null,8,["modelValue","onUpdate:modelValue"])):f("",!0),e.type.startsWith("string")?(n(),i(m,{key:1,modelValue:e.locale,"onUpdate:modelValue":t=>e.locale=t,class:"col-12 col-sm-2",dense:"",outlined:"",label:"locale",placeholder:""},null,8,["modelValue","onUpdate:modelValue"])):f("",!0)]),_:2},1024),o(u),o(h,{align:"between"},{default:s(()=>[p("div",null,[o(d,{modelValue:e.optional,"onUpdate:modelValue":t=>e.optional=t,label:"optional"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:e.facet,"onUpdate:modelValue":t=>e.facet=t,label:"facet"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:e.index,"onUpdate:modelValue":t=>e.index=t,label:"index"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:e.sort,"onUpdate:modelValue":t=>e.sort=t,label:"sort"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:e.infix,"onUpdate:modelValue":t=>e.infix=t,label:"infix"},null,8,["modelValue","onUpdate:modelValue"]),o(d,{modelValue:e.stem,"onUpdate:modelValue":t=>e.stem=t,label:"stem"},null,8,["modelValue","onUpdate:modelValue"])]),o(c,{size:"md",padding:"sm lg",unelevated:"",onClick:t=>a.removeField(e)},{default:s(()=>l[7]||(l[7]=[r("Remove Field")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),o(b,{name:"json",class:"q-pa-none"},{default:s(()=>[o(C,{modelValue:a.schemaJson,"onUpdate:modelValue":l[3]||(l[3]=e=>a.schemaJson=e),style:{height:"60vh"}},null,8,["modelValue"]),a.jsonError?(n(),i(J,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:s(()=>[r(" Invalid Format: "+U(a.jsonError),1)]),_:1})):f("",!0)]),_:1})]),_:1},8,["modelValue","style"]),o(u),o(h,{align:"between",class:"bg-primary"},{default:s(()=>[o(c,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:l[5]||(l[5]=e=>a.addField())},{default:s(()=>l[9]||(l[9]=[r("Add field")])),_:1}),o(c,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:l[6]||(l[6]=e=>a.$emit("submit",a.schema))},{default:s(()=>[r(U(a.primaryActionLabel),1)]),_:1})]),_:1})]),_:1})}const x=N($,[["render",E]]);export{x as C};
