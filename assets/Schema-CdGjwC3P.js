import{K as h,u as y,f as C,L as b,M as S,N as d,a1 as m,O as r,R as u,Q as x,X as N,S as f,W as k}from"./index-COFOeL2T.js";import{Q as O}from"./QPage-BBJw8y2s.js";import{u as Q}from"./use-quasar-CSTLctX9.js";import{C as K}from"./CollectionUi-DtmgUdjV.js";import"./QTabPanels-CcHMvx2K.js";import"./QResizeObserver-Noi1RvW0.js";import"./QSelect-2an0Xdjf.js";import"./format-BvkBI9bc.js";import"./touch-BjYP5sR0.js";import"./QBanner-7Mldg0mA.js";import"./MonacoEditor-BaqsUY8n.js";const j={class:"row justify-between q-mb-md"},w={class:"text-h5"},P=h({__name:"Schema",setup(B){const p=Q(),a=y(),n=C(()=>{const e=a.currentCollection;if(e){const t={name:e.name,fields:e.fields?.map(o=>{const l=["name","type","facet","optional","index","sort","infix","locale"],g=Object.keys(o).filter(s=>!l.includes(s));return l.concat(g).reduce((s,c)=>(s[c]=o[c],s),{})}),default_sorting_field:e.default_sorting_field};return Object.keys(e).filter(o=>!["name","fields","default_sorting_field","created_at","num_documents"].includes(o)).forEach(o=>{t[o]=e[o]}),t}return{name:"",fields:[],default_sorting_field:"",token_separators:[],symbols_to_index:[],enable_nested_fields:!1}});function _(e){p.dialog({title:"Confirm",message:`Drop ${e} and all documents?`,cancel:!0,persistent:!0}).onOk(()=>{a.dropCollection(e)})}function v(e){if(!n.value||!n.value.name||!n.value.fields)return;const t={fields:n.value.fields.map(i=>({name:i.name,drop:!0})).concat(JSON.parse(JSON.stringify(e.fields)))};a.updateCollection({collectionName:n.value.name,schema:t})}return(e,t)=>(S(),b(O,{padding:"",class:"column"},{default:d(()=>[m("div",j,[m("div",w,[r(x,{size:"md",name:"sym_s_data_object"}),u(" Schema for "+N(f(a).currentCollection?.name),1)]),r(k,{unelevated:"",color:"negative",onClick:t[0]||(t[0]=i=>_(f(a).currentCollection?.name||""))},{default:d(()=>t[1]||(t[1]=[u("Drop Collection")])),_:1})]),r(K,{"initial-schema":n.value,"primary-action-label":"Update Schema",onSubmit:v},null,8,["initial-schema"])]),_:1}))}});export{P as default};
