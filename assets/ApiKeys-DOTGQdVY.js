import{K as S,u as K,H as v,f as N,L as m,M as u,N as s,O as o,a2 as A,Y as Q,a3 as h,W as r,R as i,S as f,X as C,a8 as O,a7 as E,Q as y,a1 as J}from"./index-Cv4iHEBQ.js";import{Q as V}from"./QBanner-C4rFUYi0.js";import{Q as I,a as w,b as D}from"./QTable-BqBvcyYZ.js";import{Q as P}from"./QPage-qALIfcbS.js";import{u as j}from"./use-quasar-CGgMVU4U.js";import{M as B}from"./MonacoEditor-DTFvCi_0.js";import"./QSelect-DGPOn3Rt.js";import"./format-BvkBI9bc.js";import"./QList-Cw1N8oYP.js";import"./QLinearProgress-Dgs1IRMg.js";import"./QResizeObserver-DvK07aOp.js";const $={class:"text-h6"},Z=S({__name:"ApiKeys",setup(T){const d=j(),n=K(),p={description:"Admin key.",actions:["*"],collections:["*"]},g={description:"Search-only companies key.",actions:["documents:search"],collections:["companies"]},a=v({jsonError:null,key:JSON.parse(JSON.stringify(p)),expanded:n.data.apiKeys.length===0,filter:"",columns:[{label:"ID",name:"id",field:"id",sortable:!0},{label:"Key prefix",name:"value_prefix",field:"value_prefix"},{label:"Description",name:"description",field:"description",sortable:!0,align:"left"},{label:"Key Actions",name:"actions",field:t=>JSON.stringify(t.actions),sortable:!0,align:"left"},{label:"Collections",name:"collections",field:t=>JSON.stringify(t.collections),sortable:!0,align:"left"},{label:"Expires at",name:"expires_at",field:t=>t.expires_at?t.expires_at===64723363199?"never":new Date(t.expires_at*1e3).toLocaleString():""},{label:"Actions",name:"actions_op",align:"right"}]}),c=N({get:()=>JSON.stringify(a.key,null,2),set:t=>{try{a.key=JSON.parse(t),a.jsonError=null}catch(e){a.jsonError=e.message}}});function _(){a.key=JSON.parse(JSON.stringify(p))}function x(){a.key=JSON.parse(JSON.stringify(g))}async function b(){const t=await n.createApiKey(JSON.parse(JSON.stringify(a.key)));d.dialog({title:"Your API key",message:`This is your API key copy it! It will not be displayed again!

${t.value||""}`,cancel:!1,persistent:!0})}function k(t){d.dialog({title:"Confirm",message:`Delete key with id: ${t}?`,cancel:!0,persistent:!0}).onOk(()=>{n.deleteApiKey(t)})}return(t,e)=>(u(),m(P,{padding:""},{default:s(()=>[o(I,{modelValue:a.expanded,"onUpdate:modelValue":e[1]||(e[1]=l=>a.expanded=l),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:"Create API Key","header-class":"bg-primary text-white"},{default:s(()=>[o(A,{style:{height:"60vh"},class:"bg-surface column"},{default:s(()=>[o(h,{class:"q-gutter-md"},{default:s(()=>[o(r,{flat:"",onClick:_},{default:s(()=>e[3]||(e[3]=[i("Admin Key Example")])),_:1}),o(r,{flat:"",onClick:x},{default:s(()=>e[4]||(e[4]=[i("Search Key Example")])),_:1}),o(r,{type:"a",icon:"sym_s_help","no-caps":"",color:"info",flat:"",dense:"",href:`https://typesense.org/docs/${f(n).data.debug.version}/api/api-keys.html#create-an-api-key`,target:"_blank"},{default:s(()=>e[5]||(e[5]=[i("Documentation")])),_:1},8,["href"])]),_:1}),o(B,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l)},null,8,["modelValue"]),a.jsonError?(u(),m(V,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:s(()=>[i(" Invalid Format: "+C(a.jsonError),1)]),_:1})):Q("",!0),o(O,{align:"right",class:"bg-primary"},{default:s(()=>[o(r,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!a.jsonError,onClick:b},{default:s(()=>e[6]||(e[6]=[i("Create API Key")])),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(w,{class:"q-mt-md",title:"API Keys",flat:"",bordered:"",filter:a.filter,rows:f(n).data.apiKeys,columns:a.columns,"row-key":"id","visible-columns":["id","value_prefix","description","actions","collections","expires_at","actions_op"]},{"top-left":s(()=>[J("div",$,[o(y,{size:"md",name:"sym_s_key"}),e[7]||(e[7]=i(" API Keys"))])]),"top-right":s(()=>[o(E,{modelValue:a.filter,"onUpdate:modelValue":e[2]||(e[2]=l=>a.filter=l),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:s(()=>[o(y,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions_op":s(l=>[o(D,{class:"text-right"},{default:s(()=>[o(r,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:q=>k(l.row.id)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{Z as default};
