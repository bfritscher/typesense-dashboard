import{a0 as j,e as U,i as A,a1 as Y,f as v,h,a2 as G,J as Z,K as O,u as K,r as D,A as W,o as H,U as J,M as c,O as b,R as s,N as d,a3 as I,a4 as T,L as f,a5 as C,a6 as w,$ as m,T as l,S as $,a7 as X,V as q,X as ee}from"./index-CEKgHZlV.js";import{b as te}from"./format-BvkBI9bc.js";import{Q}from"./QLinearProgress-BTcjtJry.js";import{Q as ae}from"./QPage-ClJgVpfE.js";const le={...j,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},p=50,E=2*p,F=E*Math.PI,se=Math.round(F*1e3)/1e3,re=U({name:"QCircularProgress",props:{...le,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:t}){const{proxy:{$q:i}}=A(),o=Y(e),y=v(()=>{const u=(i.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(i.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-u}deg)`:`rotate3d(0, 0, 1, ${u-90}deg)`}}),k=v(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),n=v(()=>E/(1-e.thickness/2)),a=v(()=>`${n.value/2} ${n.value/2} ${n.value} ${n.value}`),r=v(()=>te(e.value,e.min,e.max)),g=v(()=>e.max-e.min),x=v(()=>e.thickness/2*n.value),B=v(()=>{const u=(e.max-r.value)/g.value,S=e.rounded===!0&&r.value<e.max&&u<.25?x.value/2*(1-u/.25):0;return F*u+S});function M({thickness:u,offset:S,color:P,cls:V,rounded:R}){return h("circle",{class:"q-circular-progress__"+V+(P!==void 0?` text-${P}`:""),style:k.value,fill:"transparent",stroke:"currentColor","stroke-width":u,"stroke-dasharray":se,"stroke-dashoffset":S,"stroke-linecap":R,cx:n.value,cy:n.value,r:p})}return()=>{const u=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&u.push(h("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:p-x.value/2,cx:n.value,cy:n.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&u.push(M({cls:"track",thickness:x.value,offset:0,color:e.trackColor})),u.push(M({cls:"circle",thickness:x.value,offset:B.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const S=[h("svg",{class:"q-circular-progress__svg",style:y.value,viewBox:a.value,"aria-hidden":"true"},u)];return e.showValue===!0&&S.push(h("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},t.default!==void 0?t.default():[h("div",r.value)])),h("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:o.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:r.value},G(t.internal,S))}}}),ne=["top","middle","bottom"],N=U({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>ne.includes(e)}},setup(e,{slots:t}){const i=v(()=>e.align!==void 0?{verticalAlign:e.align}:null),o=v(()=>{const y=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(y!==void 0?` text-${y}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>h("div",{class:o.value,style:i.value,role:"status","aria-label":e.label},Z(t.default,e.label!==void 0?[e.label]:[]))}}),ie=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],oe=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],de=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],ue=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],z=(e,t,i)=>{let o=e;return typeof t=="string"||Array.isArray(t)?o=e.toLocaleString(t,i):(t===!0||i!==void 0)&&(o=e.toLocaleString(void 0,i)),o},L=e=>{if(typeof e=="number")return Math.log10(e);const t=e.toString(10);return t.length+Math.log10("0."+t.slice(0,15))},ce=e=>typeof e=="number"?Math.log(e):L(e)*Math.log(10),me=(e,t)=>{if(typeof e=="number")return e/t;const i=e/BigInt(t),o=e%BigInt(t);return Number(i)+Number(o)/t};function _(e,t){if(typeof e!="bigint"&&!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const i=t.bits?t.binary?ue:de:t.binary?oe:ie,o=t.space?" ":"";if(t.signed&&(typeof e=="number"?e===0:e===0n))return` 0${o}${i[0]}`;const y=e<0,k=y?"-":t.signed?"+":"";y&&(e=-e);let n;if(t.minimumFractionDigits!==void 0&&(n={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(n={maximumFractionDigits:t.maximumFractionDigits,...n}),e<1){const x=z(e,t.locale,n);return k+x+o+i[0]}const a=Math.min(Math.floor(t.binary?ce(e)/Math.log(1024):L(e)/3),i.length-1);e=me(e,(t.binary?1024:1e3)**a),n||(e=e.toPrecision(3));const r=z(Number(e),t.locale,n),g=i[a];return k+r+o+g}const fe={class:"row"},ve={class:"col col-12 col-md-8"},ge={class:"row"},be={class:"text-overline"},ye={class:"absolute-full flex flex-center"},xe={class:"absolute-full flex justify-end"},_e={class:"absolute-full flex flex-center"},he={class:"absolute-full flex justify-end"},ke={key:0},Se={key:1},Be={key:2},Ce={key:0},Te=O({__name:"ServerStatus",setup(e){const t=K(),i=D(void 0),o=D(-1);function y(n){return typeof n=="object"}W(()=>{i.value=window.setInterval(()=>{t.refreshServerStatus()},2e3)}),H(()=>{window.clearInterval(i.value)});const k=v(()=>Object.entries(t.data.metrics).filter(([n])=>n.includes("cpu")).map(([n,a])=>{let r=0;const g=n.split("_");return g.length>1&&g[1]&&(r=parseInt(g[1].replace("cpu",""))||0),{node:r,value:parseFloat(a)}}).sort((n,a)=>n.node-a.node));return(n,a)=>(c(),J(ae,{padding:""},{default:b(()=>[s("div",fe,[s("div",ve,[d(I,{flat:"",bordered:"",class:"q-mb-md"},{default:b(()=>[d(T,null,{default:b(()=>[a[2]||(a[2]=s("div",{class:"text-h5"},"System",-1)),a[3]||(a[3]=s("div",{class:"text-subtitle1 q-pt-md"},"CPU",-1)),s("div",ge,[(c(!0),f(C,null,w(k.value,r=>(c(),f("div",{key:r.node,class:"column flex-center flex-wrap q-ma-md"},[s("span",be,"CPU "+m(r.node),1),d(re,{"show-value":"",value:r.value,size:"50px",color:"accent","track-color":"grey-3"},null,8,["value"])]))),128))]),a[4]||(a[4]=s("div",{class:"text-subtitle1 q-pt-md"},"Memory",-1)),d(Q,{size:"25px",value:parseInt(l(t).data.metrics.system_memory_used_bytes,10)/parseInt(l(t).data.metrics.system_memory_total_bytes,10),color:"accent"},{default:b(()=>[s("div",ye,[d(N,{color:"white","text-color":"accent",label:l(_)(parseInt(l(t).data.metrics.system_memory_used_bytes,10))},null,8,["label"])]),s("div",xe,[d(N,{color:"white","text-color":"accent",label:l(_)(parseInt(l(t).data.metrics.system_memory_total_bytes,10))},null,8,["label"])])]),_:1},8,["value"]),a[5]||(a[5]=s("div",{class:"text-subtitle1 q-pt-md"},"Disk",-1)),d(Q,{size:"25px",value:parseInt(l(t).data.metrics.system_disk_used_bytes,10)/parseInt(l(t).data.metrics.system_disk_total_bytes,10),color:"accent"},{default:b(()=>[s("div",_e,[d(N,{color:"white","text-color":"accent",label:l(_)(parseInt(l(t).data.metrics.system_disk_used_bytes,10))},null,8,["label"])]),s("div",he,[d(N,{color:"white","text-color":"accent",label:l(_)(parseInt(l(t).data.metrics.system_disk_total_bytes,10))},null,8,["label"])])]),_:1},8,["value"]),a[6]||(a[6]=s("div",{class:"text-subtitle1 q-pt-md"},"System Network",-1)),s("div",null," Received: "+m(l(_)(parseInt(l(t).data.metrics.system_network_received_bytes,10)))+" Sent: "+m(l(_)(parseInt(l(t).data.metrics.system_network_sent_bytes,10))),1)]),_:1,__:[2,3,4,5,6]})]),_:1}),d(I,{flat:"",bordered:"",class:"q-mb-md"},{default:b(()=>[d(T,null,{default:b(()=>[a[7]||(a[7]=s("div",{class:"text-h5 q-mb-md"},"Operations",-1)),a[8]||(a[8]=s("div",{class:"text-subtitle1 q-pt-md"},"Cache",-1)),a[9]||(a[9]=s("p",null," Responses of search requests that are sent with use_cache parameter are cached in a LRU cache. ",-1)),d($,{label:"Clear Search Cache",color:"accent",unelevated:"",size:"md",padding:"sm lg",onClick:l(t).clearCache},null,8,["onClick"]),a[10]||(a[10]=s("div",{class:"text-subtitle1 q-pt-md"},"Slow Request Log",-1)),a[11]||(a[11]=s("p",null,"Slow requests are logged to the primary log file, with the prefix SLOW REQUEST",-1)),d(X,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=r=>o.value=r),modelModifiers:{number:!0},outlined:"",label:"Threshold (ms)",type:"number",hint:"Enable logging of requests that take over a defined threshold of time. (-1 to disable)"},{after:b(()=>[d($,{unelevated:"",label:"set",color:"accent",size:"md",padding:"sm lg",onClick:a[0]||(a[0]=r=>l(t).slowQueryThreshold(o.value))})]),_:1},8,["modelValue"]),a[12]||(a[12]=s("div",{class:"text-subtitle1 q-pt-md"},"Compacting the on-disk database",-1)),a[13]||(a[13]=s("p",null,"Recommended to run it during off-peak hours.",-1)),d($,{label:"Compact Database",color:"accent",unelevated:"",size:"md",padding:"sm lg",onClick:l(t).operationCompactDB},null,8,["onClick"])]),_:1,__:[7,8,9,10,11,12,13]})]),_:1})]),d(I,{flat:"",bordered:"",class:"col-12 col-md-3 offset-md-1 q-mb-md"},{default:b(()=>[d(T,null,{default:b(()=>[a[14]||(a[14]=s("div",{class:"text-h5"},"Typesense",-1)),a[15]||(a[15]=s("div",{class:"text-subtitle1 q-pt-md"},"Node",-1)),s("div",null,"Protocol: "+m(l(t).loginData?.node.protocol),1),s("div",null,"Host: "+m(l(t).loginData?.node.host),1),s("div",null,"Port: "+m(l(t).loginData?.node.port),1),l(t).data.debug.version?(c(),f("div",ke,"Version: "+m(l(t).data.debug.version),1)):q("",!0),Object.hasOwnProperty.call(l(t).data.debug,"state")?(c(),f("div",Se," Role: "+m(l(t).data.debug.state===1?"Leader":"Follower"),1)):q("",!0),a[16]||(a[16]=s("div",{class:"text-subtitle1 q-pt-md"},"Memory",-1)),(c(!0),f(C,null,w(Object.keys(l(t).data.metrics).filter(r=>r.includes("typesense")),r=>(c(),f("div",{key:r},m(r.split("_")[2])+" : "+m(r.includes("bytes")?l(_)(parseInt(l(t).data.metrics[r],10)):l(t).data.metrics[r]),1))),128)),a[17]||(a[17]=s("div",{class:"text-subtitle1 q-pt-md"},"Stats",-1)),l(t).data.features.stats?q("",!0):(c(),f("div",Be,"Stats are not enabled on this node.")),(c(!0),f(C,null,w(l(t).data.stats,(r,g)=>(c(),f("div",{key:g},[y(r)?(c(),f("div",Ce,[ee(m(g)+" ",1),(c(!0),f(C,null,w(r,(x,B)=>(c(),f("div",{key:B},m(B)+" : "+m(x),1))),128))])):q("",!0)]))),128))]),_:1,__:[14,15,16,17]})]),_:1})])]),_:1}))}});export{Te as default};
