import{K as y,u as A,H as Q,f as r,L as V,M as v,N as s,O as a,a2 as C,a3 as N,a7 as c,a8 as k,W as i,R as u,X as w,S,Q as p,a1 as U}from"./index-COFOeL2T.js";import{c as $}from"./QSelect-2an0Xdjf.js";import{Q as B,a as O,b as T}from"./QTable-CzVGWkD1.js";import{Q as D}from"./QPage-BBJw8y2s.js";import{u as I}from"./use-quasar-CSTLctX9.js";import"./format-BvkBI9bc.js";import"./QList-BdM4oJbp.js";import"./QLinearProgress-BX_OVINY.js";const P={class:"text-h6"},R=y({__name:"Aliases",setup(h){const f=I(),o=A(),e=Q({alias:{name:"",collection_name:""},expanded:o.data.aliases.length===0,filter:"",columns:[{label:"Alias Name",name:"name",field:"name",align:"left",sortable:!0},{label:"Collection Name",name:"collection_name",field:"collection_name",align:"left",sortable:!0},{label:"Actions",name:"actions",align:"right"}]}),d=r(()=>o.data.collections.map(n=>n.name)),m=r(()=>o.data.aliases.map(n=>n.name).includes(e.alias.name));async function _(){await o.createAlias({name:e.alias.name,collection_name:e.alias.collection_name}),e.alias={name:"",collection_name:""},e.expanded=!1}function g(n){e.alias=JSON.parse(JSON.stringify(n)),e.expanded=!0}function b(n){f.dialog({title:"Confirm",message:`Delete alias ${n}?`,cancel:!0,persistent:!0}).onOk(()=>{o.deleteAlias(n)})}return(n,t)=>(v(),V(D,{padding:""},{default:s(()=>[a(B,{modelValue:e.expanded,"onUpdate:modelValue":t[3]||(t[3]=l=>e.expanded=l),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:`${m.value?"Update":"Add"} Alias`,"header-class":"bg-primary text-white"},{default:s(()=>[a(C,{class:"bg-surface column"},{default:s(()=>[a(N,null,{default:s(()=>[a(c,{modelValue:e.alias.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.alias.name=l),label:"Alias name",filled:"",rules:[l=>!d.value.includes(l)||"Must not be a collection name"]},null,8,["modelValue","rules"]),a($,{modelValue:e.alias.collection_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.alias.collection_name=l),label:"Target Collection",filled:"",options:d.value},null,8,["modelValue","options"])]),_:1}),a(k,{align:"right",class:"bg-primary"},{default:s(()=>[a(i,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:t[2]||(t[2]=l=>_())},{default:s(()=>[u(w(m.value?"Update":"Add")+" Alias",1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),a(O,{class:"q-mt-md",title:"Aliases",flat:"",bordered:"",filter:e.filter,rows:S(o).data.aliases,columns:e.columns,"row-key":"name","visible-columns":["name","collection_name","actions"],pagination:{rowsPerPage:50,sortBy:"name"}},{"top-left":s(()=>[U("div",P,[a(p,{size:"md",name:"sym_s_call_split"}),t[5]||(t[5]=u(" Aliases"))])]),"top-right":s(()=>[a(c,{modelValue:e.filter,"onUpdate:modelValue":t[4]||(t[4]=l=>e.filter=l),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:s(()=>[a(p,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions":s(l=>[a(T,{class:"text-right"},{default:s(()=>[a(i,{flat:"",icon:"sym_s_edit",title:"Edit",onClick:x=>g(l.row)},null,8,["onClick"]),a(i,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:x=>b(l.row.name)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{R as default};
