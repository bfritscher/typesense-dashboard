import{K as S,u as K,H as v,f as N,L as u,M as f,N as s,O as o,a2 as A,Y as Q,a3 as h,W as r,R as n,S as d,X as C,a8 as O,a7 as V,Q as y,a1 as E}from"./index-COFOeL2T.js";import{Q as J}from"./QBanner-7Mldg0mA.js";import{Q as I,a as w,b as D}from"./QTable-CzVGWkD1.js";import{Q as P}from"./QPage-BBJw8y2s.js";import{u as j}from"./use-quasar-CSTLctX9.js";import{M as B}from"./MonacoEditor-BaqsUY8n.js";import"./QSelect-2an0Xdjf.js";import"./format-BvkBI9bc.js";import"./QList-BdM4oJbp.js";import"./QLinearProgress-BX_OVINY.js";import"./QResizeObserver-Noi1RvW0.js";const $={class:"text-h6"},Z=S({__name:"ApiKeys",setup(T){const p=j(),i=K(),c={description:"Admin key.",actions:["*"],collections:["*"]},g={description:"Search-only companies key.",actions:["documents:search"],collections:["companies"]},a=v({jsonError:null,key:JSON.parse(JSON.stringify(c)),expanded:i.data.apiKeys.length===0,filter:"",columns:[{label:"ID",name:"id",field:"id",sortable:!0},{label:"Key prefix",name:"value_prefix",field:"value_prefix"},{label:"Description",name:"description",field:"description",sortable:!0,align:"left"},{label:"Key Actions",name:"actions",field:t=>JSON.stringify(t.actions),sortable:!0,align:"left"},{label:"Collections",name:"collections",field:t=>JSON.stringify(t.collections),sortable:!0,align:"left"},{label:"Expires at",name:"expires_at",field:t=>t.expires_at?t.expires_at===64723363199?"never":new Date(t.expires_at*1e3).toLocaleString():""},{label:"Actions",name:"actions_op",align:"right"}]}),m=N({get:()=>JSON.stringify(a.key,null,2),set:t=>{try{a.key=JSON.parse(t),a.jsonError=null}catch(e){a.jsonError=e.message}}});function _(){a.key=JSON.parse(JSON.stringify(c))}function x(){a.key=JSON.parse(JSON.stringify(g))}async function b(){const t=await i.createApiKey(JSON.parse(JSON.stringify(a.key)));p.dialog({title:"Your API key",message:`This is your API key copy it! It will not be displayed again!

${t.value||""}`,cancel:!1,persistent:!0})}function k(t){p.dialog({title:"Confirm",message:`Delete key with id: ${t}?`,cancel:!0,persistent:!0}).onOk(()=>{i.deleteApiKey(t)})}return(t,e)=>(f(),u(P,{padding:""},{default:s(()=>[o(I,{modelValue:a.expanded,"onUpdate:modelValue":e[1]||(e[1]=l=>a.expanded=l),"expand-separator":"",icon:"sym_s_add_circle","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:"Create API Key","header-class":"bg-primary text-white"},{default:s(()=>[o(A,{style:{height:"60vh"},class:"bg-surface column"},{default:s(()=>[o(h,{class:"q-gutter-md"},{default:s(()=>[o(r,{flat:"",onClick:_},{default:s(()=>e[3]||(e[3]=[n("Admin Key Example")])),_:1}),o(r,{flat:"",onClick:x},{default:s(()=>e[4]||(e[4]=[n("Search Key Example")])),_:1}),o(r,{type:"a",icon:"sym_s_help","no-caps":"",color:"info",flat:"",dense:"",href:`https://typesense.org/docs/${d(i).data.debug.version||d(i).data.defaultDocVersion}/api/api-keys.html#create-an-api-key`,target:"_blank"},{default:s(()=>e[5]||(e[5]=[n("Documentation")])),_:1},8,["href"])]),_:1}),o(B,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l)},null,8,["modelValue"]),a.jsonError?(f(),u(J,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:s(()=>[n(" Invalid Format: "+C(a.jsonError),1)]),_:1})):Q("",!0),o(O,{align:"right",class:"bg-primary"},{default:s(()=>[o(r,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!a.jsonError,onClick:b},{default:s(()=>e[6]||(e[6]=[n("Create API Key")])),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(w,{class:"q-mt-md",title:"API Keys",flat:"",bordered:"",filter:a.filter,rows:d(i).data.apiKeys,columns:a.columns,"row-key":"id","visible-columns":["id","value_prefix","description","actions","collections","expires_at","actions_op"]},{"top-left":s(()=>[E("div",$,[o(y,{size:"md",name:"sym_s_key"}),e[7]||(e[7]=n(" API Keys"))])]),"top-right":s(()=>[o(V,{modelValue:a.filter,"onUpdate:modelValue":e[2]||(e[2]=l=>a.filter=l),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:s(()=>[o(y,{name:"sym_s_search"})]),_:1},8,["modelValue"])]),"body-cell-actions_op":s(l=>[o(D,{class:"text-right"},{default:s(()=>[o(r,{flat:"",color:"negative",icon:"sym_s_delete_forever",title:"Delete",onClick:q=>k(l.row.id)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["filter","rows","columns"])]),_:1}))}});export{Z as default};
