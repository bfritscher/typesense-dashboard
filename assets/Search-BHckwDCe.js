import{Q as fr,a as Ze,b as pr,c as et}from"./QTabPanels-8zz-6uay.js";import{e as pe,h as L,B as Je,p as vr,r as N,i as Vt,s as hr,f as F,ad as yr,w as ve,ae as ye,af as _r,ag as mr,o as gr,J as br,ah as tt,t as rt,G as Sr,A as xr,ai as Rr,g as qr,aj as Tr,ak as _e,K as Z,Z as G,L as H,M as $,N as A,V as Q,U,S as X,a5 as V,_ as Kt,O as M,a6 as Y,ac as at,X as K,$ as J,u as Xe,Q as Jt,R as W,P as nt,Y as Ar,W as Or,a7 as Pr,al as wr,am as Cr,T as Ir,an as kr}from"./index-TreL_WJR.js";import{Q as Fr}from"./QPage-BEEUHEA3.js";import{a as Ye,Q as fe,b as se,c as jr}from"./QSelect-DI4b5CBb.js";import{Q as Xt}from"./QList-CP_2Mym6.js";import{Q as it}from"./QResizeObserver-DQ42bq8d.js";import{Q as zr,T as ot}from"./QScrollObserver-DD3z0qNS.js";import{b as te}from"./format-BvkBI9bc.js";import{Q as Yt}from"./QBanner-DHWR3dzq.js";import{M as $r}from"./MonacoEditor-BIY3YNJC.js";import{u as Er}from"./use-quasar-BZWIP0gQ.js";import{G as Mr,J as Nr}from"./ExperimentalDynamicWidgets-CsqK-9Oz.js";import"./touch-BjYP5sR0.js";const Hr=pe({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup(e){return()=>[L("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),L("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),Je(L("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),Je(L("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]}}),st=["vertical","horizontal"],me={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},lt={prevent:!0,mouse:!0,mouseAllDir:!0},ut=e=>e>=250?50:Math.ceil(e/5),Lr=pe({name:"QScrollArea",props:{...vr,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:c,emit:p}){const i=N(!1),l=N(!1),f=N(!1),s={vertical:N(0),horizontal:N(0)},u={vertical:{ref:N(null),position:N(0),size:N(0)},horizontal:{ref:N(null),position:N(0),size:N(0)}},{proxy:y}=Vt(),g=hr(e,y.$q);let h=null,v;const o=N(null),t=F(()=>"q-scrollarea"+(g.value===!0?" q-scrollarea--dark":""));Object.assign(s,{verticalInner:F(()=>s.vertical.value-e.verticalOffset[0]-e.verticalOffset[1]),horizontalInner:F(()=>s.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1])}),u.vertical.percentage=F(()=>{const x=u.vertical.size.value-s.vertical.value;if(x<=0)return 0;const R=te(u.vertical.position.value/x,0,1);return Math.round(R*1e4)/1e4}),u.vertical.thumbHidden=F(()=>(e.visible===null?f.value:e.visible)!==!0&&i.value===!1&&l.value===!1||u.vertical.size.value<=s.vertical.value+1),u.vertical.thumbStart=F(()=>e.verticalOffset[0]+u.vertical.percentage.value*(s.verticalInner.value-u.vertical.thumbSize.value)),u.vertical.thumbSize=F(()=>Math.round(te(s.verticalInner.value*s.verticalInner.value/u.vertical.size.value,ut(s.verticalInner.value),s.verticalInner.value))),u.vertical.style=F(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${u.vertical.thumbStart.value}px`,height:`${u.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`})),u.vertical.thumbClass=F(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.vertical.barClass=F(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),u.horizontal.percentage=F(()=>{const x=u.horizontal.size.value-s.horizontal.value;if(x<=0)return 0;const R=te(Math.abs(u.horizontal.position.value)/x,0,1);return Math.round(R*1e4)/1e4}),u.horizontal.thumbHidden=F(()=>(e.visible===null?f.value:e.visible)!==!0&&i.value===!1&&l.value===!1||u.horizontal.size.value<=s.horizontal.value+1),u.horizontal.thumbStart=F(()=>e.horizontalOffset[0]+u.horizontal.percentage.value*(s.horizontalInner.value-u.horizontal.thumbSize.value)),u.horizontal.thumbSize=F(()=>Math.round(te(s.horizontalInner.value*s.horizontalInner.value/u.horizontal.size.value,ut(s.horizontalInner.value),s.horizontalInner.value))),u.horizontal.style=F(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[y.$q.lang.rtl===!0?"right":"left"]:`${u.horizontal.thumbStart.value}px`,width:`${u.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`})),u.horizontal.thumbClass=F(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.horizontal.barClass=F(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const a=F(()=>u.vertical.thumbHidden.value===!0&&u.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle);function d(){const x={};return st.forEach(R=>{const k=u[R];Object.assign(x,{[R+"Position"]:k.position.value,[R+"Percentage"]:k.percentage.value,[R+"Size"]:k.size.value,[R+"ContainerSize"]:s[R].value,[R+"ContainerInnerSize"]:s[R+"Inner"].value})}),x}const r=yr(()=>{const x=d();x.ref=y,p("scroll",x)},0);function n(x,R,k){if(st.includes(x)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(x==="vertical"?tt:ye)(o.value,R,k)}function _({height:x,width:R}){let k=!1;s.vertical.value!==x&&(s.vertical.value=x,k=!0),s.horizontal.value!==R&&(s.horizontal.value=R,k=!0),k===!0&&O()}function b({position:x}){let R=!1;u.vertical.position.value!==x.top&&(u.vertical.position.value=x.top,R=!0),u.horizontal.position.value!==x.left&&(u.horizontal.position.value=x.left,R=!0),R===!0&&O()}function m({height:x,width:R}){u.horizontal.size.value!==R&&(u.horizontal.size.value=R,O()),u.vertical.size.value!==x&&(u.vertical.size.value=x,O())}function S(x,R){const k=u[R];if(x.isFirst===!0){if(k.thumbHidden.value===!0)return;v=k.position.value,l.value=!0}else if(l.value!==!0)return;x.isFinal===!0&&(l.value=!1);const P=me[R],E=(k.size.value-s[R].value)/(s[R+"Inner"].value-k.thumbSize.value),B=x.distance[P.dist],D=v+(x.direction===P.dir?1:-1)*B*E;z(D,R)}function q(x,R){const k=u[R];if(k.thumbHidden.value!==!0){const P=R==="vertical"?e.verticalOffset[0]:e.horizontalOffset[0],E=x[me[R].offset]-P,B=k.thumbStart.value-P;if(E<B||E>B+k.thumbSize.value){const D=E-k.thumbSize.value/2,ee=te(D/(s[R+"Inner"].value-k.thumbSize.value),0,1);z(ee*Math.max(0,k.size.value-s[R].value),R)}k.ref.value!==null&&k.ref.value.dispatchEvent(new MouseEvent(x.type,x))}}function O(){i.value=!0,h!==null&&clearTimeout(h),h=setTimeout(()=>{h=null,i.value=!1},e.delay),e.onScroll!==void 0&&r()}function z(x,R){o.value[me[R].scroll]=x}let w=null;function j(){w!==null&&clearTimeout(w),w=setTimeout(()=>{w=null,f.value=!0},y.$q.platform.is.ios?50:0)}function I(){w!==null&&(clearTimeout(w),w=null),f.value=!1}let T=null;ve(()=>y.$q.lang.rtl,x=>{o.value!==null&&ye(o.value,Math.abs(u.horizontal.position.value)*(x===!0?-1:1))}),_r(()=>{T={top:u.vertical.position.value,left:u.horizontal.position.value}}),mr(()=>{if(T===null)return;const x=o.value;x!==null&&(ye(x,T.left),tt(x,T.top))}),gr(r.cancel),Object.assign(y,{getScrollTarget:()=>o.value,getScroll:d,getScrollPosition:()=>({top:u.vertical.position.value,left:u.horizontal.position.value}),getScrollPercentage:()=>({top:u.vertical.percentage.value,left:u.horizontal.percentage.value}),setScrollPosition:n,setScrollPercentage(x,R,k){n(x,R*(u[x].size.value-s[x].value)*(x==="horizontal"&&y.$q.lang.rtl===!0?-1:1),k)}});const C={scroll:u,thumbVertDir:[[ot,x=>{S(x,"vertical")},void 0,{vertical:!0,...lt}]],thumbHorizDir:[[ot,x=>{S(x,"horizontal")},void 0,{horizontal:!0,...lt}]],onVerticalMousedown(x){q(x,"vertical")},onHorizontalMousedown(x){q(x,"horizontal")}};return()=>L("div",{class:t.value,onMouseenter:j,onMouseleave:I},[L("div",{ref:o,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[L("div",{class:"q-scrollarea__content absolute",style:a.value},br(c.default,[L(it,{debounce:0,onResize:m})])),L(zr,{axis:"both",onScroll:b})]),L(it,{debounce:0,onResize:_}),L(Hr,{store:C,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}}),Br=pe({name:"QSpace",setup(){const e=L("div",{class:"q-space"});return()=>e}}),Dr={ratio:[String,Number]};function Gr(e,c){return F(()=>{const p=Number(e.ratio||(c!==void 0?c.value:void 0));return isNaN(p)!==!0&&p>0?{paddingBottom:`${100/p}%`}:null})}const Wr=1.7778,Qr=pe({name:"QImg",props:{...Dr,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Wr},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:c,emit:p}){const i=N(e.initialRatio),l=Gr(e,i),f=Vt(),{registerTimeout:s,removeTimeout:u}=rt(),{registerTimeout:y,removeTimeout:g}=rt(),h=F(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),v=F(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),o=[N(null),N(h.value)],t=N(0),a=N(!1),d=N(!1),r=F(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),n=F(()=>({width:e.width,height:e.height})),_=F(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),b=F(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function m(){if(g(),e.loadingShowDelay===0){a.value=!0;return}y(()=>{a.value=!0},e.loadingShowDelay)}function S(){g(),a.value=!1}function q({target:T}){_e(f)===!1&&(u(),i.value=T.naturalHeight===0?.5:T.naturalWidth/T.naturalHeight,O(T,1))}function O(T,C){C===1e3||_e(f)===!0||(T.complete===!0?z(T):s(()=>{O(T,C+1)},50))}function z(T){_e(f)!==!0&&(t.value=t.value^1,o[t.value].value=null,S(),T.getAttribute("__qerror")!=="true"&&(d.value=!1),p("load",T.currentSrc||T.src))}function w(T){u(),S(),d.value=!0,o[t.value].value=v.value,o[t.value^1].value=h.value,p("error",T)}function j(T){const C=o[T].value,x={key:"img_"+T,class:_.value,style:b.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...C};return t.value===T?Object.assign(x,{class:x.class+"current",onLoad:q,onError:w}):x.class+="loaded",L("div",{class:"q-img__container absolute-full",key:"img"+T},L("img",x))}function I(){return a.value===!1?L("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},qr(c[d.value===!0?"error":"default"])):L("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},c.loading!==void 0?c.loading():e.noSpinner===!0?void 0:[L(Tr,{color:e.spinnerColor,size:e.spinnerSize})])}{let T=function(){ve(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,C=>{u(),d.value=!1,C===null?(S(),o[t.value^1].value=h.value):m(),o[t.value].value=C},{immediate:!0})};Sr.value===!0?xr(T):T()}return()=>{const T=[];return l.value!==null&&T.push(L("div",{key:"filler",style:l.value})),o[0].value!==null&&T.push(j(0)),o[1].value!==null&&T.push(j(1)),T.push(L(Rr,{name:"q-transition--fade"},I)),L("div",{key:"main",class:r.value,style:n.value,role:"img","aria-label":e.alt},T)}}}),Ur={key:0,class:"img-preview"},Vr=Z({__name:"SearchResultItemAttribute",props:{hit:{}},setup(e){const c=i=>i?(i=String(i),i.startsWith("http://")||i.startsWith("https://")):!1,p=i=>{if(!i)return!1;i=String(i);const l=["jpg","jpeg","png","gif","bmp","svg","webp"],f=i.split(".").pop()?.toLowerCase()||"";return l.includes(f)};return(i,l)=>{const f=G("ais-highlight");return $(),H(V,null,[A(f,{attribute:"a",hit:{_highlightResult:{a:i.hit}}},null,8,["hit"]),p(i.hit?.value)?($(),H("div",Ur,[A(Qr,{src:i.hit.value,fit:"contain",class:"img-preview"},null,8,["src"])])):Q("",!0),c(i.hit?.value)?($(),U(X,{key:1,class:"absolute-top-right",flat:"",href:i.hit.value,target:"_blank",size:"sm",padding:"sm",icon:"sym_s_open_in_new",title:"open"},null,8,["href"])):Q("",!0)],64)}}}),ct=Kt(Vr,[["__scopeId","data-v-1b631cd2"]]),Kr={key:0},Jr={key:0},Xr={key:1},Yr=Z({__name:"SearchResultItemNestedDisplay",props:{item:{},includeFields:{default:()=>[]},embedFields:{default:()=>[]}},setup(e){const c=e;function p(s){return s.some(u=>u.value&&u.matchLevel)}function i(s,u){return s.filter(y=>y.startsWith(u)&&y!==u).map(y=>y.replace(`${u}.`,""))}const l=F(()=>{const s=Object.keys(c.item);return c.includeFields.filter(u=>s.includes(u)).concat(s.filter(u=>!c.includeFields.includes(u)))});function f(s){if(s==null||typeof s!="object")return s;if(Array.isArray(s))return s.map(y=>f(y));if(Object.prototype.hasOwnProperty.call(s,"value")&&Object.prototype.hasOwnProperty.call(s,"matchLevel"))return s.value;const u={};for(const y in s)Object.prototype.hasOwnProperty.call(s,y)&&(u[y]=f(s[y]));return u}return(s,u)=>{const y=G("search-result-item-nested-display",!0);return $(),U(Xt,{dense:""},{default:M(()=>[($(!0),H(V,null,Y(l.value,g=>($(),U(Ye,{key:g},{default:M(()=>[A(fe,{side:"",class:"q-mt-sm text-body2"},{default:M(()=>[A(se,{caption:"",class:at(c.includeFields.includes(g)?"schema-field":"text-warning unknown-field")},{default:M(()=>[K(J(g)+" ",1),Array.isArray(s.item[g])&&s.item[g].length>1?($(),H("span",Kr,"["+J(s.item[g].length)+"]",1)):Q("",!0)]),_:2},1032,["class"]),c.embedFields.includes(g)?Q("",!0):($(),U(se,{key:0,class:"overflow-hidden text-no-wrap text-ellipsis",title:JSON.stringify(f(s.item[g]),null,2)},{default:M(()=>[Array.isArray(s.item[g])?($(),H("div",{key:0,class:at(p(s.item[g])?"array-field":"nested-field")},[($(!0),H(V,null,Y(s.item[g],(h,v)=>($(),H(V,{key:v},[h.value&&h.matchLevel?($(),H("div",Jr,[A(ct,{hit:h},null,8,["hit"])])):($(),U(y,{key:1,item:h,"include-fields":i(c.includeFields,g),"embed-fields":i(c.embedFields,g)},null,8,["item","include-fields","embed-fields"]))],64))),128))],2)):($(),H("div",Xr,[A(ct,{hit:s.item[g]},null,8,["hit"])]))]),_:2},1032,["title"]))]),_:2},1024)]),_:2},1024))),128))]),_:1})}}}),Zr={key:0,class:"column no-wrap search-result-item"},Zt=Z({__name:"SearchResultItem",props:{item:{}},emits:["deleted"],setup(e,{emit:c}){const p=e,i=c,l=Xe(),f=Er(),s=F(()=>l.currentCollection),u=F(()=>!p.item||!s.value||!s.value.fields?[]:s.value.fields.map(v=>v.name)),y=F(()=>!p.item||!s.value||!s.value.fields?[]:s.value.fields.filter(v=>v.embed).map(v=>v.name)),g=()=>{const v={};p.item&&(Object.keys(p.item).forEach(o=>{!o.startsWith("_")&&!["objectID","text_match"].includes(o)&&(v[o]=p.item?.[o])}),l.editDocuments([JSON.parse(JSON.stringify(v))]))},h=v=>{f.dialog({title:"Confirm",message:`Delete document with id: ${v}?`,cancel:!0,persistent:!0}).onOk(()=>{l.deleteDocumentById(v)?.then(()=>{i("deleted",v)}).catch(o=>{f.notify({type:"negative",message:`Error deleting document: ${o.message}`})})})};return(v,o)=>s.value?($(),H("div",Zr,[v.item?($(),U(Yr,{key:0,item:v.item._highlightResult,"include-fields":u.value,"embed-fields":y.value},null,8,["item","include-fields","embed-fields"])):Q("",!0),A(Br),A(Jt),A(Ye,null,{default:M(()=>[A(fe,null,{default:M(()=>[A(se,null,{default:M(()=>[A(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_edit",title:"Edit",onClick:o[0]||(o[0]=t=>g())})]),_:1})]),_:1}),A(fe,{side:""},{default:M(()=>[A(se,null,{default:M(()=>[A(X,{flat:"",size:"sm",padding:"sm",icon:"sym_s_delete_forever",title:"Delete",onClick:o[1]||(o[1]=t=>h(v.item?.id))})]),_:1})]),_:1})]),_:1})])):Q("",!0)}}),ea={class:"row"},ta={class:"col-9"},ra={class:"col-3"},aa={class:"q-mt-md"},na={key:1,class:"ais-Hits q-mt-md"},ia={class:"ais-Hits-list"},oa={key:2,class:"text-h5 q-mt-md"},sa={key:3},dt="typesense-search-history",la=Z({__name:"SearchJson",setup(e){const c=Xe(),p=N([]),i=N({q:"stark",query_by:"company_name",filter_by:"num_employees:>100",sort_by:"num_employees:desc",page:1,per_page:10,exhaustive_search:!0}),l=N(null),f=N(null),s=F(()=>c.currentCollection),u=F({get:()=>JSON.stringify(i.value,null,2),set:r=>{try{i.value=JSON.parse(r),l.value=null}catch(n){l.value=n.message}}}),y=F(()=>f.value?.hits?f.value.hits.map(r=>{const n=Object.assign({},r.document),_=b=>{if(b==null)return{value:String(b),matchLevel:"none"};if(Array.isArray(b))return b.map(m=>_(m));if(typeof b=="object"){const m={};for(const S in b)Object.prototype.hasOwnProperty.call(b,S)&&(m[S]=_(b[S]));return m}return{value:String(b),matchLevel:"none"}};return n._highlightResult=_(r.document),r.highlights.forEach(b=>{const m=b.field.split(".");let S=n._highlightResult;for(let O=0;O<m.length-1;O++){const z=m[O];S[z]!==void 0&&(S=S[z])}const q=m[m.length-1];S[q]!==void 0&&(Array.isArray(S[q])?S[q]=S[q].map(O=>typeof O=="object"&&O.value!==void 0?{...O,value:b.snippet,matchLevel:"full"}:{value:b.snippet,matchLevel:"full"}):typeof S[q]=="object"&&S[q].value!==void 0?S[q]={value:b.snippet,matchLevel:"full"}:S[q]={value:b.snippet,matchLevel:"full"})}),n}):[]),g=F(()=>JSON.stringify(f.value,null,2)),h=()=>{f.value&&c.exportToJson(f.value)},v=()=>{if(f.value?.hits){const r=f.value.hits.map(n=>n.document);c.exportToJson(r)}},o=()=>{nt.set(`${dt}-${s.value?.name||""}`,p.value.slice(0,20))},t=()=>{const r=u.value,n=p.value.indexOf(r);n!==0&&(n>0&&p.value.splice(n,1),p.value.unshift(r),o())},a=async()=>{f.value=null,l.value=null,t();try{f.value=await c.search(i.value)}catch(r){l.value=r.message}};return ve(s,()=>{p.value=nt.getItem(`${dt}-${s.value?.name||""}`)||[]},{immediate:!0}),(r,n)=>($(),H(V,null,[W("div",ea,[W("div",ta,[A($r,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=_=>u.value=_),style:{height:"30vh","min-height":"200px"}},null,8,["modelValue"])]),W("div",ra,[A(Lr,{style:{height:"100%"}},{default:M(()=>[A(Xt,{bordered:"",separator:"",dense:""},{default:M(()=>[A(se,{header:""},{default:M(()=>[...n[4]||(n[4]=[K("History",-1)])]),_:1}),($(!0),H(V,null,Y(p.value,_=>Je(($(),U(Ye,{key:_,clickable:"",title:_,onClick:b=>u.value=_},{default:M(()=>[A(fe,null,{default:M(()=>[K(J(_.slice(0,60)),1)]),_:2},1024)]),_:2},1032,["title","onClick"])),[[Ar]])),128))]),_:1})]),_:1})])]),l.value?($(),U(Yt,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:M(()=>[K(" Invalid Format: "+J(l.value),1)]),_:1})):Q("",!0),W("div",aa,[A(X,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!l.value,onClick:n[1]||(n[1]=_=>a())},{default:M(()=>[...n[5]||(n[5]=[K("Run Query",-1)])]),_:1},8,["disable"]),A(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!f.value||!f.value.hits,onClick:n[2]||(n[2]=_=>v())},{default:M(()=>[...n[6]||(n[6]=[K("Export Hits",-1)])]),_:1},8,["disable"]),A(X,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!f.value,onClick:n[3]||(n[3]=_=>h())},{default:M(()=>[...n[7]||(n[7]=[K("Export Raw Results",-1)])]),_:1},8,["disable"])]),y.value?($(),H("div",na,[W("ol",ia,[($(!0),H(V,null,Y(y.value,_=>($(),H("li",{key:_.id,class:"ais-Hits-item"},[A(Zt,{item:_},null,8,["item"])]))),128))])])):Q("",!0),f.value&&f.value.hits&&f.value.hits.length===0?($(),H("div",oa," No match found ")):Q("",!0),f.value&&!f.value.hits?($(),H("pre",sa,"          "+J(g.value)+`
        `,1)):Q("",!0)],64))}}),ua={mixins:[Mr({connector:Nr})],props:{delay:{type:Number,default:200,required:!1}},data(){return{timerId:null,localQuery:""}},computed:{query:{get(){return this.localQuery},set(e){this.localQuery=e,this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.state.refine(this.localQuery)},this.delay)}}},unmounted(){this.timerId&&clearTimeout(this.timerId)},methods:{clear(){this.query=""}}};function ca(e,c,p,i,l,f){return $(),U(Pr,{modelValue:f.query,"onUpdate:modelValue":c[0]||(c[0]=s=>f.query=s),dense:"",autofocus:"",outlined:"",type:"search",clearable:"","clear-icon":"close",placeholder:"Search...",onClear:f.clear},{prepend:M(()=>[A(Or,{name:"search"})]),_:1},8,["modelValue","onClear"])}const da=Kt(ua,[["render",ca]]);var ge={},be={exports:{}},ft;function le(){return ft||(ft=1,function(e){function c(p){return p&&p.__esModule?p:{default:p}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(be)),be.exports}var Se={exports:{}},xe={exports:{}},pt;function er(){return pt||(pt=1,function(e){function c(p,i){this.v=p,this.k=i}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(xe)),xe.exports}var Re={exports:{}},qe={exports:{}},vt;function tr(){return vt||(vt=1,function(e){function c(p,i,l,f){var s=Object.defineProperty;try{s({},"",{})}catch{s=0}e.exports=c=function(y,g,h,v){function o(t,a){c(y,t,function(d){return this._invoke(t,a,d)})}g?s?s(y,g,{value:h,enumerable:!v,configurable:!v,writable:!v}):y[g]=h:(o("next",0),o("throw",1),o("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,c(p,i,l,f)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(qe)),qe.exports}var ht;function rr(){return ht||(ht=1,function(e){var c=tr();function p(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var i,l,f=typeof Symbol=="function"?Symbol:{},s=f.iterator||"@@iterator",u=f.toStringTag||"@@toStringTag";function y(r,n,_,b){var m=n&&n.prototype instanceof h?n:h,S=Object.create(m.prototype);return c(S,"_invoke",function(q,O,z){var w,j,I,T=0,C=z||[],x=!1,R={p:0,n:0,v:i,a:k,f:k.bind(i,4),d:function(E,B){return w=E,j=0,I=i,R.n=B,g}};function k(P,E){for(j=P,I=E,l=0;!x&&T&&!B&&l<C.length;l++){var B,D=C[l],ee=R.p,de=D[2];P>3?(B=de===E)&&(I=D[(j=D[4])?5:(j=3,3)],D[4]=D[5]=i):D[0]<=ee&&((B=P<2&&ee<D[1])?(j=0,R.v=E,R.n=D[1]):ee<de&&(B=P<3||D[0]>E||E>de)&&(D[4]=P,D[5]=E,R.n=de,j=0))}if(B||P>1)return g;throw x=!0,E}return function(P,E,B){if(T>1)throw TypeError("Generator is already running");for(x&&E===1&&k(E,B),j=E,I=B;(l=j<2?i:I)||!x;){w||(j?j<3?(j>1&&(R.n=-1),k(j,I)):R.n=I:R.v=I);try{if(T=2,w){if(j||(P="next"),l=w[P]){if(!(l=l.call(w,I)))throw TypeError("iterator result is not an object");if(!l.done)return l;I=l.value,j<2&&(j=0)}else j===1&&(l=w.return)&&l.call(w),j<2&&(I=TypeError("The iterator does not provide a '"+P+"' method"),j=1);w=i}else if((l=(x=R.n<0)?I:q.call(O,R))!==g)break}catch(D){w=i,j=1,I=D}finally{T=1}}return{value:l,done:x}}}(r,_,b),!0),S}var g={};function h(){}function v(){}function o(){}l=Object.getPrototypeOf;var t=[][s]?l(l([][s]())):(c(l={},s,function(){return this}),l),a=o.prototype=h.prototype=Object.create(t);function d(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,o):(r.__proto__=o,c(r,u,"GeneratorFunction")),r.prototype=Object.create(a),r}return v.prototype=o,c(a,"constructor",o),c(o,"constructor",v),v.displayName="GeneratorFunction",c(o,u,"GeneratorFunction"),c(a),c(a,u,"Generator"),c(a,s,function(){return this}),c(a,"toString",function(){return"[object Generator]"}),(e.exports=p=function(){return{w:y,m:d}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(Re)),Re.exports}var Te={exports:{}},Ae={exports:{}},Oe={exports:{}},yt;function ar(){return yt||(yt=1,function(e){var c=er(),p=tr();function i(l,f){function s(y,g,h,v){try{var o=l[y](g),t=o.value;return t instanceof c?f.resolve(t.v).then(function(a){s("next",a,h,v)},function(a){s("throw",a,h,v)}):f.resolve(t).then(function(a){o.value=a,h(o)},function(a){return s("throw",a,h,v)})}catch(a){v(a)}}var u;this.next||(p(i.prototype),p(i.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),p(this,"_invoke",function(y,g,h){function v(){return new f(function(o,t){s(y,h,o,t)})}return u=u?u.then(v,v):v()},!0)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(Oe)),Oe.exports}var _t;function nr(){return _t||(_t=1,function(e){var c=rr(),p=ar();function i(l,f,s,u,y){return new p(c().w(l,f,s,u),y||Promise)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(Ae)),Ae.exports}var mt;function fa(){return mt||(mt=1,function(e){var c=nr();function p(i,l,f,s,u){var y=c(i,l,f,s,u);return y.next().then(function(g){return g.done?g.value:y.next()})}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(Te)),Te.exports}var Pe={exports:{}},gt;function pa(){return gt||(gt=1,function(e){function c(p){var i=Object(p),l=[];for(var f in i)l.unshift(f);return function s(){for(;l.length;)if((f=l.pop())in i)return s.value=f,s.done=!1,s;return s.done=!0,s}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Pe)),Pe.exports}var we={exports:{}},Ce={exports:{}},bt;function he(){return bt||(bt=1,function(e){function c(p){"@babel/helpers - typeof";return e.exports=c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},e.exports.__esModule=!0,e.exports.default=e.exports,c(p)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ce)),Ce.exports}var St;function va(){return St||(St=1,function(e){var c=he().default;function p(i){if(i!=null){var l=i[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],f=0;if(l)return l.call(i);if(typeof i.next=="function")return i;if(!isNaN(i.length))return{next:function(){return i&&f>=i.length&&(i=void 0),{value:i&&i[f++],done:!i}}}}throw new TypeError(c(i)+" is not iterable")}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(we)),we.exports}var xt;function ha(){return xt||(xt=1,function(e){var c=er(),p=rr(),i=fa(),l=nr(),f=ar(),s=pa(),u=va();function y(){var g=p(),h=g.m(y),v=(Object.getPrototypeOf?Object.getPrototypeOf(h):h.__proto__).constructor;function o(d){var r=typeof d=="function"&&d.constructor;return!!r&&(r===v||(r.displayName||r.name)==="GeneratorFunction")}var t={throw:1,return:2,break:3,continue:3};function a(d){var r,n;return function(_){r||(r={stop:function(){return n(_.a,2)},catch:function(){return _.v},abrupt:function(m,S){return n(_.a,t[m],S)},delegateYield:function(m,S,q){return r.resultName=S,n(_.d,u(m),q)},finish:function(m){return n(_.f,m)}},n=function(m,S,q){_.p=r.prev,_.n=r.next;try{return m(S,q)}finally{r.next=_.n}}),r.resultName&&(r[r.resultName]=_.v,r.resultName=void 0),r.sent=_.v,r.next=_.n;try{return d.call(this,r)}finally{_.p=r.prev,_.n=r.next}}}return(e.exports=y=function(){return{wrap:function(n,_,b,m){return g.w(a(n),_,b,m&&m.reverse())},isGeneratorFunction:o,mark:g.m,awrap:function(n,_){return new c(n,_)},AsyncIterator:f,async:function(n,_,b,m,S){return(o(_)?l:i)(a(n),_,b,m,S)},keys:s,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=y,e.exports.__esModule=!0,e.exports.default=e.exports}(Se)),Se.exports}var Ie,Rt;function ir(){if(Rt)return Ie;Rt=1;var e=ha()();Ie=e;try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}return Ie}var ke={exports:{}},qt;function or(){return qt||(qt=1,function(e){function c(i,l,f,s,u,y,g){try{var h=i[y](g),v=h.value}catch(o){return void f(o)}h.done?l(v):Promise.resolve(v).then(s,u)}function p(i){return function(){var l=this,f=arguments;return new Promise(function(s,u){var y=i.apply(l,f);function g(v){c(y,s,u,g,h,"next",v)}function h(v){c(y,s,u,g,h,"throw",v)}g(void 0)})}}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(ke)),ke.exports}var Fe={exports:{}},Tt;function ue(){return Tt||(Tt=1,function(e){function c(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Fe)),Fe.exports}var je={exports:{}},ze={exports:{}},$e={exports:{}},At;function ya(){return At||(At=1,function(e){var c=he().default;function p(i,l){if(c(i)!="object"||!i)return i;var f=i[Symbol.toPrimitive];if(f!==void 0){var s=f.call(i,l||"default");if(c(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(i)}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}($e)),$e.exports}var Ot;function sr(){return Ot||(Ot=1,function(e){var c=he().default,p=ya();function i(l){var f=p(l,"string");return c(f)=="symbol"?f:f+""}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(ze)),ze.exports}var Pt;function ce(){return Pt||(Pt=1,function(e){var c=sr();function p(l,f){for(var s=0;s<f.length;s++){var u=f[s];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(l,c(u.key),u)}}function i(l,f,s){return f&&p(l.prototype,f),s&&p(l,s),Object.defineProperty(l,"prototype",{writable:!1}),l}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}(je)),je.exports}var re={},wt;function _a(){if(wt)return re;wt=1;var e=le();Object.defineProperty(re,"__esModule",{value:!0}),re.Configuration=void 0;var c=e(ue()),p=e(ce());return re.Configuration=function(){function i(){var l,f,s,u,y,g,h,v,o,t,a,d,r,n=this,_,b,m,S,q,O,z,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,c.default)(this,i),this.server=w.server||{nodes:[{host:"localhost",port:"8108",path:"",protocol:"http"}]},this.server.cacheSearchResultsForSeconds=(l=this.server.cacheSearchResultsForSeconds)!==null&&l!==void 0?l:2*60,this.additionalSearchParameters=(f=w.additionalSearchParameters)!==null&&f!==void 0?f:{},this.additionalSearchParameters.query_by=(s=(u=this.additionalSearchParameters.queryBy)!==null&&u!==void 0?u:this.additionalSearchParameters.query_by)!==null&&s!==void 0?s:"",this.additionalSearchParameters.preset=(y=(g=this.additionalSearchParameters.preset)!==null&&g!==void 0?g:this.additionalSearchParameters.preset)!==null&&y!==void 0?y:"",this.additionalSearchParameters.sort_by=(h=(v=this.additionalSearchParameters.sortBy)!==null&&v!==void 0?v:this.additionalSearchParameters.sort_by)!==null&&h!==void 0?h:"",this.additionalSearchParameters.highlight_full_fields=(o=(t=this.additionalSearchParameters.highlightFullFields)!==null&&t!==void 0?t:this.additionalSearchParameters.highlight_full_fields)!==null&&o!==void 0?o:this.additionalSearchParameters.query_by,this.geoLocationField=(a=w.geoLocationField)!==null&&a!==void 0?a:"_geoloc",this.facetableFieldsWithSpecialCharacters=(d=w.facetableFieldsWithSpecialCharacters)!==null&&d!==void 0?d:[],this.collectionSpecificSearchParameters=(r=w.collectionSpecificSearchParameters)!==null&&r!==void 0?r:{},Object.keys(this.collectionSpecificSearchParameters).forEach(function(j){var I,T,C,x,R,k,P=n.collectionSpecificSearchParameters[j];P.query_by=(I=P.queryBy)!==null&&I!==void 0?I:P.query_by,P.preset=(T=P.preset)!==null&&T!==void 0?T:P.preset,P.sort_by=(C=P.sortBy)!==null&&C!==void 0?C:P.sort_by,P.highlight_full_fields=(x=(R=(k=P.highlightFullFields)!==null&&k!==void 0?k:P.highlight_full_fields)!==null&&R!==void 0?R:n.additionalSearchParameters.highlight_full_fields)!==null&&x!==void 0?x:P.query_by,Object.keys(P).forEach(function(E){return P[E]===void 0?delete P[E]:{}})}),this.renderingContent=w.renderingContent,this.flattenGroupedHits=(_=w.flattenGroupedHits)!==null&&_!==void 0?_:!0,this.facetByOptions=(b=w.facetByOptions)!==null&&b!==void 0?b:{},this.filterByOptions=(m=w.filterByOptions)!==null&&m!==void 0?m:{},this.sortByOptions=(S=w.sortByOptions)!==null&&S!==void 0?S:{},this.collectionSpecificFacetByOptions=(q=w.collectionSpecificFacetByOptions)!==null&&q!==void 0?q:{},this.collectionSpecificFilterByOptions=(O=w.collectionSpecificFilterByOptions)!==null&&O!==void 0?O:{},this.collectionSpecificSortByOptions=(z=w.collectionSpecificSortByOptions)!==null&&z!==void 0?z:{}}return(0,p.default)(i,[{key:"validate",value:function(){if((this.additionalSearchParameters.queryBy||Object.values(this.collectionSpecificSearchParameters).some(function(f){return f.queryBy}))&&console.warn("[typesense-instantsearch-adapter] Please use snake_cased versions of parameters in additionalSearchParameters instead of camelCased parameters. For example: Use query_by instead of queryBy. camelCased parameters will be deprecated in a future version. We're making this change so that parameter names are identical to the ones sent to Typesense (which are all snake_cased), and to also keep the types for these parameters in sync with the types defined in typesense-js."),this.additionalSearchParameters.query_by.length===0&&this.additionalSearchParameters.preset.length===0&&(Object.keys(this.collectionSpecificSearchParameters).length===0||Object.values(this.collectionSpecificSearchParameters).some(function(f){return(f.query_by||"").length===0&&(f.preset||"").length===0})))throw new Error("[typesense-instantsearch-adapter] Missing parameter: One of additionalSearchParameters.query_by or additionalSearchParameters.preset needs to be set, or all collectionSpecificSearchParameters need to have either .query_by or .preset set.")}}])}(),re}var ae={},Ee={exports:{}},Me={exports:{}},Ct;function ma(){return Ct||(Ct=1,function(e){function c(p,i){if(p==null)return{};var l={};for(var f in p)if({}.hasOwnProperty.call(p,f)){if(i.indexOf(f)!==-1)continue;l[f]=p[f]}return l}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Me)),Me.exports}var It;function ga(){return It||(It=1,function(e){var c=ma();function p(i,l){if(i==null)return{};var f,s,u=c(i,l);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(i);for(s=0;s<y.length;s++)f=y[s],l.indexOf(f)===-1&&{}.propertyIsEnumerable.call(i,f)&&(u[f]=i[f])}return u}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(Ee)),Ee.exports}var Ne={exports:{}},He={exports:{}},kt;function ba(){return kt||(kt=1,function(e){function c(p){if(Array.isArray(p))return p}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(He)),He.exports}var Le={exports:{}},Ft;function Sa(){return Ft||(Ft=1,function(e){function c(p,i){var l=p==null?null:typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(l!=null){var f,s,u,y,g=[],h=!0,v=!1;try{if(u=(l=l.call(p)).next,i===0){if(Object(l)!==l)return;h=!1}else for(;!(h=(f=u.call(l)).done)&&(g.push(f.value),g.length!==i);h=!0);}catch(o){v=!0,s=o}finally{try{if(!h&&l.return!=null&&(y=l.return(),Object(y)!==y))return}finally{if(v)throw s}}return g}}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Le)),Le.exports}var Be={exports:{}},De={exports:{}},jt;function lr(){return jt||(jt=1,function(e){function c(p,i){(i==null||i>p.length)&&(i=p.length);for(var l=0,f=Array(i);l<i;l++)f[l]=p[l];return f}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(De)),De.exports}var zt;function ur(){return zt||(zt=1,function(e){var c=lr();function p(i,l){if(i){if(typeof i=="string")return c(i,l);var f={}.toString.call(i).slice(8,-1);return f==="Object"&&i.constructor&&(f=i.constructor.name),f==="Map"||f==="Set"?Array.from(i):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?c(i,l):void 0}}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(Be)),Be.exports}var Ge={exports:{}},$t;function xa(){return $t||($t=1,function(e){function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ge)),Ge.exports}var Et;function cr(){return Et||(Et=1,function(e){var c=ba(),p=Sa(),i=ur(),l=xa();function f(s,u){return c(s)||p(s,u)||i(s,u)||l()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports}(Ne)),Ne.exports}var Mt;function Ra(){if(Mt)return ae;Mt=1;var e=le();Object.defineProperty(ae,"__esModule",{value:!0}),ae.SearchRequestAdapter=void 0;var c=e(ir()),p=e(ga()),i=e(or()),l=e(cr()),f=e(ue()),s=e(ce()),u=["q","conversation","conversation_id","conversation_model_id"];return ae.SearchRequestAdapter=function(){function y(g,h,v){(0,f.default)(this,y),this.instantsearchRequests=g,this.typesenseClient=h,this.configuration=v,this.additionalSearchParameters=v.additionalSearchParameters,this.collectionSpecificSearchParameters=v.collectionSpecificSearchParameters}return(0,s.default)(y,[{key:"_shouldUseExactMatchForField",value:function(h,v){var o,t;return!(((o=this.configuration.collectionSpecificFilterByOptions)===null||o===void 0||(o=o[v])===null||o===void 0||(o=o[h])===null||o===void 0?void 0:o.exactMatch)===!1||((t=this.configuration.filterByOptions)===null||t===void 0||(t=t[h])===null||t===void 0?void 0:t.exactMatch)===!1)}},{key:"_adaptFacetFilters",value:function(h,v){var o=this,t="";if(!h)return t;var a=h.map(function(d){if(Array.isArray(d)){var r={};d.forEach(function(P){var E=o._parseFacetFilter(P),B=E.fieldName,D=E.fieldValue;r[B]=r[B]||[],r[B].push(D)}),Object.keys(r).length>1&&console.error("[Typesense-Instantsearch-Adapter] Typesense does not support cross-field ORs at the moment. The adapter could not OR values between these fields: ".concat(Object.keys(r).join(",")));var n=Object.keys(r)[0],_=r[n],b=_.reduce(function(P,E){return E.startsWith("-")&&!o._isNumber(E)?P[0].push(E.substring(1)):P[1].push(E),P},[[],[]]),m=(0,l.default)(b,2),S=m[0],q=m[1],O=[];if(q.length>0){var z=o._shouldUseExactMatchForField(n,v)?":=":":";O.push("".concat(n).concat(z,"[").concat(q.map(function(P){return o._escapeFacetValue(P)}).join(","),"]"))}if(S.length>0){var w=o._shouldUseExactMatchForField(n,v)?":!=":":!";O.push("".concat(n).concat(w,"[").concat(S.map(function(P){return o._escapeFacetValue(P)}).join(","),"]"))}var j=O.filter(function(P){return P}).join(" && ");return j}else{var I=o._parseFacetFilter(d),T=I.fieldName,C=I.fieldValue,x;if(C.startsWith("-")&&!o._isNumber(C)){var R=o._shouldUseExactMatchForField(T,v)?":!=":":!";x="".concat(T).concat(R,"[").concat(o._escapeFacetValue(C.substring(1)),"]")}else{var k=o._shouldUseExactMatchForField(T,v)?":=":":";x="".concat(T).concat(k,"[").concat(o._escapeFacetValue(C),"]")}return x}});return t=a.join(" && "),t}},{key:"_parseFacetFilter",value:function(h){var v,o,t,a,d;if(((v=this.configuration.facetableFieldsWithSpecialCharacters)===null||v===void 0?void 0:v.length)>0){var r=this.configuration.facetableFieldsWithSpecialCharacters.flat().map(function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(o=new RegExp("^(".concat(r.join("|"),"):(.*)$")),t=h.match(o),t!=null)return a="".concat(t[1]),d="".concat(t[2]),{fieldName:a,fieldValue:d}}return o=this.constructor.DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX,t=h.match(o),t==null?console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a facet filter `".concat(h,"` with the Regex `").concat(o,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter.")):(a="".concat(t[1]).concat(t[2]),d="".concat(t[3])),{fieldName:a,fieldValue:d}}},{key:"_escapeFacetValue",value:function(h){return typeof h=="boolean"||h==="true"||h==="false"||this._isNumber(h)?h:"`".concat(h,"`")}},{key:"_isNumber",value:function(h){return Number.isInteger(h%1)||!!(h%1)}},{key:"_adaptNumericFilters",value:function(h){var v=this,o="";if(!h)return o;var t={};h.forEach(function(d){var r=v._parseNumericFilter(d),n=r.fieldName,_=r.operator,b=r.fieldValue;t[n]=t[n]||{},t[n][_]=b});var a=[];return Object.keys(t).forEach(function(d){t[d]["<="]!=null&&t[d][">="]!=null?a.push("".concat(d,":=[").concat(t[d][">="],"..").concat(t[d]["<="],"]")):t[d]["<="]!=null?a.push("".concat(d,":<=").concat(t[d]["<="])):t[d][">="]!=null?a.push("".concat(d,":>=").concat(t[d][">="])):t[d]["="]!=null?a.push("".concat(d,":=").concat(t[d]["="])):console.warn("[Typesense-Instantsearch-Adapter] Unsupported operator found ".concat(JSON.stringify(t[d])))}),o=a.join(" && "),o}},{key:"_parseNumericFilter",value:function(h){var v,o,t,a,d,r;if(((v=this.configuration.facetableFieldsWithSpecialCharacters)===null||v===void 0?void 0:v.length)>0){var n=this.configuration.facetableFieldsWithSpecialCharacters.map(function(q){return q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")});if(o=new RegExp("^(".concat(n.join("|"),")(<=|>=|>|<|=)(.*)$")),t=h.match(o),t!=null){var _=t,b=(0,l.default)(_,4);return a=b[1],d=b[2],r=b[3],{fieldName:a,operator:d,fieldValue:r}}}if(o=this.constructor.DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX,t=h.match(o),t==null)console.error("[Typesense-Instantsearch-Adapter] Parsing failed for a numeric filter `".concat(h,"` with the Regex `").concat(o,"`. If you have field names with special characters, be sure to add them to a parameter called `facetableFieldsWithSpecialCharacters` when instantiating the adapter."));else{var m=t,S=(0,l.default)(m,4);a=S[1],d=S[2],r=S[3]}return{fieldName:a,operator:d,fieldValue:r}}},{key:"_adaptGeoFilter",value:function(h){var v=h.insideBoundingBox,o=h.aroundRadius,t=h.aroundLatLng,a=h.insidePolygon;if(v){var d,r,n,_;if(Array.isArray(v)){var b=v.flat(),m=(0,l.default)(b,4);d=m[0],r=m[1],n=m[2],_=m[3]}else{var S=v.split(","),q=(0,l.default)(S,4);d=q[0],r=q[1],n=q[2],_=q[3]}return"".concat(this.configuration.geoLocationField,":(").concat(d,", ").concat(r,", ").concat(d,", ").concat(_,", ").concat(n,", ").concat(_,", ").concat(n,", ").concat(r,")")}if(t||o){if(!o||o==="all")throw new Error("[Typesense-Instantsearch-Adapter] In Typesense, geo-filtering around a lat/lng also requires a numerical radius. So the `aroundRadius` parameter is required when `aroundLatLng` is used. If you intend to just geo-sort around a lat/long, you want to use the sortBy InstantSearch widget (or a virtual sortBy custom widget).");var O="".concat(parseFloat(o)/1e3," km");return"".concat(this.configuration.geoLocationField,":(").concat(t,", ").concat(O,")")}if(a){var z=a;return Array.isArray(a)&&(z=a.flat().join(",")),"".concat(this.configuration.geoLocationField,":(").concat(z,")")}}},{key:"_adaptFilters",value:function(h,v){var o=[];return h.filters&&o.push(h.filters),o.push(this._adaptFacetFilters(h.facetFilters,v)),o.push(this._adaptNumericFilters(h.numericFilters)),o.push(this._adaptGeoFilter(h)),o.filter(function(t){return t&&t!==""}).join(" && ")}},{key:"_adaptIndexName",value:function(h){return h.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[1]}},{key:"_adaptSortBy",value:function(h){return h.match(this.constructor.INDEX_NAME_MATCHING_REGEX)[3]}},{key:"_adaptFacetBy",value:function(h,v){var o=this;return[h].flat().map(function(t){var a;return(a=o.configuration.collectionSpecificFacetByOptions)!==null&&a!==void 0&&(a=a[v])!==null&&a!==void 0&&a[t]?"".concat(t).concat(o.configuration.collectionSpecificFacetByOptions[v][t]):o.configuration.facetByOptions[t]?"".concat(t).concat(o.configuration.facetByOptions[t]):t}).join(",")}},{key:"_adaptRulesContextsToOverrideTags",value:function(h){return h.join(",")}},{key:"_buildSearchParameters",value:function(h){for(var v,o,t=h.params,a=h.indexName,d=this._adaptIndexName(a),r={},n=0,_=Object.entries(this.additionalSearchParameters);n<_.length;n++){var b=(0,l.default)(_[n],2),m=b[0],S=b[1];r[this._camelToSnakeCase(m)]=S}if(this.collectionSpecificSearchParameters[d])for(var q=0,O=Object.entries(this.collectionSpecificSearchParameters[d]);q<O.length;q++){var z=(0,l.default)(O[q],2),w=z[0],j=z[1];r[this._camelToSnakeCase(w)]=j}var I=Object.assign({},r),T=this._adaptSortBy(a);Object.assign(I,{collection:d,q:t.query===""||t.query===void 0?"*":t.query,facet_by:r.facet_by||this._adaptFacetBy(t.facets,d),filter_by:this._adaptFilters(t,d)||r.filter_by,sort_by:T||r.sort_by,max_facet_values:t.maxValuesPerFacet,page:(t.page||0)+1}),t.hitsPerPage!=null&&(I.per_page=t.hitsPerPage),t.facetQuery&&(I.facet_query="".concat(t.facetName,":").concat(t.facetQuery),I.per_page=0),t.ruleContexts&&t.ruleContexts.length>0&&(I.override_tags=this._adaptRulesContextsToOverrideTags(t.ruleContexts)),t.typesenseVectorQuery&&(I.vector_query=t.typesenseVectorQuery);var C=((v=this.configuration.collectionSpecificSortByOptions)===null||v===void 0||(v=v[d])===null||v===void 0?void 0:v[I.sort_by])||((o=this.configuration.sortByOptions)===null||o===void 0?void 0:o[I.sort_by]);return C?.enable_overrides!=null&&(I.enable_overrides=C.enable_overrides),Object.fromEntries(Object.entries(I).filter(function(x){var R=(0,l.default)(x,2);R[0];var k=R[1];return k!=null&&k!==""}))}},{key:"_camelToSnakeCase",value:function(h){return h.split(/(?=[A-Z])/).join("_").toLowerCase()}},{key:"request",value:function(){var g=(0,i.default)(c.default.mark(function v(){var o=this,t,a,d,r,n,_,b,m,S;return c.default.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return d=this.instantsearchRequests.map(function(z){return o._buildSearchParameters(z)}),r={},(((t=d[0])===null||t===void 0?void 0:t.conversation)===!0||((a=d[0])===null||a===void 0?void 0:a.conversation)==="true")&&(n=d[0],_=n.q,b=n.conversation,m=n.conversation_id,S=n.conversation_model_id,r={q:_,conversation:b,conversation_id:m,conversation_model_id:S},d=d.map(function(z){z.q,z.conversation,z.conversation_id,z.conversation_model_id;var w=(0,p.default)(z,u);return w})),O.abrupt("return",this.typesenseClient.multiSearch.perform({searches:d},r));case 4:case"end":return O.stop()}},v,this)}));function h(){return g.apply(this,arguments)}return h}()}],[{key:"INDEX_NAME_MATCHING_REGEX",get:function(){return new RegExp("^(.+?)(?=(/sort/(.*))|$)")}},{key:"DEFAULT_FACET_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*)((?!:).):(?!:)(.*)")}},{key:"DEFAULT_NUMERIC_FILTER_STRING_MATCHING_REGEX",get:function(){return new RegExp("(.*?)(<=|>=|>|<|=)(.*)")}}])}(),ae}var ne={},We={exports:{}},Qe={exports:{}},Nt;function qa(){return Nt||(Nt=1,function(e){var c=lr();function p(i){if(Array.isArray(i))return c(i)}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(Qe)),Qe.exports}var Ue={exports:{}},Ht;function Ta(){return Ht||(Ht=1,function(e){function c(p){if(typeof Symbol<"u"&&p[Symbol.iterator]!=null||p["@@iterator"]!=null)return Array.from(p)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ue)),Ue.exports}var Ve={exports:{}},Lt;function Aa(){return Lt||(Lt=1,function(e){function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}(Ve)),Ve.exports}var Bt;function Oa(){return Bt||(Bt=1,function(e){var c=qa(),p=Ta(),i=ur(),l=Aa();function f(s){return c(s)||p(s)||i(s)||l()}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports}(We)),We.exports}var Ke={exports:{}},Dt;function Pa(){return Dt||(Dt=1,function(e){var c=sr();function p(i,l,f){return(l=c(l))in i?Object.defineProperty(i,l,{value:f,enumerable:!0,configurable:!0,writable:!0}):i[l]=f,i}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports}(Ke)),Ke.exports}var ie={},Gt;function dr(){return Gt||(Gt=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.utils=void 0,ie.utils={_adaptHighlightTag:function(c,p,i){return c.replace(new RegExp("<mark>","g"),p||"<mark>").replace(new RegExp("</mark>","g"),i||"</mark>")},_adaptNumberOfPages:function(){var c=this.typesenseResponse.found/this.typesenseResponse.request_params.per_page;return Number.isFinite(c)?Math.ceil(c):1}}),ie}var Wt;function wa(){if(Wt)return ne;Wt=1;var e=le();Object.defineProperty(ne,"__esModule",{value:!0}),ne.SearchResponseAdapter=void 0;var c=e(he()),p=e(cr()),i=e(Oa()),l=e(Pa()),f=e(ue()),s=e(ce()),u=dr();function y(v,o){var t=Object.keys(v);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(v);o&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(v,d).enumerable})),t.push.apply(t,a)}return t}function g(v){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?y(Object(t),!0).forEach(function(a){(0,l.default)(v,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach(function(a){Object.defineProperty(v,a,Object.getOwnPropertyDescriptor(t,a))})}return v}var h=ne.SearchResponseAdapter=function(){function v(o,t,a){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};(0,f.default)(this,v),this.typesenseResponse=o,this.instantsearchRequest=t,this.configuration=a,this.allTypesenseResults=d,this.fullTypesenseResponse=r}return(0,s.default)(v,[{key:"_adaptGroupedHits",value:function(t){var a=this,d=[];return d=t.map(function(r){var n=a._adaptHits(r.hits);return n.forEach(function(_){_.group_key=_._group_key=r.group_key,r.found&&(_._group_found=r.found)}),n}),this.configuration.flattenGroupedHits?d=d.flat():d=d.map(function(r){return g(g({},r[0]),{},{_grouped_hits:r})}),d}},{key:"_adaptHits",value:function(t){var a=this,d=[];return d=t.map(function(r){var n=g({},r.document);n.objectID=r.document.id,n._snippetResult=a._adaptHighlightResult(r,"snippet"),n._highlightResult=a._adaptHighlightResult(r,"value"),n._rawTypesenseHit=r,a.fullTypesenseResponse.conversation&&(n._rawTypesenseConversation=a.fullTypesenseResponse.conversation),["text_match","geo_distance_meters","curated","text_match_info","hybrid_search_info","vector_distance"].forEach(function(b){Object.keys(r).includes(b)&&!Object.keys(n).includes(b)&&(n[b]=r[b])});var _=n[a.configuration.geoLocationField];return _&&(n._geoloc={lat:_[0],lng:_[1]}),n}),d}},{key:"_adaptHighlightResult",value:function(t,a){var d={};return t.highlight!=null&&this.isHighlightPost0240RCN32Format(t.highlight)?this.adaptHighlightObject(t,d,a):this.adaptHighlightsArray(t,d,a),d}},{key:"isHighlightPost0240RCN32Format",value:function(t){return t.full==null&&t.snippet==null}},{key:"adaptHighlightsArray",value:function(t,a,d){var r=this;Object.assign.apply(Object,[a].concat((0,i.default)(Object.entries(t.document).map(function(n){var _=(0,p.default)(n,2),b=_[0],m=_[1];return(0,l.default)({},b,{value:m,matchLevel:"none",matchedWords:[]})})))),t.highlights.forEach(function(n){a[n.field]={value:n[d]||n["".concat(d,"s")],matchLevel:"full",matchedWords:n.matched_tokens},n.indices&&(a[n.field].matchedIndices=n.indices)}),Object.entries(a).forEach(function(n){var _=(0,p.default)(n,2),b=_[0],m=_[1],S=b,q=m.value,O=m.matchLevel,z=m.matchedWords,w=m.matchedIndices;q==null?a[S]=r._adaptHighlightNullValue():Array.isArray(q)?(a[S]=[],t.document[S].forEach(function(j,I){w&&w.includes(I)?a[S].push({value:r._adaptHighlightTag("".concat(q[w.indexOf(I)]),r.instantsearchRequest.params.highlightPreTag,r.instantsearchRequest.params.highlightPostTag),matchLevel:O,matchedWords:z[I]}):(0,c.default)(j)==="object"?a[S].push(r._adaptHighlightInObjectValue(j,{},d)):a[S].push({value:"".concat(j),matchLevel:"none",matchedWords:[]})})):(0,c.default)(q)==="object"?a[S]=r._adaptHighlightInObjectValue(q,{},d):a[S].value=r._adaptHighlightTag("".concat(q),r.instantsearchRequest.params.highlightPreTag,r.instantsearchRequest.params.highlightPostTag)})}},{key:"adaptHighlightObject",value:function(t,a,d){Object.assign(a,this._adaptHighlightInObjectValue(t.document,t.highlight,d))}},{key:"_adaptHighlightInObjectValue",value:function(t,a,d){var r=this;return Object.assign.apply(Object,[{}].concat((0,i.default)(Object.entries(t).map(function(n){var _=(0,p.default)(n,2),b=_[0],m=_[1],S;if(m==null)S=r._adaptHighlightNullValue();else if(Array.isArray(m)){var q;S=r._adaptHighlightInArrayValue(m,(q=a?.[b])!==null&&q!==void 0?q:[],d)}else if((0,c.default)(m)==="object"){var O;S=r._adaptHighlightInObjectValue(m,(O=a?.[b])!==null&&O!==void 0?O:{},d)}else S=r._adaptHighlightInPrimitiveValue(m,a?.[b],d);return(0,l.default)({},b,S)}))))}},{key:"_adaptHighlightInArrayValue",value:function(t,a,d){var r=this;return t.map(function(n,_){var b;if(n==null)b=r._adaptHighlightNullValue();else if(Array.isArray(n)){var m;b=r._adaptHighlightInArrayValue(n,(m=a?.[_])!==null&&m!==void 0?m:[],d)}else if((0,c.default)(n)==="object"){var S;b=r._adaptHighlightInObjectValue(n,(S=a?.[_])!==null&&S!==void 0?S:{},d)}else b=r._adaptHighlightInPrimitiveValue(n,a?.[_],d);return b})}},{key:"_adaptHighlightInPrimitiveValue",value:function(t,a,d){if(a!=null){var r,n;return{value:this._adaptHighlightTag("".concat((r=(n=a[d])!==null&&n!==void 0?n:a.highlight)!==null&&r!==void 0?r:a.snippet),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:(a.matched_tokens||[]).length>0?"full":"none",matchedWords:a.matched_tokens||[]}}else return{value:this._adaptHighlightTag("".concat(t),this.instantsearchRequest.params.highlightPreTag,this.instantsearchRequest.params.highlightPostTag),matchLevel:"none",matchedWords:[]}}},{key:"_adaptHighlightNullValue",value:function(){return{value:"",matchLevel:"none",matchedWords:[]}}},{key:"_adaptFacets",value:function(t){var a={};return t.forEach(function(d){Object.assign(a,(0,l.default)({},d.field_name,Object.assign.apply(Object,[{}].concat((0,i.default)(d.counts.map(function(r){return(0,l.default)({},r.value,r.count)}))))))}),a}},{key:"_adaptFacetStats",value:function(t){var a={};return t.forEach(function(d){Object.keys(d.stats).length>0&&Object.assign(a,(0,l.default)({},d.field_name,d.stats))}),a}},{key:"_adaptRenderingContent",value:function(t){var a,d=Object.assign({},this.configuration.renderingContent);return((a=d.facetOrdering)===null||a===void 0||(a=a.facets)===null||a===void 0?void 0:a.order)==null&&(d.facetOrdering=d.facetOrdering||{},d.facetOrdering.facets=d.facetOrdering.facets||{},d.facetOrdering.facets.order=(0,i.default)(new Set(t.map(function(r){return r.field_name}).concat(this.allTypesenseResults.map(function(r){return r.facet_counts||[]}).flat().map(function(r){return r.field_name}).filter(function(r){return r}))))),d}},{key:"_adaptUserData",value:function(t){return t?Array.isArray(t)?t:[t]:[]}},{key:"adapt",value:function(){var t=this._adaptRenderingContent(this.typesenseResponse.facet_counts||[]),a=g({hits:this.typesenseResponse.grouped_hits?this._adaptGroupedHits(this.typesenseResponse.grouped_hits):this._adaptHits(this.typesenseResponse.hits),nbHits:this.typesenseResponse.found,page:this.typesenseResponse.page-1,nbPages:this._adaptNumberOfPages(),hitsPerPage:this.typesenseResponse.request_params.per_page,facets:this._adaptFacets(this.typesenseResponse.facet_counts||[]),facets_stats:this._adaptFacetStats(this.typesenseResponse.facet_counts||{}),query:this.typesenseResponse.request_params.q,processingTimeMS:this.typesenseResponse.search_time_ms},Object.keys(t).length>0?{renderingContent:t}:null);return this.typesenseResponse.metadata&&(a.appliedRules=["typesense-override"],a.userData=this._adaptUserData(this.typesenseResponse.metadata)),this.fullTypesenseResponse.conversation&&a.hits.length===0&&(a.hits=[{_rawTypesenseConversation:this.fullTypesenseResponse.conversation}]),a}}])}();return Object.assign(h.prototype,u.utils),ne}var oe={},Qt;function Ca(){if(Qt)return oe;Qt=1;var e=le();Object.defineProperty(oe,"__esModule",{value:!0}),oe.FacetSearchResponseAdapter=void 0;var c=e(ue()),p=e(ce()),i=dr(),l=oe.FacetSearchResponseAdapter=function(){function f(s,u){(0,c.default)(this,f),this.typesenseResponse=s,this.instantsearchRequest=u}return(0,p.default)(f,[{key:"_adaptFacetHits",value:function(u){var y=this,g={},h=u.find(function(v){return v.field_name===y.instantsearchRequest.params.facetName});return g=h.counts.map(function(v){return{value:v.value,highlighted:y._adaptHighlightTag(v.highlighted,y.instantsearchRequest.params.highlightPreTag,y.instantsearchRequest.params.highlightPostTag),count:v.count}}),g}},{key:"adapt",value:function(){var u={facetHits:this._adaptFacetHits(this.typesenseResponse.facet_counts),exhaustiveFacetsCount:!0,processingTimeMS:this.typesenseResponse.search_time_ms};return u}}])}();return Object.assign(l.prototype,i.utils),oe}var Ut;function Ia(){return Ut||(Ut=1,function(e){var c=le();Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p=c(ir()),i=c(or()),l=c(ue()),f=c(ce()),s=_a(),u=wr(),y=Ra(),g=wa(),h=Ca();e.default=function(){function v(o){var t=this;(0,l.default)(this,v),this.updateConfiguration(o),this.searchClient={clearCache:function(){return t.clearCache()},search:function(d){return t.searchTypesenseAndAdapt(d)},searchForFacetValues:function(d){return t.searchTypesenseForFacetValuesAndAdapt(d)}}}return(0,f.default)(v,[{key:"searchTypesenseAndAdapt",value:function(){var o=(0,i.default)(p.default.mark(function a(d){var r=this,n,_;return p.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return n=m.sent,_=n.results.map(function(S,q){r._validateTypesenseResult(S);var O=new g.SearchResponseAdapter(S,d[q],r.configuration,n.results,n),z=O.adapt();return z}),m.abrupt("return",{results:_});case 8:throw m.prev=8,m.t0=m.catch(0),console.error(m.t0),m.t0;case 12:case"end":return m.stop()}},a,this,[[0,8]])}));function t(a){return o.apply(this,arguments)}return t}()},{key:"searchTypesenseForFacetValuesAndAdapt",value:function(){var o=(0,i.default)(p.default.mark(function a(d){var r=this,n,_;return p.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,this._adaptAndPerformTypesenseRequest(d);case 3:return n=m.sent,_=n.results.map(function(S,q){r._validateTypesenseResult(S);var O=new h.FacetSearchResponseAdapter(S,d[q],r.configuration);return O.adapt()}),m.abrupt("return",_);case 8:throw m.prev=8,m.t0=m.catch(0),console.error(m.t0),m.t0;case 12:case"end":return m.stop()}},a,this,[[0,8]])}));function t(a){return o.apply(this,arguments)}return t}()},{key:"_adaptAndPerformTypesenseRequest",value:function(){var o=(0,i.default)(p.default.mark(function a(d){var r,n;return p.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return r=new y.SearchRequestAdapter(d,this.typesenseClient,this.configuration),b.next=3,r.request();case 3:return n=b.sent,b.abrupt("return",n);case 5:case"end":return b.stop()}},a,this)}));function t(a){return o.apply(this,arguments)}return t}()},{key:"clearCache",value:function(){return this.typesenseClient=new u.SearchClient(this.configuration.server),this.searchClient}},{key:"updateConfiguration",value:function(t){return this.configuration=new s.Configuration(t),this.configuration.validate(),this.typesenseClient=new u.SearchClient(this.configuration.server),!0}},{key:"_validateTypesenseResult",value:function(t){if(t.error)throw new Error("".concat(t.code," - ").concat(t.error));if(!t.hits&&!t.grouped_hits)throw new Error("Did not find any hits. ".concat(t.code," - ").concat(t.error))}}])}()}(ge)),ge}var ka=Ia();const Fa=Cr(ka),ja={class:"row q-mt-md"},za={class:"col-3 q-pr-sm"},$a={class:"text-subtitle2 q-pt-md"},Ea={class:"text-subtitle2 q-pt-md"},Ma={class:"text-subtitle2 q-pt-md"},Na={class:"col-9"},Ha={key:1},La=Z({__name:"SearchInstantSearch",setup(e){const c=Xe(),p=N(null),i=N(),l=N(),f=N(null),s=N(null),u=[({instantSearchInstance:r})=>({subscribe(){l.value=r},unsubscribe(){l.value=null}})],y=F(()=>c.currentCollection),g=F(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(r=>r.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(r.type)&&!r.name.includes(".*")).map(r=>r.name)),h=F(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(r=>r.facet&&["string","string[]"].includes(r.type)&&!r.name.includes(".*")).map(r=>r.name)),v=F(()=>!y.value||!y.value.fields?[]:y.value.fields.filter(r=>r.facet&&["bool","bool[]"].includes(r.type)&&!r.name.includes(".*")).map(r=>r.name)),o=F(()=>{if(!y.value||!y.value.fields)return[];const r=[{value:y.value.name,label:"Default"}];return y.value.fields.filter(n=>["int32","float"].includes(n.type)||n.type==="string"&&n.sort).forEach(n=>{y.value&&(r.push({value:`${y.value.name}/sort/${n.name}:asc`,label:`${n.name} asc`}),r.push({value:`${y.value.name}/sort/${n.name}:desc`,label:`${n.name} desc`}))}),r}),t=F(()=>c.data.stopwords.map(r=>r.id)),a=()=>{l.value&&y.value&&c.exportToJson(l.value.renderState[y.value.name].hits.results.hits)},d=()=>{i.value&&y.value&&i.value.updateConfiguration({...i.value.configuration,additionalSearchParameters:{...i.value.configuration.additionalSearchParameters,stopwords:s.value}})};return ve(()=>y.value,()=>{p.value=null,f.value=null,window.setTimeout(()=>{if(!c.loginData||!y.value)return;const r=(y.value?.fields||[]).filter(n=>n.index&&["string","string[]"].includes(n.type)&&!n.name.includes(".*")).map(n=>n.name).join(",");try{const n=new Fa({server:{nodes:[{...c.loginData.node}],apiKey:c.loginData.apiKey},additionalSearchParameters:{exhaustive_search:!0,query_by:r}});i.value=n,p.value=n.searchClient}catch(n){f.value=n.message+"Using query_by: "+r,console.error(n)}})},{immediate:!0}),(r,n)=>{const _=G("ais-configure"),b=G("ais-search-box"),m=G("ais-stats"),S=G("ais-current-refinements"),q=G("ais-hits-per-page"),O=G("ais-sort-by"),z=G("ais-range-input"),w=G("ais-refinement-list"),j=G("ais-pagination"),I=G("ais-hits"),T=G("ais-instant-search");return p.value&&y.value?($(),U(T,{key:0,"search-client":p.value,"index-name":y.value.name,middlewares:u},{default:M(()=>[A(_,{hitsPerPage:12}),A(b,{"index-name":"instant_search","search-client":p.value},{default:M(()=>[A(da)]),_:1},8,["search-client"]),A(m),A(S),W("div",ja,[W("div",za,[A(q,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"250 hits per page",value:250}]}),A(X,{flat:"",onClick:n[0]||(n[0]=C=>a())},{default:M(()=>[...n[4]||(n[4]=[K("export current page",-1)])]),_:1}),n[5]||(n[5]=W("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1)),A(O,{items:o.value},null,8,["items"]),n[6]||(n[6]=W("div",{class:"text-subtitle2 q-pt-md"},"Stopwords",-1)),A(jr,{modelValue:s.value,"onUpdate:modelValue":[n[1]||(n[1]=C=>s.value=C),n[2]||(n[2]=C=>d())],disable:!Ir(c).data.features.stopwords,outlined:"",clearable:"",dense:"","options-dense":"",options:t.value},null,8,["modelValue","disable","options"]),($(!0),H(V,null,Y(g.value,C=>($(),H("div",{key:C,class:"q-mb-sm"},[W("div",$a,J(C),1),A(z,{searchable:!0,attribute:C},null,8,["attribute"])]))),128)),($(!0),H(V,null,Y(h.value,C=>($(),H("div",{key:C,class:"q-mb-sm"},[W("div",Ea,J(C),1),A(w,{class:"q-mb-sm",searchable:!0,attribute:C},null,8,["attribute"])]))),128)),($(!0),H(V,null,Y(v.value,C=>($(),H("div",{key:C,class:"q-mb-sm"},[W("div",Ma,J(C),1),A(w,{class:"q-mb-sm",attribute:C},null,8,["attribute"])]))),128))]),W("div",Na,[A(j,{class:"q-mb-md"}),A(I,null,kr({_:2},[y.value?{name:"item",fn:M(({item:C})=>[A(Zt,{item:C,onDeleted:n[3]||(n[3]=x=>l.value.refresh())},null,8,["item"])]),key:"0"}:void 0]),1024),A(j,{class:"q-my-md"})])])]),_:1},8,["search-client","index-name"])):f.value?($(),H("div",Ha,[A(Yt,{"inline-actions":"",class:"text-white bg-red"},{default:M(()=>[K(J(f.value),1)]),_:1})])):Q("",!0)}}}),tn=Z({__name:"Search",setup(e){const c=N("form");return(p,i)=>($(),U(Fr,{padding:""},{default:M(()=>[A(fr,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=l=>c.value=l),dense:"",class:"bg-primary text-white",align:"justify","narrow-indicator":""},{default:M(()=>[A(Ze,{name:"form",label:"InstantSearch Mode"}),A(Ze,{name:"json",label:"JSON Mode"})]),_:1},8,["modelValue"]),A(Jt),A(pr,{modelValue:c.value,"onUpdate:modelValue":i[1]||(i[1]=l=>c.value=l),animated:"","keep-alive":""},{default:M(()=>[A(et,{name:"form"},{default:M(()=>[A(La)]),_:1}),A(et,{name:"json",class:"q-pa-none"},{default:M(()=>[A(la)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{tn as default};
