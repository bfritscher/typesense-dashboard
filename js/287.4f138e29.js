"use strict";(self["webpackChunktypesense_dashboard"]=self["webpackChunktypesense_dashboard"]||[]).push([[287],{96287:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Q});var n=i(83673),l=i(62323);const s={class:"row q-mt-md"},a={class:"col-3 q-pr-sm"},r=(0,n.Uk)("export current page"),c=(0,n._)("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1),o={class:"text-subtitle2 q-pt-md"},u={class:"text-subtitle2 q-pt-md"},m={class:"col-9"};function d(e,t,i,d,h,p){const f=(0,n.up)("ais-configure"),w=(0,n.up)("ais-search-box"),g=(0,n.up)("ais-stats"),b=(0,n.up)("ais-current-refinements"),y=(0,n.up)("ais-hits-per-page"),C=(0,n.up)("q-btn"),v=(0,n.up)("ais-sort-by"),_=(0,n.up)("ais-range-input"),W=(0,n.up)("ais-refinement-list"),k=(0,n.up)("ais-pagination"),q=(0,n.up)("search-result-item"),D=(0,n.up)("ais-hits"),x=(0,n.up)("ais-instant-search"),S=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(S,{padding:""},{default:(0,n.w5)((()=>[e.searchClient&&e.currentCollection?((0,n.wg)(),(0,n.j4)(x,{key:0,"search-client":e.searchClient,"index-name":e.currentCollection.name,middlewares:e.middlewares},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{hitsPerPage:12}),(0,n.Wm)(w,{placeholder:""}),(0,n.Wm)(g),(0,n.Wm)(b),(0,n._)("div",s,[(0,n._)("div",a,[(0,n.Wm)(y,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"1000 hits per page",value:1e3}]}),(0,n.Wm)(C,{flat:"",onClick:t[0]||(t[0]=t=>e.exportPage())},{default:(0,n.w5)((()=>[r])),_:1}),c,(0,n.Wm)(v,{items:e.sortBy},null,8,["items"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.facetNumberFields,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"q-mb-sm",key:e},[(0,n._)("div",o,(0,l.zw)(e),1),(0,n.Wm)(_,{searchable:!0,attribute:e},null,8,["attribute"])])))),128)),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.facetStringFields,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"q-mb-sm",key:e},[(0,n._)("div",u,(0,l.zw)(e),1),(0,n.Wm)(W,{class:"q-mb-sm",searchable:!0,attribute:e},null,8,["attribute"])])))),128))]),(0,n._)("div",m,[(0,n.Wm)(k,{class:"q-mb-md"}),(0,n.Wm)(D,null,(0,n.Nv)({_:2},[e.currentCollection?{name:"item",fn:(0,n.w5)((({item:e})=>[(0,n.Wm)(q,{item:e},null,8,["item"])]))}:void 0]),1024),(0,n.Wm)(k,{class:"q-my-md"})])])])),_:1},8,["search-client","index-name","middlewares"])):(0,n.kq)("",!0)])),_:1})}const h={key:0},p={key:0},f=["innerHTML"];function w(e,t,i,s,a,r){const c=(0,n.up)("q-item-label"),o=(0,n.up)("q-item-section"),u=(0,n.up)("ais-highlight"),m=(0,n.up)("q-item"),d=(0,n.up)("q-separator"),w=(0,n.up)("q-btn"),g=(0,n.up)("q-list");return e.currentCollection?((0,n.wg)(),(0,n.iD)("div",h,[(0,n.Wm)(g,{dense:""},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.currentCollection.fields,(t=>((0,n.wg)(),(0,n.j4)(m,{key:t.name},{default:(0,n.w5)((()=>[(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{caption:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(t.name),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(o,{side:"",class:"q-ml-xl text-body2"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"overflow-hidden text-no-wrap text-ellipsis",title:e.item[t.name]},{default:(0,n.w5)((()=>[e.item&&Array.isArray(e.item._highlightResult[t.name])?((0,n.wg)(),(0,n.iD)("div",p,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.item._highlightResult[t.name],((e,t)=>((0,n.wg)(),(0,n.iD)("div",{innerHTML:e.value,key:t},null,8,f)))),128))])):((0,n.wg)(),(0,n.j4)(u,{key:1,attribute:t.name,hit:e.item},null,8,["attribute","hit"]))])),_:2},1032,["title"])])),_:2},1024)])),_:2},1024)))),128)),(0,n.Wm)(d),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.fieldsNotInSchema,(t=>((0,n.wg)(),(0,n.j4)(m,{key:t},{default:(0,n.w5)((()=>[(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{caption:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(t),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(o,{side:"",class:"q-ml-xl text-body2"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"overflow-hidden text-no-wrap text-ellipsis",title:e.item[t]},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.item[t]),1)])),_:2},1032,["title"])])),_:2},1024)])),_:2},1024)))),128)),(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,{flat:"",size:"sm",padding:"sm",color:"primary",onClick:t[0]||(t[0]=t=>e.editDocument()),icon:"edit",title:"Edit"})])),_:1})])),_:1}),(0,n.Wm)(o,{side:""},{default:(0,n.w5)((()=>[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,{flat:"",size:"sm",padding:"sm",onClick:t[1]||(t[1]=t=>e.deleteDocumentById(e.item.id)),icon:"delete_forever",title:"Delete"})])),_:1})])),_:1})])),_:1})])),_:1})])):(0,n.kq)("",!0)}const g=(0,n.aZ)({name:"SearchResultItem",props:{item:{type:Object}},computed:{currentCollection(){return this.$store.state.node.currentCollection},fieldsNotInSchema(){return this.item&&this.currentCollection?Object.keys(this.item).filter((e=>{var t;return!e.startsWith("_")&&!(null===(t=this.currentCollection)||void 0===t?void 0:t.fields.map((e=>e.name)).concat(["objectID","text_match"]).includes(e))})):[]}},methods:{editDocument(){const e={};this.item&&(Object.keys(this.item).forEach((t=>{if(!t.startsWith("_")&&!["objectID","text_match"].includes(t)){if(!this.item)return;e[t]=this.item[t]}})),this.$store.dispatch("node/editDocuments",[JSON.parse(JSON.stringify(e))]))},deleteDocumentById(e){this.$q.dialog({title:"Confirm",message:`Delete document with id: ${e}?`,cancel:!0,persistent:!0}).onOk((()=>{this.$store.dispatch("node/deleteDocumentById",e)}))}}});var b=i(74260),y=i(27011),C=i(83414),v=i(52035),_=i(2350),W=i(65869),k=i(48240),q=i(7518),D=i.n(q);const x=(0,b.Z)(g,[["render",w]]),S=x;D()(g,"components",{QList:y.Z,QItem:C.Z,QItemSection:v.Z,QItemLabel:_.Z,QSeparator:W.Z,QBtn:k.Z});var I=i(68222),$=function(e,t,i,n){function l(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(t){s(t)}}function r(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?i(e.value):l(e.value).then(a,r)}c((n=n.apply(e,t||[])).next())}))};const Z=(0,n.aZ)({components:{SearchResultItem:S},name:"Search",data(){const e={searchClient:null,instantSearchInstance:null,middlewares:[({instantSearchInstance:t})=>({subscribe(){e.instantSearchInstance=t},unsubscribe(){e.instantSearchInstance=null}})]};return e},computed:{currentCollection(){return this.$store.state.node.currentCollection},facetNumberFields(){return this.currentCollection?this.currentCollection.fields.filter((e=>e.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(e.type))).map((e=>e.name)):[]},facetStringFields(){return this.currentCollection?this.currentCollection.fields.filter((e=>e.facet&&["string","string[]"].includes(e.type))).map((e=>e.name)):[]},sortBy(){if(!this.currentCollection)return[];const e=[{value:this.currentCollection.name,label:"Default"}];return this.currentCollection.fields.filter((e=>["int32","float"].includes(e.type))).forEach((t=>{this.currentCollection&&(e.push({value:`${this.currentCollection.name}/sort/${t.name}:asc`,label:`${t.name} asc`}),e.push({value:`${this.currentCollection.name}/sort/${t.name}:desc`,label:`${t.name} desc`}))})),e}},methods:{exportPage(){return $(this,void 0,void 0,(function*(){this.instantSearchInstance&&this.currentCollection&&(yield this.$store.dispatch("node/exportToJson",this.instantSearchInstance.renderState[this.currentCollection.name].hits.results.hits))}))}},watch:{currentCollection:{handler(){this.searchClient=null,window.setTimeout((()=>{if(!this.$store.state.node.loginData||!this.currentCollection)return;const e=new I.Z({server:{nodes:[Object.assign({},this.$store.state.node.loginData.node)],apiKey:this.$store.state.node.loginData.apiKey},additionalSearchParameters:{query_by:this.currentCollection.fields.filter((e=>e.index&&["string","string[]"].includes(e.type))).map((e=>e.name)).join(",")}});this.searchClient=e.searchClient}))},immediate:!0}}});var j=i(24379);const B=(0,b.Z)(Z,[["render",d]]),Q=B;D()(Z,"components",{QPage:j.Z,QBtn:k.Z})}}]);