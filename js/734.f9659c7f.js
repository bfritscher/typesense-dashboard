"use strict";(globalThis["webpackChunktypesense_dashboard"]=globalThis["webpackChunktypesense_dashboard"]||[]).push([[734],{49375:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(83673);const n={ref:"editorWrapper",class:"col relative-position overflow-hidden editorWrapper"},l={ref:"editorElement",class:"absolute-top-left"};function a(e,t,s,a,r,o){const u=(0,i.up)("q-resize-observer");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(u,{onResize:e.onResize},null,8,["onResize"]),(0,i._)("div",l,null,512)],512)}var r=s(19966),o=s(61959);const u=(0,i.aZ)({name:"MonacoEditor",props:{modelValue:{type:String,default:""},options:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:t}){const s=(0,o.iH)(null),n=(0,o.iH)(null);let l;return(0,i.bv)((()=>{l=r.editor.create(s.value,Object.assign({value:e.modelValue,language:"json",theme:"vs-dark",minimap:{enabled:!1}},e.options)),l.onDidChangeModelContent((()=>{t("update:modelValue",null===l||void 0===l?void 0:l.getValue())}))})),(0,i.Ah)((()=>{null===l||void 0===l||l.dispose()})),(0,i.YP)((()=>e.modelValue),(()=>{var t;e.modelValue!==(null===l||void 0===l?void 0:l.getValue())&&(null===(t=null===l||void 0===l?void 0:l.getModel())||void 0===t||t.setValue(e.modelValue),null===l||void 0===l||l.setScrollPosition({scrollTop:0}))})),{editorElement:s,editorWrapper:n,onResize(){null===l||void 0===l||l.layout({height:0,width:0}),window.setTimeout((()=>{null===l||void 0===l||l.layout({height:n.value.offsetHeight,width:n.value.offsetWidth})}))}}}});var c=s(74260),d=s(15151),m=s(7518),h=s.n(m);const p=(0,c.Z)(u,[["render",a],["__scopeId","data-v-46f34a38"]]),f=p;h()(u,"components",{QResizeObserver:d.Z})},43734:(e,t,s)=>{s.r(t),s.d(t,{default:()=>de});var i=s(83673);function n(e,t,s,n,l,a){const r=(0,i.up)("q-tab"),o=(0,i.up)("q-tabs"),u=(0,i.up)("q-separator"),c=(0,i.up)("search-instant-search"),d=(0,i.up)("q-tab-panel"),m=(0,i.up)("search-json"),h=(0,i.up)("q-tab-panels"),p=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(p,{padding:""},{default:(0,i.w5)((()=>[(0,i.Wm)(o,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t),dense:"",class:"bg-primary text-white",align:"justify","narrow-indicator":""},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{name:"form",label:"InstantSearch Mode"}),(0,i.Wm)(r,{name:"json",label:"JSON Mode"})])),_:1},8,["modelValue"]),(0,i.Wm)(u),(0,i.Wm)(h,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tab=t),animated:"","keep-alive":""},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{name:"form"},{default:(0,i.w5)((()=>[(0,i.Wm)(c)])),_:1}),(0,i.Wm)(d,{name:"json",class:"q-pa-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(m)])),_:1})])),_:1},8,["modelValue"])])),_:1})}var l=s(62323);const a={class:"row"},r={class:"col-9"},o={class:"col-3"},u={class:"q-mt-md"},c={key:1,class:"ais-Hits q-mt-md"},d={class:"ais-Hits-list"},m={key:2,class:"text-h5 q-mt-md"},h={key:3};function p(e,t,s,n,p,f){const g=(0,i.up)("monaco-editor"),w=(0,i.up)("q-item-label"),v=(0,i.up)("q-item-section"),y=(0,i.up)("q-item"),b=(0,i.up)("q-list"),_=(0,i.up)("q-scroll-area"),k=(0,i.up)("q-banner"),W=(0,i.up)("q-btn"),q=(0,i.up)("search-result-item"),C=(0,i.Q2)("ripple");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",a,[(0,i._)("div",r,[(0,i.Wm)(g,{modelValue:e.searchParametersJson,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchParametersJson=t),style:{height:"30vh","min-height":"200px"}},null,8,["modelValue"])]),(0,i._)("div",o,[(0,i.Wm)(_,{style:{height:"100%"}},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{bordered:"",separator:"",dense:""},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{header:""},{default:(0,i.w5)((()=>[(0,i.Uk)("History")])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.history,(t=>(0,i.wy)(((0,i.wg)(),(0,i.j4)(y,{clickable:"",key:t,title:t,onClick:s=>e.searchParametersJson=t},{default:(0,i.w5)((()=>[(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.slice(0,60)),1)])),_:2},1024)])),_:2},1032,["title","onClick"])),[[C]]))),128))])),_:1})])),_:1})])]),e.jsonError?((0,i.wg)(),(0,i.j4)(k,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Invalid Format: "+(0,l.zw)(e.jsonError),1)])),_:1})):(0,i.kq)("",!0),(0,i._)("div",u,[(0,i.Wm)(W,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!!e.jsonError,onClick:t[1]||(t[1]=t=>e.search())},{default:(0,i.w5)((()=>[(0,i.Uk)("Run Query")])),_:1},8,["disable"]),(0,i.Wm)(W,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!e.results||!e.results.hits,onClick:t[2]||(t[2]=t=>e.exportHits())},{default:(0,i.w5)((()=>[(0,i.Uk)("Export Hits")])),_:1},8,["disable"]),(0,i.Wm)(W,{size:"md",padding:"sm lg",unelevated:"",color:"accent",class:"q-ml-sm",disable:!e.results,onClick:t[3]||(t[3]=t=>e.exportResults())},{default:(0,i.w5)((()=>[(0,i.Uk)("Export Raw Results")])),_:1},8,["disable"])]),e.hits?((0,i.wg)(),(0,i.iD)("div",c,[(0,i._)("ol",d,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.hits,(e=>((0,i.wg)(),(0,i.iD)("li",{class:"ais-Hits-item",key:e.id},[(0,i.Wm)(q,{item:e},null,8,["item"])])))),128))])])):(0,i.kq)("",!0),e.results&&e.results.hits&&0===e.results.hits.length?((0,i.wg)(),(0,i.iD)("div",m," No match found ")):(0,i.kq)("",!0),e.results&&!e.results.hits?((0,i.wg)(),(0,i.iD)("pre",h,"          "+(0,l.zw)(e.resultsJson)+"\n        ",1)):(0,i.kq)("",!0)],64)}var f=s(49375);const g={key:0,class:"column no-wrap search-result-item"},w={key:0},v=["innerHTML"],y={key:1},b={key:0},_={key:0},k={key:1};function W(e,t,s,n,a,r){const o=(0,i.up)("q-item-label"),u=(0,i.up)("ais-highlight"),c=(0,i.up)("q-item-section"),d=(0,i.up)("q-item"),m=(0,i.up)("q-separator"),h=(0,i.up)("q-list"),p=(0,i.up)("q-space"),f=(0,i.up)("q-btn");return e.currentCollection?((0,i.wg)(),(0,i.iD)("div",g,[(0,i.Wm)(h,{dense:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.currentCollection.fields,(t=>((0,i.wg)(),(0,i.j4)(d,{key:t.name},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{side:"",class:"q-mt-sm text-body2"},{default:(0,i.w5)((()=>[(0,i.Wm)(o,{caption:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.name),1)])),_:2},1024),(0,i.Wm)(o,{class:"overflow-hidden text-no-wrap text-ellipsis",title:e.item[t.name]},{default:(0,i.w5)((()=>[e.item&&Array.isArray(e.item._highlightResult[t.name])?((0,i.wg)(),(0,i.iD)("div",w,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.item._highlightResult[t.name],((e,t)=>((0,i.wg)(),(0,i.iD)("div",{innerHTML:e.value,key:t},null,8,v)))),128))])):((0,i.wg)(),(0,i.iD)("div",y,[t.name.includes(".*")?((0,i.wg)(),(0,i.iD)("div",b,[e.item&&Array.isArray(e.item[t.name])?((0,i.wg)(),(0,i.iD)("div",_,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.item[t.name],((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t},(0,l.zw)(e),1)))),128))])):((0,i.wg)(),(0,i.iD)("div",k,(0,l.zw)(e.item&&e.item[t.name]),1))])):((0,i.wg)(),(0,i.j4)(u,{key:1,attribute:t.name,hit:e.item},null,8,["attribute","hit"]))]))])),_:2},1032,["title"])])),_:2},1024)])),_:2},1024)))),128)),(0,i.Wm)(m),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.fieldsNotInSchema,(t=>((0,i.wg)(),(0,i.j4)(d,{key:t},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{side:"",class:"q-mt-sm text-body2"},{default:(0,i.w5)((()=>[(0,i.Wm)(o,{caption:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1024),(0,i.Wm)(o,{class:"overflow-hidden text-no-wrap text-ellipsis",title:e.item[t]},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.item[t]),1)])),_:2},1032,["title"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,i.Wm)(p),(0,i.Wm)(m),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i.Wm)(o,null,{default:(0,i.w5)((()=>[(0,i.Wm)(f,{flat:"",size:"sm",padding:"sm",color:"primary",onClick:t[0]||(t[0]=t=>e.editDocument()),icon:"sym_s_edit",title:"Edit"})])),_:1})])),_:1}),(0,i.Wm)(c,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(o,null,{default:(0,i.w5)((()=>[(0,i.Wm)(f,{flat:"",size:"sm",padding:"sm",onClick:t[1]||(t[1]=t=>e.deleteDocumentById(e.item.id)),icon:"sym_s_delete_forever",title:"Delete"})])),_:1})])),_:1})])),_:1})])):(0,i.kq)("",!0)}const q=(0,i.aZ)({name:"SearchResultItem",props:{item:{type:Object}},computed:{currentCollection(){return this.$store.state.node.currentCollection},fieldsNotInSchema(){return this.item&&this.currentCollection?Object.keys(this.item).filter((e=>{var t;return!e.startsWith("_")&&!(null===(t=this.currentCollection)||void 0===t?void 0:t.fields.map((e=>e.name)).concat(["objectID","text_match"]).includes(e))})):[]}},methods:{editDocument(){const e={};this.item&&(Object.keys(this.item).forEach((t=>{if(!t.startsWith("_")&&!["objectID","text_match"].includes(t)){if(!this.item)return;e[t]=this.item[t]}})),this.$store.dispatch("node/editDocuments",[JSON.parse(JSON.stringify(e))]))},deleteDocumentById(e){this.$q.dialog({title:"Confirm",message:`Delete document with id: ${e}?`,cancel:!0,persistent:!0}).onOk((()=>{this.$store.dispatch("node/deleteDocumentById",e)}))}}});var C=s(74260),D=s(27011),S=s(83414),x=s(52035),Z=s(2350),j=s(65869),I=s(62025),H=s(48240),Q=s(7518),$=s.n(Q);const z=(0,C.Z)(q,[["render",W]]),P=z;$()(q,"components",{QList:D.Z,QItem:S.Z,QItemSection:x.Z,QItemLabel:Z.Z,QSeparator:j.Z,QSpace:I.Z,QBtn:H.Z});var V=s(56395),E=function(e,t,s,i){function n(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{o(i.next(e))}catch(t){l(t)}}function r(e){try{o(i["throw"](e))}catch(t){l(t)}}function o(e){e.done?s(e.value):n(e.value).then(a,r)}o((i=i.apply(e,t||[])).next())}))};const R="typesense-search-history",J=(0,i.aZ)({components:{SearchResultItem:P,MonacoEditor:f.Z},name:"Search",data(){return{tab:"form",history:[],searchParameters:{q:"stark",query_by:"company_name",filter_by:"num_employees:>100",sort_by:"num_employees:desc",page:1,per_page:10,exhaustive_search:!0},jsonError:null,results:null}},computed:{currentCollection(){return this.$store.state.node.currentCollection},searchParametersJson:{get(){return JSON.stringify(this.searchParameters,null,2)},set(e){try{this.searchParameters=JSON.parse(e),this.jsonError=null}catch(t){this.jsonError=t.message}}},hits(){return this.results&&this.results.hits?this.results.hits.map((e=>{const t=Object.assign({},e.document);return t._highlightResult=Object.keys(e.document).reduce(((t,s)=>(t[s]={value:String(e.document[s])},t)),{}),e.highlights.forEach((e=>{t._highlightResult[e.field]={value:e.snippet}})),t})):[]},resultsJson(){return JSON.stringify(this.results,null,2)}},methods:{exportResults(){return E(this,void 0,void 0,(function*(){this.results&&(yield this.$store.dispatch("node/exportToJson",this.results))}))},exportHits(){return E(this,void 0,void 0,(function*(){if(this.results&&this.results.hits){const e=this.results.hits.map((e=>e.document));yield this.$store.dispatch("node/exportToJson",e)}}))},search(){return E(this,void 0,void 0,(function*(){this.results=null,this.jsonError=null,this.addToHistory();try{this.results=yield this.$store.dispatch("node/search",this.searchParameters)}catch(e){this.jsonError=e.message}}))},addToHistory(){const e=this.searchParametersJson,t=this.history.indexOf(e);0!==t&&(t>0&&this.history.splice(t,1),this.history.unshift(e),this.saveHistory())},loadHistory(){var e;this.history=V.Z.getItem(`${R}-${(null===(e=this.currentCollection)||void 0===e?void 0:e.name)||""}`)||[]},saveHistory(){var e;V.Z.set(`${R}-${(null===(e=this.currentCollection)||void 0===e?void 0:e.name)||""}`,this.history.slice(0,20))}},watch:{currentCollection:{handler(){this.loadHistory()},immediate:!0}}});var O=s(47704),T=s(15607),U=s(46489);const N=(0,C.Z)(J,[["render",p]]),B=N;$()(J,"components",{QScrollArea:O.Z,QList:D.Z,QItemLabel:Z.Z,QItem:S.Z,QItemSection:x.Z,QBanner:T.Z,QBtn:H.Z}),$()(J,"directives",{Ripple:U.Z});const K={class:"row q-mt-md"},Y={class:"col-3 q-pr-sm"},M=(0,i._)("div",{class:"text-subtitle2 q-pt-md"},"Sort By",-1),A={class:"text-subtitle2 q-pt-md"},L={class:"text-subtitle2 q-pt-md"},F={class:"col-9"};function G(e,t,s,n,a,r){const o=(0,i.up)("ais-configure"),u=(0,i.up)("ais-search-box"),c=(0,i.up)("ais-stats"),d=(0,i.up)("ais-current-refinements"),m=(0,i.up)("ais-hits-per-page"),h=(0,i.up)("q-btn"),p=(0,i.up)("ais-sort-by"),f=(0,i.up)("ais-range-input"),g=(0,i.up)("ais-refinement-list"),w=(0,i.up)("ais-pagination"),v=(0,i.up)("search-result-item"),y=(0,i.up)("ais-hits"),b=(0,i.up)("ais-instant-search");return e.searchClient&&e.currentCollection?((0,i.wg)(),(0,i.j4)(b,{key:0,"search-client":e.searchClient,"index-name":e.currentCollection.name,middlewares:e.middlewares},{default:(0,i.w5)((()=>[(0,i.Wm)(o,{hitsPerPage:12}),(0,i.Wm)(u,{placeholder:""}),(0,i.Wm)(c),(0,i.Wm)(d),(0,i._)("div",K,[(0,i._)("div",Y,[(0,i.Wm)(m,{items:[{label:"12 hits per page",value:12,default:!0},{label:"48 hits per page",value:48},{label:"100 hits per page",value:100},{label:"250 hits per page",value:250}]}),(0,i.Wm)(h,{flat:"",onClick:t[0]||(t[0]=t=>e.exportPage())},{default:(0,i.w5)((()=>[(0,i.Uk)("export current page")])),_:1}),M,(0,i.Wm)(p,{items:e.sortBy},null,8,["items"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.facetNumberFields,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"q-mb-sm",key:e},[(0,i._)("div",A,(0,l.zw)(e),1),(0,i.Wm)(f,{searchable:!0,attribute:e},null,8,["attribute"])])))),128)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.facetStringFields,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"q-mb-sm",key:e},[(0,i._)("div",L,(0,l.zw)(e),1),(0,i.Wm)(g,{class:"q-mb-sm",searchable:!0,attribute:e},null,8,["attribute"])])))),128))]),(0,i._)("div",F,[(0,i.Wm)(w,{class:"q-mb-md"}),(0,i.Wm)(y,null,(0,i.Nv)({_:2},[e.currentCollection?{name:"item",fn:(0,i.w5)((({item:e})=>[(0,i.Wm)(v,{item:e},null,8,["item"])])),key:"0"}:void 0]),1024),(0,i.Wm)(w,{class:"q-my-md"})])])])),_:1},8,["search-client","index-name","middlewares"])):(0,i.kq)("",!0)}var X=s(68222),ee=function(e,t,s,i){function n(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,l){function a(e){try{o(i.next(e))}catch(t){l(t)}}function r(e){try{o(i["throw"](e))}catch(t){l(t)}}function o(e){e.done?s(e.value):n(e.value).then(a,r)}o((i=i.apply(e,t||[])).next())}))};const te=(0,i.aZ)({components:{SearchResultItem:P},name:"SearchInstantSearch",data(){const e={searchClient:null,instantSearchInstance:null,middlewares:[({instantSearchInstance:t})=>({subscribe(){e.instantSearchInstance=t},unsubscribe(){e.instantSearchInstance=null}})]};return e},computed:{currentCollection(){return this.$store.state.node.currentCollection},facetNumberFields(){return this.currentCollection?this.currentCollection.fields.filter((e=>e.facet&&["int32","int64","float","int32[]","int64[]","float[]"].includes(e.type)&&!e.name.includes(".*"))).map((e=>e.name)):[]},facetStringFields(){return this.currentCollection?this.currentCollection.fields.filter((e=>e.facet&&["string","string[]"].includes(e.type)&&!e.name.includes(".*"))).map((e=>e.name)):[]},sortBy(){if(!this.currentCollection)return[];const e=[{value:this.currentCollection.name,label:"Default"}];return this.currentCollection.fields.filter((e=>["int32","float"].includes(e.type)||"string"===e.type&&e.sort)).forEach((t=>{this.currentCollection&&(e.push({value:`${this.currentCollection.name}/sort/${t.name}:asc`,label:`${t.name} asc`}),e.push({value:`${this.currentCollection.name}/sort/${t.name}:desc`,label:`${t.name} desc`}))})),e}},methods:{exportPage(){return ee(this,void 0,void 0,(function*(){this.instantSearchInstance&&this.currentCollection&&(yield this.$store.dispatch("node/exportToJson",this.instantSearchInstance.renderState[this.currentCollection.name].hits.results.hits))}))}},watch:{currentCollection:{handler(){this.searchClient=null,window.setTimeout((()=>{if(!this.$store.state.node.loginData||!this.currentCollection)return;const e=new X.Z({server:{nodes:[Object.assign({},this.$store.state.node.loginData.node)],apiKey:this.$store.state.node.loginData.apiKey},additionalSearchParameters:{exhaustive_search:!0,query_by:this.currentCollection.fields.filter((e=>e.index&&["string","string[]"].includes(e.type)&&!e.name.includes(".*"))).map((e=>e.name)).join(",")}});this.searchClient=e.searchClient}))},immediate:!0}}}),se=(0,C.Z)(te,[["render",G]]),ie=se;$()(te,"components",{QBtn:H.Z});const ne=(0,i.aZ)({components:{SearchJson:B,SearchInstantSearch:ie},name:"Search",data(){return{tab:"form"}}});var le=s(24379),ae=s(57547),re=s(3269),oe=s(5906),ue=s(64916);const ce=(0,C.Z)(ne,[["render",n]]),de=ce;$()(ne,"components",{QPage:le.Z,QTabs:ae.Z,QTab:re.Z,QSeparator:j.Z,QTabPanels:oe.Z,QTabPanel:ue.Z})}}]);