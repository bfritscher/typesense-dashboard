"use strict";(globalThis["webpackChunktypesense_dashboard"]=globalThis["webpackChunktypesense_dashboard"]||[]).push([[331],{49375:(e,l,o)=>{o.d(l,{Z:()=>h});var t=o(83673);const a={ref:"editorWrapper",class:"col relative-position overflow-hidden editorWrapper"},n={ref:"editorElement",class:"absolute-top-left"};function d(e,l,o,d,s,i){const r=(0,t.up)("q-resize-observer");return(0,t.wg)(),(0,t.iD)("div",a,[(0,t.Wm)(r,{onResize:e.onResize},null,8,["onResize"]),(0,t._)("div",n,null,512)],512)}var s=o(19966),i=o(61959);const r=(0,t.aZ)({name:"MonacoEditor",props:{modelValue:{type:String,default:""},options:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:l}){const o=(0,i.iH)(null),a=(0,i.iH)(null);let n;return(0,t.bv)((()=>{n=s.editor.create(o.value,Object.assign({value:e.modelValue,language:"json",theme:"vs-dark",minimap:{enabled:!1}},e.options)),n.onDidChangeModelContent((()=>{l("update:modelValue",null===n||void 0===n?void 0:n.getValue())}))})),(0,t.Ah)((()=>{null===n||void 0===n||n.dispose()})),(0,t.YP)((()=>e.modelValue),(()=>{var l;e.modelValue!==(null===n||void 0===n?void 0:n.getValue())&&(null===(l=null===n||void 0===n?void 0:n.getModel())||void 0===l||l.setValue(e.modelValue),null===n||void 0===n||n.setScrollPosition({scrollTop:0}))})),{editorElement:o,editorWrapper:a,onResize(){null===n||void 0===n||n.layout({height:0,width:0}),window.setTimeout((()=>{null===n||void 0===n||n.layout({height:a.value.offsetHeight,width:a.value.offsetWidth})}))}}}});var m=o(74260),u=o(15151),c=o(7518),p=o.n(c);const f=(0,m.Z)(r,[["render",d],["__scopeId","data-v-46f34a38"]]),h=f;p()(r,"components",{QResizeObserver:u.Z})},71331:(e,l,o)=>{o.r(l),o.d(l,{default:()=>N});var t=o(83673),a=o(62323);function n(e,l,o,n,d,s){const i=(0,t.up)("collection-create"),r=(0,t.up)("q-btn"),m=(0,t.up)("q-td"),u=(0,t.up)("q-item-section"),c=(0,t.up)("q-avatar"),p=(0,t.up)("q-item"),f=(0,t.up)("q-menu"),h=(0,t.up)("q-icon"),_=(0,t.up)("q-tr"),w=(0,t.up)("q-input"),b=(0,t.up)("q-table"),g=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(g,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i),(0,t.Wm)(b,{filter:e.filter,columns:e.columns,rows:e.$store.state.node.data.collections,"row-key":"name",pagination:{rowsPerPage:0,sortBy:"name"}},{body:(0,t.w5)((l=>[(0,t.Wm)(_,{props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{key:"name",props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"no-caps":"",flat:"",to:`/collection/${l.row.name}/search`,size:"1.2em",class:"text-bold"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(l.row.name),1)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,t.Wm)(m,{key:"actions",props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{flat:"",round:"",color:"primary",icon:"sym_s_more_horiz"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{dense:"",clickable:"",to:`/collection/${l.row.name}/document`},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Import")])),_:1}),(0,t.Wm)(u,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{icon:"sym_s_file_upload"})])),_:1})])),_:2},1032,["to"]),(0,t.Wm)(p,{dense:"",clickable:"",onClick:o=>e.exportCollection(l.row.name)},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Export")])),_:1}),(0,t.Wm)(u,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{icon:"sym_s_file_download"})])),_:1})])),_:2},1032,["onClick"]),(0,t.Wm)(p,{dense:"",clickable:"",flat:"",style:{color:"#DE3B39"},onClick:o=>e.drop(l.row.name)},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Delete")])),_:1}),(0,t.Wm)(u,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{icon:"sym_s_delete"})])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"]),(0,t.Wm)(m,{key:"num_documents",props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"no-caps":"",flat:"",to:`/collection/${l.row.name}/search`},{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(l.row.num_documents)+" ",1),(0,t.Wm)(h,{name:"sym_s_search",size:"1em",right:""})])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,t.Wm)(m,{key:"schema_fields",props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{"no-caps":"",flat:"",to:`/collection/${l.row.name}/schema`},{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(l.row.fields.length||0)+" ",1),(0,t.Wm)(h,{name:"sym_s_data_object",size:"1em",right:""})])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,t.Wm)(m,{key:"created_at",props:l},{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(new Date(1e3*l.row.created_at).toLocaleString()),1)])),_:2},1032,["props"])])),_:2},1032,["props"])])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(w,{borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":l[0]||(l[0]=l=>e.filter=l),placeholder:"Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(h,{name:"sym_s_search"})])),_:1},8,["modelValue"])])),_:1},8,["filter","columns","rows"])])),_:1})}const d={class:"row q-gutter-md"},s=(0,t._)("div",{class:"text-subtitle1 q-pt-md"},"Fields",-1);function i(e,l,o,n,i,r){const m=(0,t.up)("q-tab"),u=(0,t.up)("q-tabs"),c=(0,t.up)("q-separator"),p=(0,t.up)("q-input"),f=(0,t.up)("q-select"),h=(0,t.up)("q-card-section"),_=(0,t.up)("q-checkbox"),w=(0,t.up)("q-btn"),b=(0,t.up)("q-card-actions"),g=(0,t.up)("q-card"),W=(0,t.up)("q-tab-panel"),y=(0,t.up)("monaco-editor"),v=(0,t.up)("q-banner"),V=(0,t.up)("q-tab-panels"),q=(0,t.up)("q-expansion-item"),k=(0,t.up)("q-list");return(0,t.wg)(),(0,t.j4)(k,{bordered:"",class:"rounded-borders"},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{"expand-separator":"",icon:"sym_s_library_add","expand-icon":"sym_s_unfold_more","expanded-icon":"sym_s_unfold_less",label:"Add Collection","header-class":"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=l=>e.tab=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{name:"form",label:"Form Mode"}),(0,t.Wm)(m,{name:"json",label:"JSON Mode"})])),_:1},8,["modelValue"]),(0,t.Wm)(c),(0,t.Wm)(V,{modelValue:e.tab,"onUpdate:modelValue":l[4]||(l[4]=l=>e.tab=l),animated:"",style:{height:"60vh"},class:"bg-grey-3"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{name:"form"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t._)("div",d,[(0,t.Wm)(p,{class:"col",filled:"","bg-color":"white",dense:"",modelValue:e.schema.name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.schema.name=l),label:"Collection Name",placeholder:"books",rules:[e=>!!e||"Field is required"]},null,8,["modelValue","rules"]),(0,t.Wm)(f,{filled:"","bg-color":"white",class:"col",dense:"",modelValue:e.schema.default_sorting_field,"onUpdate:modelValue":l[2]||(l[2]=l=>e.schema.default_sorting_field=l),options:e.availableSortFields,label:"Default sort field optional, but must be int32 or float"},null,8,["modelValue","options"])]),s,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.schema.fields,((l,o)=>((0,t.wg)(),(0,t.j4)(g,{flat:"",bordered:"",key:o,class:"bg-grey-1 q-mb-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"row q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{class:"col",dense:"",filled:"","bg-color":"white",modelValue:l.name,"onUpdate:modelValue":e=>l.name=e,label:"Field Name",placeholder:"title",rules:[e=>!!e||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,t.Wm)(f,{class:"col",dense:"",filled:"","bg-color":"white",modelValue:l.type,"onUpdate:modelValue":e=>l.type=e,label:"type",options:e.types,rules:[e=>!!e||"Field is required"]},null,8,["modelValue","onUpdate:modelValue","options","rules"])])),_:2},1024),(0,t.Wm)(c),(0,t.Wm)(b,{align:"between"},{default:(0,t.w5)((()=>[(0,t._)("div",null,[(0,t.Wm)(_,{modelValue:l.optional,"onUpdate:modelValue":e=>l.optional=e,label:"optional"},null,8,["modelValue","onUpdate:modelValue"]),(0,t.Wm)(_,{modelValue:l.facet,"onUpdate:modelValue":e=>l.facet=e,label:"facet"},null,8,["modelValue","onUpdate:modelValue"]),(0,t.Wm)(_,{modelValue:l.index,"onUpdate:modelValue":e=>l.index=e,label:"index"},null,8,["modelValue","onUpdate:modelValue"]),(0,t.Wm)(_,{modelValue:l.sort,"onUpdate:modelValue":e=>l.sort=e,label:"sort"},null,8,["modelValue","onUpdate:modelValue"])]),(0,t.Wm)(w,{size:"md",padding:"sm lg",unelevated:"",onClick:o=>e.removeField(l)},{default:(0,t.w5)((()=>[(0,t.Uk)("Remove Field")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,t.Wm)(W,{name:"json",class:"q-pa-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:e.schemaJson,"onUpdate:modelValue":l[3]||(l[3]=l=>e.schemaJson=l),style:{height:"60vh"}},null,8,["modelValue"]),e.jsonError?((0,t.wg)(),(0,t.j4)(v,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:(0,t.w5)((()=>[(0,t.Uk)(" Invalid Format: "+(0,a.zw)(e.jsonError),1)])),_:1})):(0,t.kq)("",!0)])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(c),(0,t.Wm)(b,{align:"between",class:"bg-primary"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:l[5]||(l[5]=l=>e.addField())},{default:(0,t.w5)((()=>[(0,t.Uk)("Add field")])),_:1}),(0,t.Wm)(w,{size:"md",padding:"sm lg",unelevated:"",color:"primary",onClick:l[6]||(l[6]=l=>e.createCollection())},{default:(0,t.w5)((()=>[(0,t.Uk)("Create Collection")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var r=o(49375);const m=(0,t.aZ)({components:{MonacoEditor:r.Z},name:"CollectionCreate",data(){return{tab:"form",schema:{name:"",fields:[],default_sorting_field:"",token_separators:[],symbols_to_index:[]},types:["string","string[]","int32","int32[]","int64","int64[]","float","float[]","bool","bool[]","geopoint","geopoint[]","string*","auto"],jsonError:null}},mounted(){this.addField()},computed:{availableSortFields(){const e=this.schema.fields.filter((e=>["int32","float"].includes(e.type)||"string"===e.type&&e.sort));return[""].concat(e.map((e=>e.name)))},schemaJson:{get(){return JSON.stringify(this.schema,null,2)},set(e){try{this.schema=JSON.parse(e),this.jsonError=null}catch(l){this.jsonError=l.message}}}},methods:{addField(){this.schema.fields.push({name:"",type:"string",optional:!1,facet:!1,index:!0})},removeField(e){this.schema.fields.splice(this.schema.fields.indexOf(e),1)},createCollection(){this.$store.dispatch("node/createCollection",this.schema)}}});var u=o(74260),c=o(27011),p=o(64615),f=o(10151),h=o(57547),_=o(3269),w=o(65869),b=o(5906),g=o(64916),W=o(25589),y=o(34842),v=o(68516),V=o(99367),q=o(65735),k=o(48240),C=o(15607),Z=o(7518),U=o.n(Z);const x=(0,u.Z)(m,[["render",i]]),Q=x;U()(m,"components",{QList:c.Z,QExpansionItem:p.Z,QCard:f.Z,QTabs:h.Z,QTab:_.Z,QSeparator:w.Z,QTabPanels:b.Z,QTabPanel:g.Z,QCardSection:W.Z,QInput:y.Z,QSelect:v.Z,QCardActions:V.Z,QCheckbox:q.Z,QBtn:k.Z,QBanner:C.Z});var z=function(e,l,o,t){function a(e){return e instanceof o?e:new o((function(l){l(e)}))}return new(o||(o=Promise))((function(o,n){function d(e){try{i(t.next(e))}catch(l){n(l)}}function s(e){try{i(t["throw"](e))}catch(l){n(l)}}function i(e){e.done?o(e.value):a(e.value).then(d,s)}i((t=t.apply(e,l||[])).next())}))};const j=(0,t.aZ)({components:{CollectionCreate:Q},name:"Collections",data(){return{filter:"",columns:[{name:"name",required:!0,label:"Name",field:"name",sortable:!0},{name:"actions",required:!1,label:"",field:"actions",sortable:!1},{name:"num_documents",required:!0,label:"Nb documents",field:"num_documents",sortable:!0},{name:"schema_fields",required:!0,label:"Schema fields",field:"fields",sortable:!0},{name:"created_at",required:!0,label:"Created at",field:"created_at",sortable:!0}]}},mounted(){this.$store.dispatch("node/getCollections")},methods:{exportCollection(e){return z(this,void 0,void 0,(function*(){this.$q.loading.show({message:"Downloading. Please wait...",boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),yield this.$store.dispatch("node/exportDocuments",e).then((()=>this.$q.loading.hide())).catch((()=>{this.$q.loading.hide(),this.$q.dialog({title:"Export failed",message:"Try desktop version of the app."})}))}))},drop(e){this.$q.dialog({title:"Confirm",message:`Drop ${e} and all documents?`,cancel:!0,persistent:!0}).onOk((()=>{this.$store.dispatch("node/dropCollection",e)}))}}});var F=o(24379),$=o(83243),S=o(18186),E=o(83884),T=o(86335),D=o(83414),I=o(52035),P=o(75096),O=o(24554);const M=(0,u.Z)(j,[["render",n]]),N=M;U()(j,"components",{QPage:F.Z,QTable:$.Z,QTr:S.Z,QTd:E.Z,QBtn:k.Z,QMenu:T.Z,QItem:D.Z,QItemSection:I.Z,QAvatar:P.Z,QIcon:O.Z,QInput:y.Z})}}]);