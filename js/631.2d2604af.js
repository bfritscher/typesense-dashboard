"use strict";(globalThis["webpackChunktypesense_dashboard"]=globalThis["webpackChunktypesense_dashboard"]||[]).push([[631],{70648:(t,e,s)=>{s.r(e),s.d(e,{default:()=>x});var o=s(59835),n=s(86970);const i={class:"row justify-between q-mb-md"},r={class:"text-h5"},a={key:0},l={class:"row q-mb-md bg-primary text-white justify-between"},d={class:"row col-auto"},c={key:0},u={key:1};function m(t,e,s,m,p,h){const g=(0,o.up)("q-icon"),y=(0,o.up)("q-btn"),w=(0,o.up)("monaco-editor"),f=(0,o.up)("q-banner"),b=(0,o.up)("q-select"),v=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(v,{padding:"",class:"column"},{default:(0,o.w5)((()=>{var s;return[(0,o._)("div",i,[(0,o._)("div",r,[(0,o.Wm)(g,{size:"md",name:"sym_s_library_add"}),(0,o.Uk)(" Add Documents to "+(0,n.zw)(null===(s=t.$store.state.node.currentCollection)||void 0===s?void 0:s.name),1)]),(0,o.Wm)(y,{unelevated:"",onClick:e[0]||(e[0]=e=>t.importFile()),disable:!t.$q.platform.is.electron,icon:"sym_s_attach_file"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Import from file "),t.$q.platform.is.electron?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("span",a," (only desktop version)"))])),_:1},8,["disable"])]),(0,o.Wm)(w,{modelValue:t.documentsJson,"onUpdate:modelValue":e[1]||(e[1]=e=>t.documentsJson=e),style:{"min-height":"200px"}},null,8,["modelValue"]),t.jsonError?((0,o.wg)(),(0,o.j4)(f,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Invalid Format: "+(0,n.zw)(t.jsonError),1)])),_:1})):(0,o.kq)("",!0),(0,o._)("div",l,[(0,o.Wm)(y,{unelevated:"",size:"md",padding:"sm lg",color:"primary",onClick:e[2]||(e[2]=e=>t.addEmptyDocument())},{default:(0,o.w5)((()=>[(0,o.Uk)("Add empty Document")])),_:1}),(0,o._)("div",d,[(0,o.Wm)(b,{dark:"",modelValue:t.action,"onUpdate:modelValue":e[3]||(e[3]=e=>t.action=e),"bottom-slots":"",label:"Action mode",filled:"",style:{width:"300px"},options:t.actionOptions},{hint:(0,o.w5)((()=>[(0,o._)("div",null,(0,n.zw)(t.actionDesciptions[t.action]),1)])),_:1},8,["modelValue","options"]),(0,o.Wm)(y,{unelevated:"",size:"md",padding:"sm xl",color:"primary",onClick:e[4]||(e[4]=e=>t.importDocuments()),disable:!!t.jsonError},{default:(0,o.w5)((()=>[(0,o.Uk)("Import")])),_:1},8,["disable"])])]),(0,o._)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.results,((t,e)=>((0,o.wg)(),(0,o.j4)(f,{key:e,class:(0,n.C_)(["text-white",{"bg-green":t.success,"bg-red":t.error}])},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e)+": ",1),t.success?((0,o.wg)(),(0,o.iD)("span",c,(0,n.zw)(t.success),1)):((0,o.wg)(),(0,o.iD)("span",u,(0,n.zw)(t.error),1))])),_:2},1032,["class"])))),128))])]})),_:1})}var p=s(66531),h=function(t,e,s,o){function n(t){return t instanceof s?t:new s((function(e){e(t)}))}return new(s||(s=Promise))((function(s,i){function r(t){try{l(o.next(t))}catch(e){i(e)}}function a(t){try{l(o["throw"](t))}catch(e){i(e)}}function l(t){t.done?s(t.value):n(t.value).then(r,a)}l((o=o.apply(t,e||[])).next())}))};const g=(0,o.aZ)({name:"Document",components:{MonacoEditor:p.Z},data(){return{jsonError:null,documents:[],results:[],action:"upsert",actionOptions:["create","upsert","update"],actionDesciptions:{create:"Create a new document. Fails if id exists.",upsert:"Create a new document or update an existing document.",update:"Update an existing document. Partial document allowed."}}},computed:{documentsJson:{get(){return JSON.stringify(this.documents,null,2)},set(t){try{this.documents=JSON.parse(t),this.jsonError=null}catch(e){this.jsonError=e.message}}},currentCollection(){return this.$store.state.node.currentCollection},documentsToEdit(){return this.$store.state.node.documentsToEdit}},methods:{importFile(){var t;return h(this,void 0,void 0,(function*(){this.results=[];try{this.$q.loading.show({message:"Uploading. Please wait...",boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"});let e=yield this.$store.getters["node/api"].importFile(null===(t=this.currentCollection)||void 0===t?void 0:t.name,this.action);Array.isArray(e)||(e=[{error:e}]),this.results=e}catch(e){this.results=[{error:e.message}]}this.$q.loading.hide()}))},importDocuments(){return h(this,void 0,void 0,(function*(){this.results=[];try{this.$q.loading.show({message:"Uploading. Please wait...",boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),this.results=yield this.$store.dispatch("node/importDocuments",{action:this.action,documents:JSON.parse(JSON.stringify(this.documents))})}catch(t){this.results=[{error:t.message}]}this.$q.loading.hide()}))},addEmptyDocument(){let t={};this.currentCollection&&this.currentCollection.fields&&(t=this.currentCollection.fields.reduce(((t,e)=>(t[e.name]=e.type.includes("[]")?[]:e.type.includes("string")?"":!e.type.includes("bool")&&0,t)),{})),this.documents.push(t)}},watch:{currentCollection:{handler(){this.documents=[],this.addEmptyDocument()},immediate:!0},documentsToEdit:{handler(){this.documentsToEdit&&this.documentsToEdit.length>0&&(this.documents=this.$store.state.node.documentsToEdit||[],this.action="upsert",this.$store.commit("node/setDocumentsToEdit",[]))},immediate:!0}}});var y=s(11639),w=s(69885),f=s(22857),b=s(24455),v=s(47128),k=s(26384),_=s(69984),C=s.n(_);const E=(0,y.Z)(g,[["render",m]]),x=E;C()(g,"components",{QPage:w.Z,QIcon:f.Z,QBtn:b.Z,QBanner:v.Z,QSelect:k.Z})}}]);